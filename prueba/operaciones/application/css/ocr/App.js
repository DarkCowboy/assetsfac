var hasOTFSupport=0;var triggerCounter=0;var callCnt=0;var callbackfontname;var callbackroutine;var jsParentDirectory="./scripts/";var currentFeatures=null;var browserName=null;var majorVersion=0;var fullVersion=0;var loadedList="";var fontNameToIds={};function checkImplicitLigaSupport(){var d=navigator.userAgent;var a=navigator.appName;fullVersion=""+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10);var e,f,c;var b=0;if((f=d.indexOf("Firefox"))!=-1){a="Firefox";fullVersion=d.substring(f+8)}else{if((f=d.indexOf("MSIE"))!=-1){a="MSIE";fullVersion=d.substring(f+5)}else{if((f=d.indexOf("Chrome"))!=-1){a="Chrome";fullVersion=d.substring(f+7);if(d.indexOf("Mac")!=-1){b=1}}else{if((f=d.indexOf("Opera"))!=-1){a="Opera";fullVersion=d.substring(f+6);if((f=d.indexOf("Version"))!=-1){fullVersion=d.substring(f+8)}}else{if((f=d.indexOf("Safari"))!=-1){a="Safari";fullVersion=d.substring(f+7);if((f=d.indexOf("Version"))!=-1){fullVersion=d.substring(f+8)}}else{if((e=d.lastIndexOf(" ")+1)<(f=d.lastIndexOf("/"))){a=d.substring(e,f);fullVersion=d.substring(f+1);if(a.toLowerCase()==a.toUpperCase()){a=navigator.appName}}}}}}}if((c=fullVersion.indexOf(";"))!=-1){fullVersion=fullVersion.substring(0,c)}if((c=fullVersion.indexOf(" "))!=-1){fullVersion=fullVersion.substring(0,c)}majorVersion=parseInt(""+fullVersion,10);if(isNaN(majorVersion)){fullVersion=""+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10)}if(a.indexOf("MSIE")!=-1&&majorVersion>=10){hasOTFSupport=1}hasOTFSupport=0;if(a.indexOf("MSIE")!=-1&&majorVersion<8){hasOTFSupport=1}}function CR(){var D=arguments[0];var B=D.split(/<[\/]?\s*\w.*?>/g);var v="";var p=arguments.length;var r=arguments[1];var z=arguments[2];var y;var l;var c,h,a;var w,q,o,f;for(var n=0;n<B.length;n++){var A=D.search(/<[\/]?\s*\w.*?>/g);var e="";if(A!=-1){e=D.substring(A,D.indexOf(">")+1)}D=D.substring(D.indexOf(">")+1);var C=B[n];IndexCounter:for(f=0;f<C.length;f++){RuleCounter:for(o=0;o<z;o++){y=r["R"+o];c=y.B;if(f<c){continue RuleCounter}h=y.I;a=y.L;var g=y.IO;var d=y.BO;var b=y.LO;var s=y.M;for(q=0;q<s;q++){l=C.charCodeAt(f+q);if(y.S==1&&(q<h&&(typeof(g["o"+(q+1)]["u"+l])=="undefined"))){continue IndexCounter}if((q<h&&(typeof(g["o"+(q+1)]["u"+l])=="undefined"))||(q<c&&(typeof(d["o"+(q+1)]["u"+(C.charCodeAt(f-c+q))])=="undefined"))||(q<a&&(typeof(b["o"+(q+1)]["u"+(C.charCodeAt(f+h+q))])=="undefined"))){continue RuleCounter}}if(y.S==1){break}var F=C.substr(f,h);var u=F;var x=y.A;for(var E=0;E<x.length;E+=2){F=F.replace(x[E],x[E+1]);if(u!=F){if(arguments[3]==0){return u}break}}C=C.substr(0,f)+F+C.substr(f+h,C.length);break}}v+=C+e}return(v)}function SR(){var u=arguments[0];var t=u.split(/<[\/]?\s*\w.*?>/g);var o="";var n="";var e=0,l=-1,p=-1,c=1;var v=arguments[3];for(var f=0;f<t.length;f++){var s=u.search(/<[\/]?\s*\w.*?>/g);var b="";if(s!=-1){b=u.substring(s,u.indexOf(">")+1)}u=u.substring(u.indexOf(">")+1);var q=-1;var w=t[f];n="";for(var d=0;d<w.length;d++){var r=false;for(var g=arguments[2];g>0;g--){var a="";for(var h=0;h<g;h++){if(typeof(w[d+h])!="undefined"){a+=decimalToHex(w[d+h].charCodeAt(0),4).toUpperCase()}}if(typeof(arguments[1]["r"+a])!="undefined"){if(typeof(arguments[1]["r"+a]["o"+v])!="undefined"){n+=arguments[1]["r"+a]["o"+v]}else{if(typeof(arguments[1]["r"+a]["o1"])!="undefined"){n+=w[d]}else{n+=arguments[1]["r"+a]}}if(arguments[4]==0){return n}r=true;d+=(g-1);break}}if(r==false){n+=w[d]}}o+=n+b}return(o)}function R(a){return(new RegExp(a,""))}function getFontFamilyName(b){var a="font-family";var c=null;if(b.currentStyle){c=b.currentStyle.fontFamily}else{if(document.defaultView&&document.defaultView.getComputedStyle){c=document.defaultView.getComputedStyle(b,null).getPropertyValue(a);if(!c){c=b.style[a]}}else{c=b.style[a]}}if(c.length>0){if(c.charAt(0)!="'"&&c.charAt(0)!='"'){c="'"+c+"'"}else{if(c.charAt(0)=='"'){c="'"+c.substring(1,(c.length-1))+"'"}}}return c}function doesClassHasFFSProp(a,h,f){var e=-1;if(!f){e=a.indexOf(h)}else{e=0}var b=false;var c="";var d="";if(e!=-1){if(!f){a=a.substring(e);a=a.substring(0,a.indexOf("}")+1)}if(browserName=="Firefox"){e=a.indexOf("moz-font-feature-settings")}else{if(browserName=="MSIE"){e=a.indexOf("ms-font-feature-settings")}else{if(browserName=="Chrome"){e=a.indexOf("webkit-font-feature-settings")}else{if(browserName=="Opera"){e=a.indexOf("o-font-feature-settings")}else{e=a.indexOf("font-feature-settings")}}}}if(e!=-1){a=a.substr(e);a=a.substr(0,a.indexOf(";"));for(var g=0;g<currentFeatures.length;g++){e=a.indexOf(currentFeatures[g]);if(e!=-1){var i=a.substr(e+4);e=i.indexOf(",");if(e!=-1){i=i.substring(0,e)}if(i.indexOf("off")==-1&&i.indexOf("0")==-1){if(d!=""){d+=" "}d+=i.match(/\d+/)[0];if(c!=""){c+=" "}c+=currentFeatures[g];b=true}}}}}return[b,c,d]}function decimalToHex(a,c){var b=Number(a).toString(16);if(typeof(c)!="undefined"){while(b.length<c){b="0"+b}}return b}function checkToCallbackTrigger(){callCnt++;if(callCnt==triggerCounter){callbackTrigger();callCnt=0;triggerCounter=0}}function getScipt(c,a){var b=document.createElement("script");b.type="text/javascript";b.setAttribute("src",c);if(document.all&&(majorVersion<9||majorVersion>9)){b.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){a()}}}else{b.onload=a}document.getElementsByTagName("head")[0].appendChild(b)}function LoadAllFeatures(b,d,c,a){checkImplicitLigaSupport();callbackfontname="otf_"+d;fontNameToIds["'"+c+"'"]={contentId:b,variationId:d};callbackroutine=a;if(loadedList.indexOf(d)==-1){loadedList+=d+" ";getScipt(jsParentDirectory+b+"/"+callbackfontname+"OTFFeatDisabled.js",function(){var e=window[callbackfontname+"OTFFeatLookupIndex"]();var f=window[callbackfontname+"OTFFeatDisable"]();var g=[];for(var k=0;k<e.length;k++){var h=e[k];if(f.indexOf(h)==-1){g.push(h)}}triggerCounter=g.length;for(k=0;k<g.length;k++){var j=jsParentDirectory+b+"/"+callbackfontname+g[k]+".js";getScipt(j,checkToCallbackTrigger)}})}else{callbackTrigger()}}function callbackTrigger(){currentFeatures=window[callbackfontname+"OTFFeatLookupIndex"]();callbackroutine(window[callbackfontname+"OTFFeatDisable"]())}function getFunctionName(b,c){var a=fontNameToIds[b];return"otf_"+a.variationId+c}function ApplyFeaturesForElementsByStyle(a){checkImplicitLigaSupport();if(hasOTFSupport!=1){setStyleForElementsByStyle(a)}}function setStyleForElementsByStyle(c){for(var g=0;g<c.length;g++){var b=c[g];if(b.attributes!=null){var h=b.attributes.getNamedItem("style");if(h!=null){var n=doesClassHasFFSProp(h.value,null,true);if(!n[0]){continue}var d=getFontFamilyName(b);var l=n[1].split(" ");var m=n[2].split(" ");b.value="NULL";for(var j=0;j<l.length;j++){b.innerHTML=b.innerHTML.replace(/&nbsp;/g,"<space>").replace(/&amp;/g,"<amp>").replace(/&lt;/g,"<lt>").replace(/&gt;/g,"<gt>").replace(/&quot;/g,"<quot>");var f=getFunctionName(d,l[j]);try{if(window[f]!=null){window[f](b,m[j])}}catch(a){if(console){console.log("Error applying feature -"+l[j]+". Exception - "+a.message)}}b.innerHTML=b.innerHTML.replace(/<space>/g,"&nbsp;").replace(/<amp>/g,"&amp;").replace(/<lt>/g,"&lt;").replace(/<gt>/g,"&gt;").replace(/<quot>/g,"&quot;")}}}}}function applyOtJsForElement(b,f,g,c){if(hasOTFSupport!=1){if(!c){c=getFontFamilyName(b)}else{c="'"+c+"'"}b.value="NULL";if(g==null){g=1}for(var d=0;d<f.length;d++){b.innerHTML=b.innerHTML.replace(/&nbsp;/g,"<space>").replace(/&amp;/g,"<amp>").replace(/&lt;/g,"<lt>").replace(/&gt;/g,"<gt>").replace(/&quot;/g,"<quot>");try{if(window[getFunctionName(c,f[d])]){window[getFunctionName(c,f[d])](b,g)}}catch(a){if(console){console.log("Error applying feature -"+f[d]+". Exception - "+a.message)}}b.innerHTML=b.innerHTML.replace(/<space>/g,"&nbsp;").replace(/<amp>/g,"&amp;").replace(/<lt>/g,"&lt;").replace(/<gt>/g,"&gt;").replace(/<quot>/g,"&quot;")}}};(function(a){var b=function(){var y={},z,e=65,S,O='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',g={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:true,flat:false},n=function(U,T){var V=x(U);a(T).data("colorpicker").fields.eq(1).val(V.r).end().eq(2).val(V.g).end().eq(3).val(V.b).end()},m=function(U,T){a(T).data("colorpicker").fields.eq(4).val(U.h).end().eq(5).val(U.s).end().eq(6).val(U.b).end()},l=function(U,T){a(T).data("colorpicker").fields.eq(0).val(w(U)).end()},M=function(U,T){a(T).data("colorpicker").selector.css("backgroundColor","#"+w({h:U.h,s:100,b:100}));a(T).data("colorpicker").selectorIndic.css({left:parseInt(150*U.s/100,10),top:parseInt(150*(100-U.b)/100,10)})},K=function(U,T){a(T).data("colorpicker").hue.css("top",parseInt(150-150*U.h/360,10))},J=function(U,T){a(T).data("colorpicker").currentColor.css("backgroundColor","#"+w(U))},L=function(U,T){a(T).data("colorpicker").newColor.css("backgroundColor","#"+w(U))},B=function(U){var V=U.charCode||U.keyCode||-1;if((V>e&&V<=90)||V==32){return false}var T=a(this).parent().parent();if(T.data("colorpicker").livePreview===true){d.apply(this)}},d=function(V){var T=a(this).parent().parent(),U;if(this.parentNode.className.indexOf("_hex")>0){T.data("colorpicker").color=U=t(o(this.value))}else{if(this.parentNode.className.indexOf("_hsb")>0){T.data("colorpicker").color=U=p({h:parseInt(T.data("colorpicker").fields.eq(4).val(),10),s:parseInt(T.data("colorpicker").fields.eq(5).val(),10),b:parseInt(T.data("colorpicker").fields.eq(6).val(),10)})}else{T.data("colorpicker").color=U=I(q({r:parseInt(T.data("colorpicker").fields.eq(1).val(),10),g:parseInt(T.data("colorpicker").fields.eq(2).val(),10),b:parseInt(T.data("colorpicker").fields.eq(3).val(),10)}))}}if(V){n(U,T.get(0));l(U,T.get(0));m(U,T.get(0))}M(U,T.get(0));K(U,T.get(0));L(U,T.get(0));T.data("colorpicker").onChange.apply(T,[U,w(U),x(U)])},c=function(U){var T=a(this).parent().parent();T.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},r=function(){e=this.parentNode.className.indexOf("_hex")>0?70:65;a(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus");a(this).parent().addClass("colorpicker_focus")},i=function(U){var V=a(this).parent().find("input").focus();var T={el:a(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:U.pageY,field:V,val:parseInt(V.val(),10),preview:a(this).parent().parent().data("colorpicker").livePreview};a(document).bind("mouseup",T,Q);a(document).bind("mousemove",T,E)},E=function(T){T.data.field.val(Math.max(0,Math.min(T.data.max,parseInt(T.data.val+T.pageY-T.data.y,10))));if(T.data.preview){d.apply(T.data.field.get(0),[true])}return false},Q=function(T){d.apply(T.data.field.get(0),[true]);T.data.el.removeClass("colorpicker_slider").find("input").focus();a(document).unbind("mouseup",Q);a(document).unbind("mousemove",E);return false},h=function(U){var T={cal:a(this).parent(),y:a(this).offset().top};T.preview=T.cal.data("colorpicker").livePreview;a(document).bind("mouseup",T,P);a(document).bind("mousemove",T,D)},D=function(T){d.apply(T.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(T.pageY-T.data.y))))/150,10)).get(0),[T.data.preview]);return false},P=function(T){n(T.data.cal.data("colorpicker").color,T.data.cal.get(0));l(T.data.cal.data("colorpicker").color,T.data.cal.get(0));a(document).unbind("mouseup",P);a(document).unbind("mousemove",D);return false},j=function(U){var T={cal:a(this).parent(),pos:a(this).offset()};T.preview=T.cal.data("colorpicker").livePreview;a(document).bind("mouseup",T,R);a(document).bind("mousemove",T,F)},F=function(T){d.apply(T.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(T.pageY-T.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(T.pageX-T.data.pos.left))))/150,10)).get(0),[T.data.preview]);return false},R=function(T){F(T);n(T.data.cal.data("colorpicker").color,T.data.cal.get(0));l(T.data.cal.data("colorpicker").color,T.data.cal.get(0));a(document).unbind("mouseup",R);a(document).unbind("mousemove",F);return false},k=function(T){a(this).addClass("colorpicker_focus")},C=function(T){a(this).removeClass("colorpicker_focus")},f=function(V){var T=a(this).parent();var U=T.data("colorpicker").color;T.data("colorpicker").origColor=U;J(U,T.get(0));T.data("colorpicker").onSubmit(U,w(U),x(U),T.data("colorpicker").el)},N=function(U){var T=a("#"+a(this).data("colorpickerId"));T.data("colorpicker").onBeforeShow.apply(this,[T.get(0)]);var W=a(this).offset();var Y=s();var X=W.top+this.offsetHeight;var V=W.left;if(X+176>Y.t+Y.h){X-=this.offsetHeight+176}if(V+356>Y.l+Y.w){V-=356}T.css({left:V+"px",top:X+"px"});if(T.data("colorpicker").onShow.apply(this,[T.get(0)])!=false){T.show()}a(document).bind("mousedown",{cal:T},v);return false},v=function(T){if(!A(T.data.cal.get(0),T.target,T.data.cal.get(0))){if(T.data.cal.data("colorpicker").onHide.apply(this,[T.data.cal.get(0)])!=false){T.data.cal.hide()}a(document).unbind("mousedown",v)}},A=function(V,U,T){if(V==U){return true}if(V.contains){return V.contains(U)}if(V.compareDocumentPosition){return !!(V.compareDocumentPosition(U)&16)}var W=U.parentNode;while(W&&W!=T){if(W==V){return true}W=W.parentNode}return false},s=function(){var T=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(T?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(T?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(T?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(T?document.documentElement.clientHeight:document.body.clientHeight)}},p=function(T){return{h:Math.min(360,Math.max(0,T.h)),s:Math.min(100,Math.max(0,T.s)),b:Math.min(100,Math.max(0,T.b))}},q=function(T){return{r:Math.min(255,Math.max(0,T.r)),g:Math.min(255,Math.max(0,T.g)),b:Math.min(255,Math.max(0,T.b))}},o=function(T){var V=6-T.length;if(V>0){var W=[];for(var U=0;U<V;U++){W.push("0")}W.push(T);T=W.join("")}return T},u=function(T){var T=parseInt(((T.indexOf("#")>-1)?T.substring(1):T),16);return{r:T>>16,g:(T&65280)>>8,b:(T&255)}},t=function(T){return I(u(T))},I=function(X){var U={h:0,s:0,b:0};var W=Math.min(X.r,X.g,X.b);var V=Math.max(X.r,X.g,X.b);var T=V-W;U.b=V;if(V!=0){}U.s=V!=0?255*T/V:0;if(U.s!=0){if(X.r==V){U.h=(X.g-X.b)/T}else{if(X.g==V){U.h=2+(X.b-X.r)/T}else{U.h=4+(X.r-X.g)/T}}}else{U.h=-1}U.h*=60;if(U.h<0){U.h+=360}U.s*=100/255;U.b*=100/255;return U},x=function(U){var V={};var T=Math.round(U.h);var W=Math.round(U.s*255/100);var aa=Math.round(U.b*255/100);if(W==0){V.r=V.g=V.b=aa}else{var X=aa;var Y=(255-W)*aa/255;var Z=(X-Y)*(T%60)/60;if(T==360){T=0}if(T<60){V.r=X;V.b=Y;V.g=Y+Z}else{if(T<120){V.g=X;V.b=Y;V.r=X-Z}else{if(T<180){V.g=X;V.r=Y;V.b=Y+Z}else{if(T<240){V.b=X;V.r=Y;V.g=X-Z}else{if(T<300){V.b=X;V.g=Y;V.r=Y+Z}else{if(T<360){V.r=X;V.g=Y;V.b=X-Z}else{V.r=0;V.g=0;V.b=0}}}}}}}return{r:Math.round(V.r),g:Math.round(V.g),b:Math.round(V.b)}},H=function(U){var T=[U.r.toString(16),U.g.toString(16),U.b.toString(16)];a.each(T,function(V,W){if(W.length==1){T[V]="0"+W}});return T.join("")},w=function(T){return H(x(T))},G=function(){var T=a(this).parent();var U=T.data("colorpicker").origColor;T.data("colorpicker").color=U;n(U,T.get(0));l(U,T.get(0));m(U,T.get(0));M(U,T.get(0));K(U,T.get(0));L(U,T.get(0))};return{init:function(T){T=a.extend({},g,T||{});if(typeof T.color=="string"){T.color=t(T.color)}else{if(T.color.r!=undefined&&T.color.g!=undefined&&T.color.b!=undefined){T.color=I(T.color)}else{if(T.color.h!=undefined&&T.color.s!=undefined&&T.color.b!=undefined){T.color=p(T.color)}else{return this}}}return this.each(function(){if(!a(this).data("colorpickerId")){var W=a.extend({},T);W.origColor=T.color;var V="collorpicker_"+parseInt(Math.random()*1000);a(this).data("colorpickerId",V);var U=a(O).attr("id",V);if(W.flat){U.appendTo(this).show()}else{U.appendTo(document.body)}W.fields=U.find("input").bind("keyup",B).bind("change",d).bind("blur",c).bind("focus",r);U.find("span").bind("mousedown",i).end().find(">div.colorpicker_current_color").bind("click",G);W.selector=U.find("div.colorpicker_color").bind("mousedown",j);W.selectorIndic=W.selector.find("div div");W.el=this;W.hue=U.find("div.colorpicker_hue div");U.find("div.colorpicker_hue").bind("mousedown",h);W.newColor=U.find("div.colorpicker_new_color");W.currentColor=U.find("div.colorpicker_current_color");U.data("colorpicker",W);U.find("div.colorpicker_submit").bind("mouseenter",k).bind("mouseleave",C).bind("click",f);n(W.color,U.get(0));m(W.color,U.get(0));l(W.color,U.get(0));K(W.color,U.get(0));M(W.color,U.get(0));J(W.color,U.get(0));L(W.color,U.get(0));if(W.flat){U.css({position:"relative",display:"block"})}else{a(this).bind(W.eventName,N)}}})},showPicker:function(){return this.each(function(){if(a(this).data("colorpickerId")){N.apply(this)}})},hidePicker:function(){return this.each(function(){if(a(this).data("colorpickerId")){a("#"+a(this).data("colorpickerId")).hide()}})},setColor:function(T){if(typeof T=="string"){T=t(T)}else{if(T.r!=undefined&&T.g!=undefined&&T.b!=undefined){T=I(T)}else{if(T.h!=undefined&&T.s!=undefined&&T.b!=undefined){T=p(T)}else{return this}}}return this.each(function(){if(a(this).data("colorpickerId")){var U=a("#"+a(this).data("colorpickerId"));U.data("colorpicker").color=T;U.data("colorpicker").origColor=T;n(T,U.get(0));m(T,U.get(0));l(T,U.get(0));K(T,U.get(0));M(T,U.get(0));J(T,U.get(0));L(T,U.get(0));U.data("colorpicker").onChange.apply(U,[T,w(T),x(T)])}})}}}();a.fn.extend({ColorPicker:b.init,ColorPickerHide:b.hidePicker,ColorPickerShow:b.showPicker,ColorPickerSetColor:b.setColor})})(jQuery);var console=window.console||{};console.log=console.log||$.noop;console.warn=console.warn||$.noop;console.error=console.error||$.noop;console.info=console.info||$.noop;var Common=(function($){var common={};common.paramsToJSON=function(queryString){this._paramsJSON={};this._jsonString="";if(!queryString){queryString=location+""}var parts=queryString.split(/[?;]/);var urlPart=parts[0];var parametersPart=queryString.substr(urlPart.length);if(urlPart.length<=1&&parametersPart.length<=1){return false}var pairs=parametersPart.substr(1).split(/[&;]/);for(var i=0;i<pairs.length;i++){var pair=pairs[i].split(/=/);var name=decodeURIComponent(pair[0].replace(/\+/g," "));if(Boolean(pair[1])){var value=decodeURIComponent(pair[1].replace(/\+/g," "));if(this._jsonString!=""){this._jsonString+=","}this._jsonString+="'"+name+"' : '"+value+"'"}}eval("this._paramsJSON = {"+this._jsonString+"}");return this._paramsJSON};var queryStringParseRegEx=new RegExp("([^?=&]+)(=([^&]*))?","g");common.queryStringToObject=function(queryString){var obj={};if(queryString==null||queryString.length==0){return obj}queryString.replace(queryStringParseRegEx,function($0,$1,$2,$3){obj[$1.toLowerCase()]=decodeURIComponent($3)});return obj};common.invoke=function(params,method,confirmation,callback){if(typeof confirmation==="function"){callback=confirmation}if(typeof confirmation==="string"){if(!confirm(confirmation)){return false}}if(method&&method=="post"){$.post(params.InvokeUrl?params.InvokeUrl:window.location.href,params,function(data,textStatus){if(typeof callback==="function"){callback(data,textStatus)}else{if(textStatus=="success",params.ResponseContainer&&params.ResponseContainer!=""){$(params.ResponseContainer).html(data)}}})}else{$.get(params.InvokeUrl?params.InvokeUrl:window.location.href,params,function(data,textStatus){if(typeof callback==="function"){callback(data,textStatus)}else{if(textStatus=="success",params.ResponseContainer&&params.ResponseContainer!=""){$(params.ResponseContainer).html(data);jQuery.validator.unobtrusive.parse(params.ResponseContainer)}}})}return true};common.ajaxActionLink=function(tag,method,responseContainer){var link=$(tag).attr("href");if(!link||link==""){return false}if(!method||method==""){method=""}var paramsJson=common.paramsToJSON(link,responseContainer);common.invoke(paramsJson,method.toLowerCase())};common.postForm=function(form,callback){form=$(form);$.post(form.attr("action")||window.location.pathname,form.serialize(),callback)};common.addRow=function(tag){var rowId=$(tag).parent().parent().get(0).id;var newRowId=rowId+"-1";var tableId=$("#"+rowId).parent().parent().get(0).id;var exists=$("#"+newRowId).length;if(exists!=1){var n=$("#"+rowId+" td","#"+tableId).length;var tds='<tr id="'+newRowId+'"><td id="'+newRowId+'-2" colspan="'+n+'">&nbsp;</td></tr>';$("#"+rowId).after(tds);$("#"+rowId).addClass("expanded-row");$("#"+newRowId).addClass("expansion-row");return"#"+newRowId+"-2"}else{$("#"+rowId).removeClass("expanded-row");$("#"+newRowId).remove();return"0"}};common.editGridItem=function(tag,method){var responseContainer=common.addRow(tag);if(responseContainer!="0"){common.ajaxActionLink(tag,method,responseContainer)}};common.isNumeric=function(input){return((input-0)==input&&input.length>0)||((input-0)==input&&input.length==null)};common.replaceAll=function(sourceTxt,replaceThis,withThis){return sourceTxt.replace(new RegExp(replaceThis,"g"),withThis)};common.overlay=function(title,content,w){common.lockScreen();common.onUnlockOverlayScreen=function(){$("#fullscreen-overlay").hide()};if(w>0){$("#fullscreen-overlay").css({width:parseInt(w)+50+"px"});$("#fullscreen-overlay").css({"margin-left":"-"+(w/2)+"px"})}else{$("#fullscreen-overlay").css({width:"800px"});$("#fullscreen-overlay").css({"margin-left":"-400px"})}$("#fullscreen-overlay").css({top:($(window).scrollTop()+50)+"px"});if(title){$("#fullscreen-overlay-title").html(title)}if(content){$("#fullscreen-overlay-content").html(content)}$("#fullscreen-overlay,#screenlock").show()};common.lockScreen=function(){$("#screenlock").show()};common.unlockOverlayScreen=function(){$("#screenlock").hide();common.onUnlockOverlayScreen()};common.unlockPopupScreen=function(){$("#screenlock").hide();common.onUnlockScreen();common.onUnlockScreen=function(){}};common.hexToDec=function(hex){var num=parseInt(hex,16);if(Common.isNumeric(num)){return num}return null};common.guid=function(){var s4=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4())};common.getHashCode=function(str){var res=0,len=str.length;for(var i=0;i<len;i++){res=res*31+str.charCodeAt(i);res=res&res}return res};return common}(jQuery));jQuery.cookie=function(j,i,g){if(typeof i!="undefined"){g=g||{};if(i===null){i="",g.expires=-1}var h="";if(g.expires&&(typeof g.expires=="number"||g.expires.toUTCString)){typeof g.expires=="number"?(h=new Date,h.setTime(h.getTime()+g.expires*86400000)):h=g.expires,h="; expires="+h.toUTCString()}var k=g.path?"; path="+g.path:"",l=g.domain?"; domain="+g.domain:"",g=g.secure?"; secure":"";document.cookie=[j,"=",encodeURIComponent(i),h,k,l,g].join("")}else{i=null;if(document.cookie&&document.cookie!=""){g=document.cookie.split(";");for(h=0;h<g.length;h++){if(k=jQuery.trim(g[h]),k.substring(0,j.length+1)==j+"="){i=decodeURIComponent(k.substring(j.length+1));break}}}return i}};jQuery.fn.showLoading=function(j){var d;var p={addClass:"",beforeShow:"",afterShow:"",hPos:"center",vPos:"center",indicatorZIndex:5001,overlayZIndex:5000,parent:null,marginTop:0,marginLeft:0,overlayWidth:null,overlayHeight:null,position:"absolute",inverse:false};jQuery.extend(p,j);var i=jQuery("<div></div>");var o=jQuery("<div></div>");var g="";if(p.inverse){g="-inverse"}if(p.indicatorId){d=p.indicatorId}else{d=jQuery(this).attr("id")}jQuery(i).attr("id","loading-indicator-"+d);jQuery(i).addClass("loading-indicator"+g);if(p.addClass){jQuery(o).addClass(p.addClass+"-overlay")}if(p.addClass){jQuery(i).addClass(p.addClass)}jQuery(o).css("display","none");jQuery(this).append(o);jQuery(o).attr("id","loading-indicator-"+d+"-overlay");jQuery(o).addClass("loading-indicator-overlay"+g);if(p.addClass){jQuery(o).addClass(p.addClass+"-overlay")}var n;var k;var b=jQuery(this).css("border-top-width");var a=jQuery(this).css("border-left-width");b=isNaN(parseInt(b))?0:b;a=isNaN(parseInt(a))?0:a;var h=jQuery(this).css("position")=="relative"?0:jQuery(this).position().left;var q=jQuery(this).css("position")=="relative"?0:jQuery(this).position().top;var l=h+parseInt(a);var m=q+parseInt(b);if(p.overlayWidth!==null){n=p.overlayWidth}else{n=parseInt(jQuery(this).width())+parseInt(jQuery(this).css("padding-right"))+parseInt(jQuery(this).css("padding-left"))}if(p.overlayHeight!==null){k=p.overlayWidth}else{k=parseInt(jQuery(this).height())+parseInt(jQuery(this).css("padding-top"))+parseInt(jQuery(this).css("padding-bottom"))}jQuery(o).css("width",n.toString()+"px");jQuery(o).css("height",k.toString()+"px");jQuery(o).css("left",l.toString()+"px");jQuery(o).css("position",p.position);jQuery(o).css("top",m.toString()+"px");jQuery(o).css("z-index",p.overlayZIndex);if(p.overlayCSS){jQuery(o).css(p.overlayCSS)}jQuery(i).css("display","none");jQuery(this).append(i);jQuery(i).css("position",p.position);jQuery(i).css("z-index",p.indicatorZIndex);var f=m;if(p.marginTop){f+=parseInt(p.marginTop)}var e=l;if(p.marginLeft){e+=parseInt(p.marginTop)}if(p.hPos.toString().toLowerCase()=="center"){jQuery(i).css("left",(e+((jQuery(o).width()-parseInt(jQuery(i).width()))/2)).toString()+"px")}else{if(p.hPos.toString().toLowerCase()=="left"){jQuery(i).css("left",(e+parseInt(jQuery(o).css("margin-left"))).toString()+"px")}else{if(p.hPos.toString().toLowerCase()=="right"){jQuery(i).css("left",(e+(jQuery(o).width()-parseInt(jQuery(i).width()))).toString()+"px")}else{jQuery(i).css("left",(e+parseInt(p.hPos)).toString()+"px")}}}if(p.vPos.toString().toLowerCase()=="center"){jQuery(i).css("top",(f+((jQuery(o).height()-parseInt(jQuery(i).height()))/2)).toString()+"px")}else{if(p.vPos.toString().toLowerCase()=="top"){jQuery(i).css("top",f.toString()+"px")}else{if(p.vPos.toString().toLowerCase()=="bottom"){jQuery(i).css("top",(f+(jQuery(o).height()-parseInt(jQuery(i).height()))).toString()+"px")}else{jQuery(i).css("top",(f+parseInt(p.vPos)).toString()+"px")}}}if(p.css){jQuery(i).css(p.css)}var c={overlay:o,indicator:i,element:this};if(typeof(p.beforeShow)=="function"){p.beforeShow(c)}jQuery(o).show();jQuery(i).show();if(typeof(p.afterShow)=="function"){p.afterShow(c)}Fonts.Spinner.enableSpinners();return this};jQuery.fn.hideLoading=function(b){var d={};jQuery.extend(d,b);if(d.indicatorId){indicatorId=d.indicatorId}else{indicatorId=jQuery(this).attr("id")}var a=jQuery(document.body).find("#loading-indicator-"+indicatorId);var c=jQuery(document.body).find("#loading-indicator-"+indicatorId+"-overlay");a.remove();c.remove();Fonts.Spinner.disableSpinners();return this};(function(a){var b=10000;a.fn.lightbox_me=function(c){return this.each(function(){b=b+2;var k=a.extend({},a.fn.lightbox_me.defaults,c),f=a(),g=a(this);k.zIndex=b;var e=a('<iframe id="foo" style="z-index: '+(k.zIndex)+';border: none; margin: 0; padding: 0; position: absolute; width: 100%; height: 100%; top: 0; left: 0; filter: mask();"/>'),i=(a.browser.msie&&a.browser.version<7);if(k.showOverlay){var d=a(".js_lb_overlay:visible");if(d.length>0&&k.allowEmptyOverlay){f=a('<div class="lb_overlay_clear js_lb_overlay"/>')}else{f=a('<div class="'+k.classPrefix+'_overlay js_lb_overlay"/>')}}if(i){var n=/^https/i.test(window.location.href||"")?"javascript:false":"about:blank";e.attr("src",n);a("body").append(e)}a("body").append(g.hide()).append(f);if(k.showOverlay){l();f.css({position:"absolute",width:"100%",top:0,left:0,right:0,bottom:0,zIndex:(k.zIndex-1),display:"none"});if(!f.hasClass("lb_overlay_clear")){f.css(k.overlayCSS)}}if(k.showOverlay){f.fadeIn(k.overlaySpeed,function(){m();g[k.appearEffect](k.lightboxSpeed,function(){l();m();k.onLoad()})})}else{m();g[k.appearEffect](k.lightboxSpeed,function(){k.onLoad()})}if(k.parentLightbox){k.parentLightbox.fadeOut(200)}a(window).resize(l).resize(m).scroll(m).keyup(j);f.click(function(o){h();o.preventDefault});g.delegate(k.closeSelector,"click",function(o){h();o.preventDefault()});g.bind("close",h);g.bind("reposition",m);function h(){var o=g[0].style;k.onBeforeClose();if(k.destroyOnClose){g.add(f).remove()}else{g.add(f).hide()}if(k.parentLightbox){k.parentLightbox.fadeIn(200)}e.remove();g.undelegate(k.closeSelector,"click");a(window).unbind("reposition",l);a(window).unbind("reposition",m);a(window).unbind("scroll",m);a(window).unbind("keypress",j);if(i){o.removeExpression("top")}k.onClose()}function j(o){if((o.keyCode==27||(o.DOM_VK_ESCAPE==27&&o.which==0))&&k.closeEsc){h()}}function l(){if(a(window).height()<a(document).height()){f.css({height:a(document).height()+"px"});e.css({height:a(document).height()+"px"})}else{f.css({height:"100%"});if(i){a("html,body").css("height","100%");e.css("height","100%")}}}function m(){var o=g[0].style;g.css({left:"50%",marginLeft:(g.outerWidth(false)/2)*-1,zIndex:(k.zIndex)});if((g.height()+80>=a(window).height())&&(g.css("position")!="absolute"||i)){var q=a(document).scrollTop()+40;g.css({position:"absolute",top:q+"px",marginTop:0});if(i){o.removeExpression("top")}}else{if(g.height()+80<a(window).height()){if(i){o.position="absolute";if(k.centered){o.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');o.marginTop=0}else{var p=(k.modalCSS&&k.modalCSS.top)?parseInt(k.modalCSS.top):0;o.setExpression("top","((blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+p+') + "px"')}}else{if(k.centered){g.css({position:"fixed",top:"50%",marginTop:(g.outerHeight()/2)*-1})}else{g.css({position:"fixed"}).css(k.modalCSS)}}}}}})};a.fn.lightbox_me.defaults={appearEffect:"fadeIn",appearEase:"",overlaySpeed:250,lightboxSpeed:300,closeSelector:".close",closeClick:true,closeEsc:true,destroyOnClose:false,showOverlay:true,parentLightbox:false,onLoad:function(){},onClose:function(){},onBeforeClose:function(){},classPrefix:"lb",zIndex:10000,centered:false,modalCSS:{top:"70px"},overlayCSS:{background:"black",opacity:0.5},allowEmptyOverlay:true}})(jQuery);/*
* jQuery Selectbox plugin 0.1.3
*
* Copyright 2011, Dimitar Ivanov (http://www.bulgaria-web-developers.com/projects/javascript/selectbox/)
* Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
* 
* Date: Wed Jul 29 23:20:57 2011 +0200
*/
(function(a,f){var c="selectbox",b=false,e=true;function d(){this._state={};this._defaults={classHolder:"sbHolder",classHolderDisabled:"sbHolderDisabled",classSelector:"sbSelector",classSelectorFocused:"sbSelectorFocused",classOptions:"sbOptions",classGroup:"sbGroup",classSub:"sbSub",markerClasss:"sbMarked",classDisabled:"sbDisabled",classToggleOpen:"sbToggleOpen",classToggle:"sbToggle",speed:100,delay:1000,effect:"fade",onChange:null,onOpen:null,onClose:null}}a.extend(d.prototype,{_isOpenSelectbox:function(h){if(!h){return b}var g=this._getInst(h);return g.isOpen},_isDisabledSelectbox:function(h){if(!h){return b}var g=this._getInst(h);return g.isDisabled},_attachSelectbox:function(A,z){if(this._getInst(A)){return b}var g=a(A),y=this,n=y._newInst(g),t,v,w,u,r=b,q=g.find("option");g.attr("sb",n.uid);a.extend(n.settings,y._defaults,z);n.isOpen=false;n.searching=null;n.term="";n.highlightedItem=null;n.pageSize=1;n.mouseIsInArea=false;n.focusCheck=null;g.hide();t=a("<div>",{id:"sbHolder_"+n.uid,"class":n.settings.classHolder,mouseenter:function(){n.mouseIsInArea=true},mouseleave:function(){n.mouseIsInArea=false},click:function(s){l(s)},keydown:function(s){var C=true;switch(s.keyCode){case 9:h();C=false;break;case 13:if(n.isOpen){if(n.highlightedItem){var B=n.highlightedItem.children().first();if(B){y._changeSelectbox(A,B.attr("rel"),B.text())}}h()}else{p()}break;case 27:h();break;case 36:o(true);break;case 35:o(false);break;case 33:o(true,n.pageSize);break;case 34:o(false,n.pageSize);break;case 38:o(true,1);break;case 40:o(false,1);break;default:var D=String.fromCharCode(s.keyCode);if(D.match(/[a-zA-Z0-9\s]/)){clearTimeout(n.searching);n.searching=setTimeout(function(){n.term=""},n.settings.delay);x(n.term+D);break}C=false;break}if(C){s.preventDefault();s.stopPropagation()}}});if(g.children().length>1){v=a("<a>",{id:"sbSelector_"+n.uid,href:"#","class":n.settings.classSelector,tabindex:A.tabindex,focus:function(){clearTimeout(n.focusCheck);v.addClass(n.settings.classSelectorFocused)},blur:function(){v.removeClass(n.settings.classSelectorFocused);clearTimeout(n.focusCheck);n.focusCheck=setTimeout(function(){if(!n.mouseIsInArea){h()}},100)},click:function(s){l(s)}})}else{v=a("<div>",{id:"sbSelector_"+n.uid,"class":n.settings.classSelector,tabindex:A.tabindex})}w=a("<a>",{id:"sbToggle_"+n.uid,href:"#","class":n.settings.classToggle,tabindex:-1,click:function(s){l(s)}});u=j();function j(){var s='<ul id="sbOptions_'+n.uid+'" ';s+='class="'+n.settings.classOptions+'" ';s+='tabindex="-1" style="display:none;">';g.children().each(function(){var C=a(this),B={};if(C.is("option")){s+=k(C)}else{if(C.is("optgroup")){s+='<li><span class="'+n.settings.classGroup+'">';s+=C.attr("label");s+="</span></li>";if(C.attr("disabled")){B.disabled=true}B.sub=true;s+=k(C.find("option"),B)}}});s+="</ul>";return a(s).on("click","li",function(B){y._changeSelectbox(A,a(this).attr("rel"),a(this).text());h();v.focus();B.preventDefault();B.stopPropagation()}).on("mouseenter","li",function(B){m(a(this))}).on("click","a",function(B){y._changeSelectbox(A,a(this).attr("rel"),a(this).text());h();v.focus();B.preventDefault();B.stopPropagation()})}function l(s){if(n.isOpen){h()}else{p()}s.preventDefault();s.stopPropagation()}function i(){a("select[sb!='"+n.uid+"']").selectbox("close")}function p(){if(n.isOpen){return}i.apply(a(this),[]);var B=g.find("option[selected]");if(B.length){m(u.find("a[rel='"+B.attr("value")+"']").parent())}y._openSelectbox(A);v.focus();var s=u.children().first();if(s.length){n.pageSize=Math.floor(u.height()/s.outerHeight());if(n.pageSize<1){n.pageSize=1}}}function h(){if(!n.isOpen){return}clearTimeout(n.searching);if(n.highlightedItem){n.highlightedItem.removeClass("highlighted");n.highlightedItem=null}n.activeSelection=null;y._closeSelectbox(A)}function o(D,C){if(!n.isOpen){p();return}var s="li:has(a)";var B=null;if(n.highlightedItem&&C){if(C===1){B=(D)?n.highlightedItem.prev(s):n.highlightedItem.next(s)}else{var E=(D)?n.highlightedItem.prevAll(s):n.highlightedItem.nextAll(s);if(E.length){if(E.length>C){B=E.eq(C)}else{B=E.last()}}}}else{if(C){D=!D}B=(D)?u.children(s).first():u.children(s).last()}if(B&&B.length){m(B)}}function x(B){var s=new RegExp("^"+B);u.find("a").each(function(){var C=a(this);if(s.test(C.text().toUpperCase())){m(C.parent());n.term=B;if(!n.isOpen){p()}return false}})}function m(C){if(C===n.highlightedItem){return}if(n.highlightedItem){n.highlightedItem.removeClass("highlighted")}if(C&&C.length>0){n.highlightedItem=C;C.addClass("highlighted");var D=parseInt(u.css("maxHeight"),10);var F=u.scrollTop();var E=D+F;var B=C.position().top+F;var s=B+C.outerHeight();if(s>=E){u.scrollTop((s-D)>0?s-D:0)}else{if(B<F){u.scrollTop(B)}}}}function k(){var C=arguments[1]&&arguments[1].sub?true:false,s=arguments[1]&&arguments[1].disabled?true:false,B="";arguments[0].each(function(){var D=a(this);B+="<li>";if(D.attr("selected")){v.text(D.text());if(D.attr("data-marked")){v.addClass(n.settings.markerClasss)}t.addClass(D.attr("class"));r=e}if(!D.attr("disabled")&&!s){B+='<a href="#'+Common.replaceAll(D.val(),'"',"&quot;")+'"';B+='rel="'+Common.replaceAll(D.val(),'"',"&quot;")+'"';B+='class="'+(D.attr("class")?D.attr("class"):"");if(C){B+=" "+n.settings.classSub}if(D.attr("data-marked")){B+=" "+n.settings.markerClasss}B+='"';B+='tabindex="-1">';B+=D.text();B+="</a>"}else{B+='<span class="'+n.settings.classDisabled;if(C){B+=" "+n.settings.classSub}B+='">';B+=D.text();B+="</span>"}B+="</li>"});return B}if(!r){v.text(q.first().text());if(q.first().attr("data-marked")){v.addClass(n.settings.markerClasss)}}a.data(A,c,n);if(g.children().length>1){w.appendTo(t);v.appendTo(t);u.appendTo(t)}else{v.appendTo(t)}t.insertAfter(g)},_detachSelectbox:function(h){var g=this._getInst(h);if(!g){return b}a("#sbHolder_"+g.uid).remove();a.data(h,c,null);a(h).show()},_changeSelectbox:function(k,m,l){var g=this._getInst(k),h=this._get(g,"onChange");var i=a(k).find("option:selected");if(i.length&&i.attr("value")===m){return}a("#sbSelector_"+g.uid).text(l);var j=a(k).find("option[value='"+m+"']");j.attr("selected",e);a("#sbHolder_"+g.uid).attr("class",g.settings.classHolder);if(j.attr("class")!=""){a("#sbHolder_"+g.uid).addClass(j.attr("class"))}if(j.attr("data-marked")){a("#sbSelector_"+g.uid).addClass(g.settings.markerClasss)}else{a("#sbSelector_"+g.uid).removeClass(g.settings.markerClasss)}if(i.length){i.removeAttr("selected")}if(h){h.apply((g.input?g.input[0]:null),[m,g])}else{if(g.input){g.input.trigger("change")}}},_enableSelectbox:function(h){var g=this._getInst(h);if(!g||!g.isDisabled){return b}a("#sbHolder_"+g.uid).removeClass(g.settings.classHolderDisabled);g.isDisabled=b;a.data(h,c,g)},_disableSelectbox:function(h){var g=this._getInst(h);if(!g||g.isDisabled){return b}a("#sbHolder_"+g.uid).addClass(g.settings.classHolderDisabled);g.isDisabled=e;a.data(h,c,g)},_optionSelectbox:function(i,h,j){var g=this._getInst(i);if(!g){return b}g[h]=j;a.data(i,c,g)},_openSelectbox:function(p){var j=this._getInst(p);if(!j||j.isOpen||j.isDisabled){return}var h=a("#sbOptions_"+j.uid),l=h.parents(".modal-content"),n=this._get(j,"onOpen"),k=200;if(l.length==1){k=l.height()/2}else{var q=parseInt(a(window).height(),10),m=a("#sbHolder_"+j.uid).offset(),o=a(window).scrollTop(),i=h.prev().height(),g=q-(m.top-o)-i/2;k=g-i}h.css({maxHeight:k+"px"});switch(j.settings.effect){case"fade":a("#sbOptions_"+j.uid).stop().fadeIn(j.settings.speed);break;case"hide":a("#sbOptions_"+j.uid).show();break;default:a("#sbOptions_"+j.uid).stop().slideDown(j.settings.speed)}a("#sbToggle_"+j.uid).addClass(j.settings.classToggleOpen);this._state[j.uid]=e;j.isOpen=e;if(n){n.apply((j.input?j.input[0]:null),[j])}a.data(p,c,j)},_closeSelectbox:function(i){var g=this._getInst(i);if(!g||!g.isOpen){return}var h=this._get(g,"onClose");switch(g.settings.effect){case"fade":a("#sbOptions_"+g.uid).stop().fadeOut(g.settings.speed);break;case"hide":a("#sbOptions_"+g.uid).hide();break;default:a("#sbOptions_"+g.uid).stop().slideUp(g.settings.speed)}a("#sbToggle_"+g.uid).removeClass(g.settings.classToggleOpen);this._state[g.uid]=b;g.isOpen=b;if(h){h.apply((g.input?g.input[0]:null),[g])}a.data(i,c,g)},_newInst:function(h){var g=h[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:g,input:h,uid:Math.floor(Math.random()*99999999),isOpen:b,isDisabled:b,settings:{}}},_getInst:function(h){try{return a.data(h,c)}catch(g){throw"Missing instance data for this selectbox"}},_get:function(g,h){return g.settings[h]!==f?g.settings[h]:this._defaults[h]}});a.fn.selectbox=function(g){var h=Array.prototype.slice.call(arguments,1);if(typeof g=="string"&&g=="isDisabled"){return a.selectbox["_"+g+"Selectbox"].apply(a.selectbox,[this[0]].concat(h))}if(g=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return a.selectbox["_"+g+"Selectbox"].apply(a.selectbox,[this[0]].concat(h))}return this.each(function(){typeof g=="string"?a.selectbox["_"+g+"Selectbox"].apply(a.selectbox,[this].concat(h)):a.selectbox._attachSelectbox(this,g)})};a.selectbox=new d();a.selectbox.version="0.1.3"})(jQuery);$(function(){var d=$(".productpopper"),e=$('<div class="product-popup" style="display:none;"></div>').appendTo("body"),g=0,f=0,b=[],c,a=function(){c=null;g=setTimeout(function(){e.hide().html("")},250)},h=function(k,j){if(j.indexOf("Not Found")===-1){clearTimeout(g);var n=k.offset(),o=k.hasClass("popleft"),p=k.hasClass("popright"),l=k.height(),i,q,m;if(o){q=n.top-20;m=n.left-185;i='<div class="popuparrow-right"></div>'}else{if(p){q=n.top-20;m=n.left+k.width()+23;i='<div class="popuparrow-left"></div>'}else{q=n.top+l+15;m=n.left-20;i='<div class="popuparrow-up"></div>'}}e.html(i+j).css({top:q+"px",left:m+"px"}).fadeIn("fast")}};e.bind("mouseenter",function(){clearTimeout(g)}).bind("mouseleave",a);d.click(function(i){i.preventDefault();$(document).unbind("ajaxError");var j=$(this).attr("href");if(j!=="undefined"&&j!=null){window.location=j}});d.bind("mouseenter",function(){var i=$(this),l=i.attr("href"),k=i.data("frs-id"),j=b[l];c=l;if(j){clearTimeout(f);f=setTimeout(function(){h(i,j)},200)}else{if(SiteUrls&&SiteUrls.getProductPopup()){$.post(SiteUrls.getProductPopup(),{href:l,frsId:k},function(m){b[l]=m;if(c===l){h(i,m)}})}}}).bind("mouseleave",function(){clearTimeout(f);a()})});var Cookies=(function(a){var b={};b.get=function(j){var c=document.cookie.split(";"),h,k,d,g;for(g=0;g<c.length;g++){d=c[g].split("=");h=d[0];k=d[1];if(a.trim(h)===j){try{return decodeURIComponent(unescape(k))}catch(f){return unescape(decodeURIComponent(k))}}}return null};b.set=function(g,i,d,h){var e="",c,f=86400000;if(d){c=new Date();c.setTime(c.getTime()+(d*f));e="; expires="+c.toGMTString()}if(h==null||h.length==0){h="/"}document.cookie=g+"="+i+e+"; path="+h};b.clear=function(){var c=document.cookie.split(";"),e,d;for(d=0;d<c.length;d++){e=c[d].split("=")[0];if(a.trim(e).indexOf("__")!==0){b.set(e,"",-1)}}};return b}(jQuery));var Header=(function(a){return{ClearFields:function(c,b){if(b==undefined){b=true}a(c+" span.error-text").text("");a(c+" input, "+c+" textarea").removeClass("input-validation-error");if(b){a(c+' input[type="text"], '+c+' input[type="password"], '+c+' input[type="email"], '+c+" textarea").val("");a(c+" #need-support-subject").find("option[value='']").attr("selected","selected");a(c+" #support-problem-type").hide();a(c+" #support-problem-type-note").hide()}a(c+" .user-message").html("");a(c+" #default-user-messages-container").hide();a(c+" #error-user-message-container").hide();a(c+" #success-user-message-container").hide();return this}}}(jQuery));var TopNavigation=(function(a){var b=function(){var c=a(this);c.click(function(f){var i=c.parentsUntil(".account-wrap").siblings(),h=c.parent(),g=a(".hovered",h),d="active";a(".account-wrap .hovered:visible").hide();i.children().children().removeClass(d);i.removeClass(d);if(h.hasClass(d)){g.fadeOut("fast");h.removeClass(d)}else{g.fadeIn("fast");h.addClass(d)}f.preventDefault();f.stopPropagation()})};return{bindAccountWrap:function(){a(".account-wrap .trigger").not(".dev-flash-sale").each(b)},bindCartFloating:function(){a("#cart-floating-nav-container .trigger").not(".dev-flash-sale").each(b)}}}(jQuery));$(function(){TopNavigation.bindAccountWrap();$(".close").click(function(a){$("select[sb]").selectbox("close");$(this).closest(".hovered").fadeOut("fast");$(this).parentsUntil(".account-nav").removeClass("active");a.preventDefault()});$("html").click(function(a){if(!a.isDefaultPrevented()){$("select[sb]").selectbox("close");$(".hovered").hide();$(".account-nav li, .cart-nav li").removeClass("active")}});$(".account-nav li, .cart-nav li").click(function(a){$("select[sb]").selectbox("close");a.stopPropagation()});$(".account-wrap .trigger").click(function(){Header.ClearFields("header .create-account-form").ClearFields("header .member-sign-in-form").ClearFields("header #need-support-form",false).ClearFields("header .password-reset-form");Fonts.Account.RestoreMemberSigninForm();Fonts.Account.RestoreNeedSupportForm()});$("select.adorn").selectbox();$("input.show-me").show();Fonts.CartSummary.BindAllCartNavigationBlockEvents()});var AttachAutoCompleteSearch=function(){var a=SiteUrls!=undefined?SiteUrls.searchAutoCompleteUrl():Fonts.Urls.searchAutoCompleteUrl();$("#searchtext").autocomplete({serviceUrl:a,width:236});$("#searchtext1").autocomplete({serviceUrl:a,width:478});$("#searchtext, #searchtext1").keypress(function(b){if(b.which===13){$(this).blur();$("#search input[type='submit']").focus().click();b.preventDefault();return false}return true})};var SideBar=(function(a){var c=function(d,e){d.show();e.html(" - Less...")},b=function(d,e){d.hide();e.html(" + More...")};return{ToggleShowMoreFontsInThisProduct:function(){var d=a(".more-fontsinthisproduct"),e=a("#show-more-fontsinthisproduct");if(window.showMoreFontsInThisProduct!=true){c(d,e);window.showMoreFontsInThisProduct=true}else{b(d,e);window.showMoreFontsInThisProduct=false}},ToggleShowMoreCategories:function(){var d=a(".more-categories"),e=a("#show-more-categories");if(window.showMoreCategories===false){c(d,e);window.showMoreCategories=true}else{b(d,e);window.showMoreCategories=false}},ToggleShowMoreKeywords:function(){var d=a(".more-keywords"),e=a("#show-more-keywords");if(window.showMoreKeywords===false){c(d,e);window.showMoreKeywords=true}else{b(d,e);window.showMoreKeywords=false}},ToggleAddKeywordForm:function(d){a(d).toggle();a("input:[name=Name]",d).focus()}}}(jQuery));var BindTextPopperHover=function(a){a.hover(function(){var b=$(this);b.data("timer",setTimeout(function(){b.next(".popup").fadeIn("fast")},250))},function(){clearTimeout($(this).data("timer"));$(this).next(".popup").fadeOut("fast")})};SiteUrls=(function(){var a={};return{bindUrls:function(b){a=b},changeHeroImage:function(){return a.changeHeroImageTemplateAddress},getProductPopup:function(){return a.getProductPopupTemplate},getFeaturedFontsRolloverPopup:function(){return a.getFeaturedFontsRolloverPopupTemplate},customerMemberForms:function(){return a.customerMemberForms},customerNeedSupportSection:function(){return a.customerNeedSupportSection},cartTotalSection:function(){return a.cartTotalSection},miniCartSection:function(){return a.miniCartSection},getOtSelectors:function(){return a.getOtSelectors},updateSelectorOtf:function(){return a.updateSelectorOtf},detachProjectSelector:function(){return a.detachProjectSelector},detachProjectSelectors:function(){return a.detachProjectSelectors},searchAutoCompleteUrl:function(){return a.searchAutoCompleteUrl},getAddToCartCheck:function(){return a.addToCartCheck}}}());var Fonts=(function(a){var b={};b.makeSelectorWithHashIESafe=function(d){var e=d.split("#"),c=d;if(e.length>1){c="#"+e[1]}return c};return b}(jQuery));Fonts.Timers=(function(){var f={},j={},b=86400000,c=3600000,d=60000,e=1000,g="onExpired",h="data-skyfont-guid",a=function(k){var m,n,l={timeout:null,formattedTime:null};if(k>b){l.timeout=k%c||c;m=Math.floor(k/b);n=Math.ceil((k%b)/c);if(n===24){m+=1;n=0}l.formattedTime=m+"d:"+n+"h"}else{if(k<=b&&k>c){l.timeout=k%d||d;m=Math.floor(k/c);n=Math.ceil((k%c)/d);if(n===60){m+=1;n=0}l.formattedTime=m+"h:"+n+"m";if(m===24){l.formattedTime="1d:0h"}}else{if(k<=c&&k>0){l.timeout=k%e||e;m=Math.floor(k/d);n=Math.ceil((k%d)/e);if(n===60){m+=1;n=0}l.formattedTime=m+"m:"+n+"s";if(m===60){l.formattedTime="1h:0m"}}else{if(k<=0){l.formattedTime="0m:0s"}}}}return l},i=function(k){this.RemainingTime=k.RemainingTime;this.Guid=k.Guid;this.element=$("span.dev-timer["+h+'="'+k.Guid+'"]');this.FormatedTime=null;this.currentTimeoutId=null};i.prototype.tick=function(){var k=this,l=a(k.RemainingTime);if(k.element.length){k.RemainingTime-=l.timeout;k.FormatedTime=l.formattedTime;k.element.html(k.FormatedTime);if(l.timeout){k.currentTimeoutId=setTimeout(function(){k.tick()},l.timeout)}else{k.element.trigger(g)}}};i.prototype.refresh=function(){var k=this;k.element=$("span.dev-timer["+h+'="'+k.Guid+'"]');k.element.html(k.FormatedTime)};f.bindOnExpired=function(k,l){k.on(g,l)};f.unbindOnExpired=function(k){k.off(g)};f.bind=function(l){var n=l.length,k,m;while(n--){k=l[n];m=k.Guid;if(!j[m]){j[m]=new i(k);j[m].tick()}else{j[m].refresh()}}};f.update=function(l){var m=l.length,k,n;while(m--){k=l[m];n=j[k.Guid];if(n){n.RemainingTime=k.RemainingTime;n.refresh()}}};f.refresh=function(){var k,l;for(k in j){l=j[k];l.refresh();if(!l.element.length){clearTimeout(l.currentTimeoutId);delete j[k]}}};f.destroy=function(k){k.each(function(){var l=$(this),m=l.attr(h),n=j[m];f.unbindOnExpired(l);if(n){clearTimeout(n.currentTimeoutId);delete j[m]}})};return f}(jQuery));$(document).ajaxError(function(a,c,f,b){if(c.state()==="rejected"&&c.getAllResponseHeaders()===""){return}if(c.status===401&&f.url.indexOf("/web-fonts/")!=-1){var d={ReturnUrl:window.location.pathname};window.location.href=Fonts.Urls.getLoginUrl()+"?"+$.param(d)}else{if(typeof Fonts!=="undefined"&&typeof Fonts.Messages!=="undefined"){if(Fonts.Messages.existsContainer()){Fonts.Messages.clearAll();Fonts.Messages.addError(Fonts.Translations.getErrorMessage())}}else{alert(Fonts.Translations.getErrorMessage())}}});Fonts.Messages=(function(a){var b=new UserMessages(a,"default-user-messages-container");return b}(jQuery));function UserMessages(a,b){var d={};function c(){return a("#"+b)}d.existsContainer=function(){return c().find(".error-user-message-container").length>0};d.addCaution=function(e){c().find(".caution.user-message").append("<p>"+e+"</p>");c().find(".caution-user-message-container").show()};d.addCautionWithFadeOut=function(e){c().find(".caution-user-message-container").show();Fonts.UI.ShowAndRemove({container:c().find(".caution.user-message"),data:"<p>"+e+"</p>",callback:function(){c().find(".caution-user-message-container").hide()}});return d};d.addError=function(e){c().find(".error.user-message").append("<p>"+e+"</p>");c().find(".error-user-message-container").show()};d.addSuccess=function(e,f){c().find(".success-user-message-container").show();Fonts.UI.ShowAndRemove({container:c().find(".success.user-message"),data:"<p>"+e+"</p>",callback:function(){c().find(".success-user-message-container").hide();if(f!=undefined){f()}}});return d};d.addMessage=function(f,e){if(f.SuccessMessage){d.addSuccess(f.SuccessMessage.replace(/\\"/g,"'"),e)}if(f.WarningMessage){d.addCaution(f.WarningMessage.replace(/\\"/g,"'"))}if(f.ErrorMessage){d.addError(f.ErrorMessage.replace(/\\"/g,"'"))}};d.clearCautions=function(){c().find(".caution.user-message").empty();c().find(".caution-user-message-container").hide()};d.clearErrors=function(){c().find(".error.user-message").empty();c().find(".error-user-message-container").hide()};d.clearSuccess=function(){c().find(".success.user-message").empty();c().find(".success-user-message-container").hide();return d};d.clearAll=function(){d.clearCautions();d.clearErrors();d.clearSuccess()};d.singleSuccess=function(e){d.clearAll();d.addSuccess(e)};d.singleError=function(e){d.clearAll();d.addError(e)};d.singleCaution=function(e){d.clearAll();d.addCaution(e)};d.singleCautionWithFadeOut=function(e){d.clearAll();d.addCautionWithFadeOut(e)};return d};var Search=(function(a){var d={};var c=false;var b=false;d.GetSearchForm=function(){return a("form.search-form")};d.UpdateSearchComponentWithSearchFormFields=function(){var f=a("#searchtext");a("#OriginalSearchText").val(f.val())};d.UpdatePageControl=function(g){var f=a("ul.pagination a");a.each(f,function(){var h=a(this).attr("href");h=h.replace(/[\w+|\-]+\?/,g+"?");a(this).attr("href",h)})};d.BindDefaultPreviewTextChangeEvent=function(){var g=a("#DefaultTextIndex");if(g.length>0){var f=FontPreview.GetDefaultPreviewText();if(f!=undefined&&f.length>0&&a('#DefaultTextIndex option[value="'+f+'"]').length==0){b=true;g.append(a('<option value="'+f+'">'+f+"</option>"));g.val(f)}g.selectbox({onChange:function(){var h=this.value;FontPreview.ChangeDefaultText(h);FontPreview.UpdateAllImages(h);FontPreview.UpdateAllText(h);FontPreview.SaveDefaultPreviewText(h)}});if(f!=undefined){g.selectbox("change",f)}}a("#SortColumn").selectbox({onChange:function(){var h=a(this).closest("form"),l=[],k,i,j;a('section[id^="model-section"] div.pairing:hidden').each(function(){l.push('<input type="hidden" name="sectionIds" value="'+a(this).attr("id")+'"/>')});if(l.length>0){h.append(l.join(""))}if(a("#section-rating div.pairing:hidden").length){h.append('<input type="hidden" name="isRatingExpanded" value="false"/>')}d.RemoveDefaultTextIndexField(h);d.SetSortDirectionField(h);h.find("#page").val(1);k=d.buildForm(h);i=h.attr("id");j=i?"#"+i:"";window.location="?"+k.serialize()+j}})};d.BindAddToWebFontProjectEvents=function(f){f.find(".form-add-top-project .upgrade-subscription").click(function(){window.location.href=a(this).data("actionUrl")});f.find(".select-web-font-variation").selectbox({onChange:function(){var j=a(this).find("option:selected"),i=j.data("inProject"),h=a(this).parents("form:first"),g,k;if(i===1){Fonts.Products.updateAddToProjectSubmitButtonToAdded(h)}else{g=Fonts.Products.getCustomerSubscriptionTier();k=parseInt(j.data("tier"),10);if(k>g){Fonts.Products.updateAddToProjectSubmitButtonToUpgrade(h)}else{Fonts.Products.updateAddToProjectSubmitButtonToAdd(h)}}}})};d.SelectWebFontProject=function(i){if(i){try{var h=new UserMessages(jQuery,"messages-choose-web-font-project");if(i.Success){var f=a("#project-choose");f.find(".new-webfontsproject-name").val("");h.clearAll();h.singleSuccess(i.Message);window.location.reload()}else{h.singleError(i.Message)}}catch(g){}}};d.buildForm=function(i,g){Search.UpdateSearchComponentWithSearchFormFields();var p=i.find(".refine-refinements"),f=a("#SearchIn option:selected").data("search-action"),q=!p.is(":visible"),k=i.find(":input[name]").not(":radio:not(:checked)").not('[name^="SearchCriterias"]'),l='<form action="'+f+'" method="get">',j,o,t,h,r,m,n,s;i.attr("action",f);if(q){p.remove()}k.each(function(){j=a(this);o=j.attr("name");t=j.val()||"";l+='<input type="hidden" name="'+o+'" value="'+t+'" />'});p.find("p.refine-refinement:not(.default-refine):visible").each(function(){h=a(this);r=h.find(':input[name$="Criteria"]');m=h.find(':input[name$="Value"]');n=r.val();s=m.val();if(!s){s=""}if((n&&s)||g){l+='<input type="hidden" name="'+n+'" value="'+s+'" />'}});l+="</form>";return a(l)};d.RemoveDefaultTextIndexField=function(f){a("select[name=DefaultTextIndex]",f).attr("name","")};d.SetSortDirectionField=function(f){if(a("select[name=SortColumn]",f).length>0){if(a("select[name=SortColumn]",f).val().indexOf("ascending")>0){a("input[name=SortDirection]",f).val("Ascending")}else{a("input[name=SortDirection]",f).val("Descending")}}};d.SubmitBrowseProductsForm=function(g,f){if(a("input[name=QueryFontType]",f).val()!=g){a("input[name=page]",f).val("1")}a("input[name=QueryFontType]",f).val(g);Search.RemoveDefaultTextIndexField(f);Search.SetSortDirectionField(f);window.location="?"+f.serialize()+"#"+f.attr("id")};d.InitSearchDropdown=function(){a("#SearchIn").selectbox({onChange:function(){a("#search").attr("action",a("#SearchIn option:selected").data("search-action"))}});a("#searchtext, #searchtext1").keyup(function(f){if(f.which==13){f.preventDefault();a("#search").submit();return false}})};d.InitializeOpenTypeFeatureControls=function(){if(a("#publisher-used-font-results").length==1){return}var m=a(".products-sample-images");var l=Fonts.Products!=undefined&&m.length!=0;var g=a("input[name=colorpicker-foreground]").val();var f=a("input[name=colorpicker-background]").val();var k=a("select[name=font-size]").val();var o=FontPreview.GetPreviewImageTextColor();var n=g!=o;if(o!=undefined){a("input[name=colorpicker-foreground]").val(o)}o=FontPreview.GetPreviewImageBackgroundColor();n=n||f!=o;if(o!=undefined){a("input[name=colorpicker-background]").val(o)}o=FontPreview.GetPreviewImageFontSize();n=n||k!=o;if(o!=undefined){a("select[name=font-size]").val(o)}var i=[];a(".search-featuredicons li.feature-active a").each(function(q,p){i.push(a(p).data("ot-feature"))});a(".search-featuredicons li").removeClass("feature-active");o=FontPreview.GetPreviewImageOtFeatures();if(o){var j=o.split(",");if(i.length==j.length){var h=a.grep(i,function(p){return a.inArray(p,j)<0});if(h.length>0){n=true}}else{n=true}a.each(j,function(q,p){a(".search-featuredicons a[data-ot-feature="+p+"]").parent().addClass("feature-active")})}else{if(i.length>0){n=true}}FontPreview.attachColorPicker("foreground");FontPreview.attachColorPicker("background");FontPreview.attachColorPickerCloseListener();a(".search-featurestab .trigger").click(function(){var p="active-trigger",q=a(".search-featuredicons"),s=a(this);s.toggleClass(p);if(s.hasClass(p)){q.show();var r=a("#search-resize");if(r.length==1){q.css("width",(r.outerWidth(true)+parseInt(a(".search-featuredicons").css("left")))+"px")}}else{q.hide()}});a(document).on("click",".search-featuredicons li a",function(){a(this).parent().toggleClass("feature-active");a(this).next(".popup").fadeOut("fast");e(l,m)});a(".search-textcolor input, .search-bgcolor input, .search-fontsize select").bind("change",function(p){e(l,m);p.preventDefault()});if(n||b){e(l,m)}if(l){Fonts.Products.AttachFontFeaturesRollovers()}else{Search.AttachFontFeaturesRollovers()}};function e(f,g){if(f){Fonts.Products.updateSampleImage(null,g)}else{var h=FontPreview.GetDefaultPreviewText();if(h==undefined||h=="undefined"){h=a("#DefaultTextIndex").val();if(h==undefined){h=a("#DefaultTextIndex option:first").val()}}FontPreview.UpdateAllImages(b?h:undefined);if(b){b=false}}}d.AttachFontFeaturesRollovers=function(){a(".font-features-section li a").mouseenter(function(){if(!c){c=true;a.post(Fonts.Urls.frsSupportedOpenTypeFeaturesRolloversUrl(),function(f){a(".feat-ot-list").replaceWith(a(f).find(".feat-ot-list"));BindTextPopperHover(a(".textpopper",".feat-ot-list"));c=false})}})};d.AttachSubscriptionMessage=function(){var f=a("#subscription-message-not-signed-in-close"),g=a("#subscription-message-not-signed-in");if(f.length>0&&g.length>0){f.bind("click",function(){g.fadeOut();a.cookie("subscription-message-closed",1,{domain:location.hostname})});g.fadeIn()}};return d}(jQuery));$(function(){Search.BindDefaultPreviewTextChangeEvent();Search.InitSearchDropdown();Search.AttachSubscriptionMessage()});Fonts.Refinements=(function(a){var d={},b=function(g){g.selectbox({onChange:function(j,i){var h=i.input.closest("p.refine-refinement").find("a.refine-add");if(j===""){h.hide()}else{h.show()}}})},f=function(j){var i=a("#facets-container p.refine-refinement"),h=a("#facets-container"),g=a("#default-add-filter");if(i.length){if(j){g.hide();h.fadeIn()}else{h.fadeOut(function(){g.show()})}}else{h.html("")}},e=function(g){g.closest(".sort-content").removeClass("refine-closed")},c=function(g){g.closest(".sort-content").addClass("refine-closed")};d.UpdateRefinements=function(l,m){var h=a("#default-add-filter"),i=a("#facets-container"),k=a("#refinement-searchtext"),g=a('input[name="ShowAllFonts"]'),j=a('input[name="ShowAllFonts"]:checked').attr("id");Search.FacetToBucketMap=l.FacetToBucketMap||{};if(l.NoRefinementsFound){if(m){i.html(l.MessageHtml)}else{i.html("")}h.show()}else{h.hide();i.html(l.RefinementsHtml);d.BindRefinementsEvents(i)}i.show();k.attr("data-value",k.val());g.attr("data-last-checked-id",j);a("form.refinements").hideLoading()};d.getRefinements=function(g,i,h){g.showLoading();a.ajax({type:"POST",url:i,dataType:"json",success:function(j){d.UpdateRefinements(j,h)},error:function(){g.hideLoading()}})};d.UpdateValueSelect=function(l,i){var h=Search.FacetToBucketMap[i],j=[],k,g;if(h){g=h.length;for(k=0;k<g;k++){if(h[k].Value===""){j.push('<option value="'+h[k].Value+'"selected="selected">'+h[k].Text+"</option>")}else{j.push('<option value="'+h[k].Value+'">'+h[k].Text+"</option>")}}}l.selectbox("detach").html(j.join(""));b(l);return h.join("")};d.BindRefinementsEvents=function(h){var g=h.find("p.refine-refinement:last");if(!g.find('select[name="SearchCriterias.Value"]').val()){g.find("a.refine-add").hide()}h.find("a.remove").off("click").on("click",function(){var k=a(this),l=k.closest("p.refine-refinement"),m=l.find("span.refine-key").find("select").val(),n=l.find("span.refine-value").find("select").val(),i=k.closest("form"),j=i.find("#facets-container p.refine-refinement").length===1,o=Search.buildForm(i,true),p;o.find('input[name="'+m+'"][value="'+n+'"]').remove();p=Fonts.Urls.getRemoveRefinementsUrl()+"?"+o.serialize()+"&add=false";d.getRefinements(i,p,!j)});h.find("a.refine-add").off("click").on("click",function(){var j=a(this),i=j.closest("form"),k=Search.buildForm(i,true),l=Fonts.Urls.getAddRefinementsUrl()+"?"+k.serialize()+"&add=true";d.getRefinements(i,l,true)});h.find('select[name="SearchCriterias.Criteria"]:last').selectbox({onChange:function(k,i){var j=i.input.closest("p.refine-refinement"),l=j.find("span.refine-value").find("select");j.find("a.refine-add").hide();d.UpdateValueSelect(l,k)}});b(h.find('select[name="SearchCriterias.Value"]:last'));h.find("select").selectbox()};d.InitializeRefinementsForm=function(){var g=a("form.per-page, form.refinements");g.off("submit").submit(function(h){h.preventDefault();h.stopImmediatePropagation();var i=Search.buildForm(a(this));i.appendTo("body").submit()});g.find("input.input-reset").on("click",function(){g.find("#refinement-searchtext").focus();g.find("#facets-container").html("");g.find("#refinements-messsages").remove();g.find("#default-add-filter").show()});a(".refine-toggle").click(function(){var h=a(this),i=h.closest(".filters");if(i.hasClass("refine-closed")){e(h)}else{c(h)}});d.BindRefinementsEvents(a("#refine-refinements-list"));g.find('input[name="ShowAllFonts"]').change(function(){var h=a(this),i=a("#refinement-searchtext");f(h.attr("data-last-checked-id")===h.attr("id")&&i.attr("data-value")===i.val())});g.find("#refinement-searchtext").keyup(function(){var h=a(this),i=a('input[name="ShowAllFonts"]:checked');f(i.attr("data-last-checked-id")===i.attr("id")&&h.attr("data-value")===h.val())});if(a("#facets-container p").length){a("#default-add-filter").hide()}else{a("#default-add-filter").show()}g.show()};a(function(){Fonts.Refinements.InitializeRefinementsForm()});return d}(jQuery));Fonts.Translations=(function(a){var b={},c={};b.getErrorMessage=function(){return c.errorMessage};b.setErrorMessage=function(d){c.errorMessage=d;return this};b.getSuccessMessage=function(){return c.successMessage};b.setSuccessMessage=function(d){c.successMessage=d;return this};b.getShowLabel=function(){return c.showLabel};b.setShowLabel=function(d){c.showLabel=d;return this};b.getHideLabel=function(){return c.hideLabel};b.setHideLabel=function(d){c.hideLabel=d;return this};b.getMustReadAndAcceptLicenseDocumentsAndTob=function(){return c.mustReadAndAcceptLicenseDocumentsAndTob};b.youMustReadAndAcceptLicenseDocumentsAndTob=function(d){c.mustReadAndAcceptLicenseDocumentsAndTob=d;return this};b.pleaseWaitButton=function(){return c.pleaseWaitButton};b.setPleaseWaitButton=function(d){c.pleaseWaitButton=d;return this};b.setCloseLabel=function(d){c.closeLabel=d;return this};b.getCloseLabel=function(){return c.closeLabel};b.setOpenLabel=function(d){c.openLabel=d;return this};b.getOpenLabel=function(){return c.openLabel};b.setGoogleWebFontsAddSuccessMessage=function(d){c.googleWebFontsAddSuccessMessage=d;return this};b.getGoogleWebFontsAddSuccessMessage=function(){return c.googleWebFontsAddSuccessMessage};b.setGoogleWebFontsEnableProviderMessage=function(d){c.googleWebFontsEnableProviderMessage=d;return this};b.getGoogleWebFontsEnableProviderMessage=function(){return c.googleWebFontsEnableProviderMessage};b.setGoogleWebFontsAlreadyAddedMessage=function(d){c.googleWebFontsAlreadyAddedMessage=d;return this};b.getGoogleWebFontsAlreadyAddedMessage=function(){return c.googleWebFontsAlreadyAddedMessage};b.setImportantMessageTitle=function(d){c.importantMessageTitle=d;return this};b.getImportantMessageTitle=function(){return c.importantMessageTitle};b.setAfterSuccessfullyDowngradedToFreeMessage=function(d){c.afterSuccessfullyDowngradedToFreeMessage=d;return this};b.getAfterSuccessfullyDowngradedToFreeMessage=function(){return c.afterSuccessfullyDowngradedToFreeMessage};b.setSignInToSkyFontsClientMessage=function(d){c.signInToSkyFontsClientMessage=d;return this};b.getSignInToSkyFontsClientMessage=function(){return c.signInToSkyFontsClientMessage};return b}(jQuery));Fonts.Urls=(function(a){var b={};return{bindUrls:function(c){b=c},changeHeroImage:function(){return b.changeHeroImageTemplateAddress},applyCartCoupon:function(){return b.applyCartCouponAddressTemplate},getBillingStatesListAddress:function(){return b.getBillingStatesListAddressTemplate},getAccountStatesListAddress:function(){return b.getAccountStatesListAddressTemplate},getChangePaymentPlan:function(){return b.getChangePaymentPlanTemplate},getChangePaymentFrequency:function(){return b.getChangePaymentFrequencyTemplate},getProductPopup:function(){return b.getProductPopupTemplate},getRolloverPopup:function(){return b.getRolloverPopupTemplate},searchFamilyProductsAddress:function(){return b.searchFamilyProductsAddress},getWishListProductsAddress:function(){return b.getWishListProductsAddress},getOrdersAndDownloads:function(){return b.ordersAndDownloads},getCancelSubscriptionUrl:function(){return b.getCancelSubscriptionTemplate},getGenerateAuthorizationToken:function(){return b.getGenerateAuthorizationTokenTemplate},getSaveAuthorizationToken:function(){return b.getSaveAuthorizationTokenTemplate},getPurchaseSubscriptionStatesListAddress:function(){return b.getPurchaseSubscriptionStatesListAddressTemplate},getCalculateTaxVatOptional:function(){return b.getCalculateTaxVatOptionalTemplate},getApplyPromotionCodeToCart:function(){return b.getApplyPromotionCodeToCartTempale},familyProductsAddress:function(){return b.familyProductsAddress},getCartFloatingNavigation:function(){return b.getCartFloatingNavigation},getUpdateCartLicenseQuantityAddress:function(){return b.updateCartLicenseQuantity},getUpdateProjectAddress:function(){return b.updateProjectAddress},getDeleteProjectAddess:function(){return b.deleteProjectAddess},getCartPageSummary:function(){return b.getCartPageSummary},getCartItemsDetails:function(){return b.getCartItemsDetails},getCartItemsDetailsReadonly:function(){return b.getCartItemsDetailsReadonly},deleteCartItem:function(){return b.deleteCartItem},getCancelCheck:function(){return b.cancelCheck},getLoginUrl:function(){return b.loginUrl},getClientAliasLabel:function(){return b.clientAliasLabelTemplate},getUpdateCartItemFeature:function(){return b.updateCartItemFeature},getUpdateCartItemFormat:function(){return b.updateCartItemFormat},getCartPaymentInformationSection:function(){return b.cartPaymentInformationSection},getCartPageUrl:function(){return b.cartPageUrl},getCartVatCalculationUrl:function(){return b.cartVatCalculationUrl},addSpecimenImage:function(){return b.addSpecimenImage},getAddRefinementsUrl:function(){return b.addRefinementsUrl},getRemoveRefinementsUrl:function(){return b.removeRefinementsUrl},fontFeaturesRolloversUrl:function(){return b.fontFeaturesRolloversUrl},getAccountInformationForm:function(){return b.accountInformationForm},getAuthenticationKeyForm:function(){return b.authenticationKeyForm},getUpdatePaymentInformationForm:function(){return b.updatePaymentInformationForm},addSpecimenImageThumb:function(){return b.addSpecimenImageThumb},getSubscriptionPlanDialog:function(){return b.getSubscriptionPlanDialog},frsSupportedOpenTypeFeaturesRolloversUrl:function(){return b.frsSupportedOpenTypeFeaturesRolloversUrl},searchAutoCompleteUrl:function(){return b.searchAutoCompleteUrl},googleWebFontsDialogUrl:function(){return b.googleWebFontsDialogUrl},downloadSkyFontsClientModalUrl:function(){return b.downloadSkyFontsClientModalUrl},activeAndExpiredFontsUrl:function(){return b.activeAndExpiredFontsUrl},activeFontsUrl:function(){return b.activeFontsUrl},expiredFontsUrl:function(){return b.expiredFontsUrl},allActiveSkyfontsCountUrl:function(){return b.allActiveSkyfontsCountUrl},getRemainingCredits:function(){return b.remainingCreditsUrl}}}(jQuery));Fonts.WebFontManager=(function(){var b={};function e(g){this.iteration=0;this.intervals=[100,200,300,500,800,1300,2100];this.limit=this.intervals.length;this.success=false;this.busy=false;this.mainAction=typeof g.mainAction==="function"?g.mainAction:function(){return true};this.endAction=typeof g.endAction==="function"?g.endAction:function(){};this.onEndCallback=typeof g.onEndCallback==="function"?g.onEndCallback:function(){};this.work=function(){var h=this;if(!h.busy){h.busy=true;h.iteration+=1;h.success=h.mainAction();h.busy=false;if(!h.success&&h.iteration<h.limit){h.processor=setTimeout(function(){h.work.call(h)},h.intervals[h.iteration])}if(!h.success&&h.iteration===h.limit){h.endAction()}if(h.success||h.iteration===h.limit){h.onEndCallback()}}};this.start=function(){var h=this;h.processor=setTimeout(function(){h.work.call(h)},h.intervals[h.iteration])};return this}function f(g){this.workers=[];this.activeWorkers=this.workers.length;this.allDone=typeof g.allDone==="function"?g.allDone:function(){};this.addWorker=function(i){var h=this;i.onEndCallback=function(){h.activeWorkers-=1;if(h.activeWorkers===0){h.allDone()}};h.workers.push(new e(i));h.activeWorkers+=1};this.start=function(){for(var h=0;h<this.activeWorkers;h++){this.workers[h].start()}}}function d(g,h){var i=!(g===h.width());if(i){$('[data-font-family="'+h.attr("data-font-family")+'"]').css("visibility","")}return i}function c(g){$('[data-font-family="'+g.attr("data-font-family")+'"]').css("visibility","")}b.StartWebFontsListener=function(g){var i=g instanceof jQuery?g.find("#font-families-to-load-container"):$("#font-families-to-load-container");if(i.length==0&&g!=undefined){i=g.filter("#font-families-to-load-container")}var j=i.find("span.default").width(),h=i.find("span:not(.default)"),k=new f({allDone:function(){i.remove()}});if(h.length){h.each(function(){(function(l){k.addWorker({mainAction:function(){return d(j,l)},endAction:function(){c(l)}})}($(this)))})}else{if(g instanceof jQuery){g.find("[data-font-family]").css("visibility","")}else{$("[data-font-family]").css("visibility","")}}k.start()};b.StartFullWebFontListener=function(){var i=$(".webfont-fullfont-loading");var j=$(".webfont-fullfont-loaded");var g=$(".webfont-fullfont-load-test");if(i.length>0&&g.length>0){if(a(g)){i.hide();j.show()}else{var h=setInterval(function(){if(a(g)){clearInterval(h);i.hide();j.show();return}},500)}}};function a(g){var j=$(g[0]).width();for(var h=1;h<g.length;h++){if(j!=$(g[h]).width()){return false}}return true}return b}(jQuery));$(function(){Fonts.WebFontManager.StartWebFontsListener();Fonts.WebFontManager.StartFullWebFontListener()});Fonts.UI=(function(a){var e={};e.ShowAndRemove=function(i){var j=a(i.container),k=i.removeAfter||3000,f="TempIntervalId",h=j.data(f),g=function(){if(k>0){clearInterval(h);h=setTimeout(function(){j.children().fadeOut(function(){j.empty();if(typeof i.callback==="function"){i.callback()}})},k)}j.data(f,h)};j.hide().html(i.data).fadeIn(g)};var d=function(){a(".pricing .sbSelector, .offer-field .sbSelector").each(function(){var f=a(this).text();a(this).html(f.replace(/^(.*?)(\s*-\s*)([^\d]*)(((\d*,)*\d*\.)|((\d*\.)*\d*,))(\d*)(\s)(.*)$/,'<span class="format">$1</span><span class="symbol">$3</span><span class="price">$4</span><span class="decimals">$9</span><span class="price-currency">$11</span>'))})};e.bindStylePrice=function(){d();a("aside.pricing select, aside.offer-field select").unbind("change").bind("change").change(function(){d()})};e.Alert=function(h){try{var f=a(".alert-modal");if(f.length===0){f=a(a("#fonts-modal-alert").html());f.lightbox_me({destroyOnClose:true})}var i=new UserMessages(jQuery,"fonts-alert-messages");f.find("#alert-title").html(h);return i}catch(g){return Fonts.Messages}};e.SubmitJsonpForm=function(h,m,j,l,k){var n=c(j);if(n!==false){var o=h.attr("action");if(o.indexOf("?")===-1){o=o+"?jsoncallback=?"}else{o=o+"&jsoncallback=?"}var i=h.serializeArray();var f=[];a.each(i,function(){if(a.inArray(this.name,f)===-1){f.push(this.name);a.cookie("__jsonpform_"+this.name,this.value,{secure:true,path:"/"})}});try{a.getJSON(o,function(p){c(m,p)}).error(function(){c(l,null)}).complete(function(){b(f);c(k,null)})}catch(g){if(f){b(f);c(l,null)}}}else{c(k,null)}};e.isRequiredFieldEmpty=function(f,g,h){var i=a(g);a(f).removeClass("input-validation-error");if(a(f).val().length==0){a(f).addClass("input-validation-error");a(f).focus();a(h).css("display","block");return false}else{i.showLoading();a(h).css("display","none");return true}};e.BindJsonpFormSubmitEvents=function(f){if(typeof f=="undefined"){f=a("html")}a(".jsonp-form",f).each(function(){a(this).submit(function(i){try{i.preventDefault();var g=a(this);if(!g.valid||!!g.valid&&g.valid()){var m=g.attr("data-jsonp-onSuccess");var j=g.attr("data-jsonp-onBegin");var l=g.attr("data-jsonp-onError");var k=g.attr("data-jsonp-onComplete");e.SubmitJsonpForm(g,m,j,l,k)}}catch(h){}return false})})};a(function(){e.BindJsonpFormSubmitEvents()});function c(g,j){try{if(typeof g!=="undefined"){if(a.isFunction(g)){if(j!==null){return g(j)}else{return g()}}else{if(typeof g==="string"){var i=new Function(g);if(j!==null){return i.call(j,j)}else{return i()}}}}}catch(h){return false}}function b(g){try{a.each(g,function(){a.cookie("__jsonpform_"+this,null)})}catch(f){}}e.accordBarExpandCollapseHandling=function(h,g){var f=a(h);f.toggleClass("collapse");f.next(".pairing").slideToggle("fast",typeof g==="function"?g:function(){});f.find("span").html(f.hasClass("collapse")?Fonts.Translations.getOpenLabel():Fonts.Translations.getCloseLabel())};e.tabSortSwitcher=function(f){if(f&&f.length!==0){f.click(function(h){var i=a(this).parents("ul").parent();a("ul.tabs li, ul.sort li",i).removeClass("active");a(this).addClass("active");a(".tab-content, .sort-content",i).hide();var g=Fonts.makeSelectorWithHashIESafe(a(this).find("a").attr("href"));a(g).show();h.preventDefault()})}};e.wishListDropDowns=function(f){var g="select.wish-list-drop-down-list",h=f instanceof jQuery?f.find(g):a(g);h.selectbox({onChange:function(j,i){i.input.trigger("change");e.SetGoToWishListLink(j,i.input.closest("div.dropdown"))}})};e.productVariationSelects=function(f){var g='select[name="VariationId"]:not(#product-variation-select, #webfont-variation-select)',h=f instanceof jQuery?f.find(g):a(g);h.selectbox({onChange:function(n,k){k.input.trigger("change");var m=k.input.closest("div.select-wrap"),i,j,l;m.find("div.product-variation-customer-currency span:visible").css("display","none");m.find("#pv_"+n).css("display","block");m.find("div.original-prices span:visible").first().css("display","none");m.find("#op_"+n).css("display","block");l=k.input.attr("id");if(l&&l.lastIndexOf("variation-select")!=-1){i=a("#feature-upgrade");j=i.attr("href");if(j){i.attr("href",j.replace(/selectedProductVariationId=\d+/g,"selectedProductVariationId="+n))}}}})};e.asideProductVariationSelects=function(f){a(f).selectbox({onChange:function(i,g){g.input.trigger("change");var h=g.input.closest("div.select-wrap");h.find("div.product-variation-customer-currency span:visible").css("display","none");h.find("#pv_"+i).css("display","block");window.location.href=window.location.pathname+"?var="+i}})};e.SetGoToWishListLink=function(j,f){var i="a.go-to-wish-list",g=f instanceof jQuery?f.find(i):a(i),h=g.attr("href");if(h){h=h.substring(0,h.lastIndexOf("/")+1)+j;g.attr("href",h)}};e.updateWishListDropDowns=function(f){a("select.wish-list-drop-down-list").selectbox("detach").replaceWith(f.WishListSelectHtml);Fonts.UI.wishListDropDowns();Fonts.UI.SetGoToWishListLink(f.WishListId);a("div.add-to-wish-list-content:hidden").show();a("p.go-to-wish-list-container:hidden").show()};e.updateWebFontProjectDropDowns=function(f){if(f.WebFontsProjectsHtml){a("input.new-webfontsproject-name").hide().val("");a('select[name="ProjectId"]').selectbox("detach").replaceWith(f.WebFontsProjectsHtml);Fonts.UI.AttachAddToWebFontDropDownsEvents()}};e.ToggleNewProjectNameField=function(g){if(g instanceof jQuery){var f=g.find("input[name=ProjectName]");if(f.length>0){var h=g.find("select[name=ProjectId]").val();if(h===""){f.show()}else{f.hide()}}}};e.AttachAddToWebFontDropDownsEvents=function(f){var g='select[name="ProjectId"]',h=f instanceof jQuery?f.find(g):a(g);h.selectbox({onChange:function(j,i){e.ToggleNewProjectNameField(i.input.closest("form"))}})};e.showAsideSpinner=function(){var g=a("#product-page-cart"),f=a("#product-page-basket");if(g.length){g.showLoading()}else{if(f.length){f.showLoading()}}};e.hideAsideSpinner=function(){var g=a("#product-page-cart"),f=a("#product-page-basket");if(g.length){g.hideLoading()}else{if(f.length){f.hideLoading()}}};return e}(jQuery));(function(a){function b(d){try{if(a.isFunction(d)){return d()}}catch(c){}return d}Fonts.UI.Confirm=function(l,g,e,c,i,h,j){var k=true;if(typeof j!=="undefined"){try{if(a.isFunction(j)){k=j()}else{if(typeof j==="string"){k=(new Function(j))()}}}catch(f){k=false}}if(k){var d=a(a("#fonts-modal-confirmation").html());d.find("#confirm-title").html(b(l));d.find("#confirm-message").html(b(g));d.find(".input-submit-remove").val(b(e));d.find(".close-popup").text(b(c));d.lightbox_me({destroyOnClose:true,showOverlay:true,allowEmptyOverlay:false,zIndex:9900,onLoad:function(){if(typeof i!=="undefined"){d.find(".input-submit-remove").click(function(){try{if(a.isFunction(i)){i()}else{if(typeof i==="string"){new Function(i)()}}}finally{d.trigger("close")}})}d.find(".close-popup").click(function(){d.trigger("close")})},onClose:function(){if(typeof h!=="undefined"){if(a.isFunction(i)){h()}else{if(typeof i==="string"){new Function(h)()}}}}})}};Fonts.UI.accordBarNavigateHandling=function(i,g){var d=a(i).parents(".accord-group");var c;if(d.next(".accord-group-container").size()){var f=d.next(".accord-group-container");var e=f.find(".accord-group:first");if(!e){return true}Fonts.UI.accordBarExpandCollapseHandling(d.find(".accord-bar"),g);c=a(i).hasClass("back")?d.prev():e}else{if(!d.next(".accord-group").size()){return true}Fonts.UI.accordBarExpandCollapseHandling(d.find(".accord-bar"),g);if(a(i).hasClass("back")&&!d.prev().size()&&d.parents(".accord-group-container").size()){c=d.parents(".accord-group-container").prev()}else{c=d.next()}}if(c.find(".pairing:hidden").size()){var h=c.find(".accord-bar");if(h){Fonts.UI.accordBarExpandCollapseHandling(h,g)}}};a(function(){a(document).on("click","a[data-confirm=modal],input[data-confirm=modal]",function(){var c=a(this);Fonts.UI.Confirm(c.data("title"),c.data("message"),c.data("confirmText"),c.data("cancelText"),c.data("onConfirm"),c.data("onCancel"),c.data("onOpen"))})})}(jQuery));Fonts.Account=(function(a){var b={};var d,h;b.OnCreateAccountStart=function(k){var j=a("#"+k);var i=a("#IsEulaAccepted",j);if(i.length>0){if(!b.CheckEulaCheckbox(i,k)){return false}}j.find(".input-submit[type=submit]").hide();j.find(".input-submit.wait").show();j.showLoading()};b.OnCreateAccountEnd=function(j){var i=a("#"+j);i.find(".input-submit[type=submit]").show();i.find(".input-submit.wait").hide();i.hideLoading()};b.OnCreateAccountSuccess=function(i){if(i.Success){if(i.ReturnUrl){window.location.href=i.ReturnUrl}else{window.location.reload()}}else{if(typeof i.Message!=="undefined"){var j=a("#"+i.FormId);j.find(".messages-container").html(i.Message)}}};b.OnMemberSignInStart=function(k){var j=a("#"+k);var i=a("#IsEulaAccepted",j);if(i.length>0){if(!b.CheckEulaCheckbox(i,k)){return false}}j.find(".input-submit[type=submit]").hide();j.find(".input-submit.wait").show();j.showLoading()};b.CheckEulaCheckbox=function(i,j){if(!i.attr("checked")){var k=new UserMessages(a,j+" .messages-container");k.clearErrors();k.addError(Fonts.Translations.getMustReadAndAcceptLicenseDocumentsAndTob());return false}else{return true}};b.OnMemberSignInEnd=function(j){var i=a("#"+j);i.find(".input-submit[type=submit]").show();i.find(".input-submit.wait").hide();i.hideLoading()};b.OnMemberSignInSuccess=function(i){var j=a("#"+i.FormId);if(i.Success){j.find("a.close").trigger("click");var k=j.parents("li");if(k.length){k.showLoading()}if(i.ReturnUrl){window.location.href=i.ReturnUrl}else{window.location.reload()}}else{if(typeof i.Message!=="undefined"){j.find(".messages-container").html(i.Message)}}};b.OnSuccessCallLogout=function(){document.location=document.URL};b.AttachEventsToNeedSupportForm=function(){a("#member-signin-link-trigger").click(function(i){a("#member-signin-link").trigger("click");i.stopPropagation()});a("#member-signin-link-trigger b").click(function(i){i.preventDefault()});a("#become-member-link-trigger").click(function(i){a("#become-member-link").trigger("click");i.stopPropagation()});a("#become-member-link-trigger b").click(function(i){i.preventDefault()})};function e(){a(".signin-section").show();a(".reset-password-section").hide();a(".signin-part").show();a(".reset-password-part").hide();a(".reset-password-block p.submit").hide();a(".modal .member-forms").hide();a(".modal .signin-form").show()}function f(){a(".reset-password-block p.submit").show();a(".signin-section").hide();a(".reset-password-section").show();a(".signin-part").hide();a(".reset-password-part").show();a(".reset-password-block").show();a(".modal .signin-form").hide()}b.AttachEventsToMemberSignin=function(){b.AttachEventsToMemberSigninForSelector(a(".password-reset-link-trigger"))};b.AttachEventsToMemberSigninForSelector=function(i){if(i){i.click(function(j){f();j.preventDefault()})}};b.AttachEventsToSigninFormsTriggers=function(){a(".member-sections-trigger, .member-forms-trigger").click(function(){if(a(".member-section").length>0||a(".member-form").length>0){a(this).parent().showLoading();a.post(SiteUrls.customerMemberForms(),{returnUrl:window.location.href,triggerId:a(this).attr("id")},function(j){var m=a(j.Forms);for(var k=0;k<m.length;k++){var l=a(m[k]);switch(l.attr("id")){case"member-signin-section":b.AddDownloadedSections(a(".account-wrap .member-signin-section-wrapper"),l);break;case"become-member-section":b.AddDownloadedSections(a(".account-wrap .become-member-section-wrapper"),l);break;case"member-signin":b.AddDownloadedForms(a(".member-signin-form-container"),l);break;case"reset-password":b.AddDownloadedForms(a(".reset-password-form-container"),l);break}}if(typeof j.TriggerId!=="undefined"){a(".hovered",a("#"+j.TriggerId).parent()).css("display","block")}a(".member-signin-section-wrapper").css("display","block");a(".member-forms").css("display","block")})}else{a(".member-signin-section-wrapper").css("display","block");a(".member-forms").css("display","block")}})};b.AttachEventsToNeedSupportSectionsTriggers=function(){a(".need-support-sections-trigger").click(function(){if(a(".member-section-need-support").length>0){a(this).parent().showLoading();a.post(SiteUrls.customerNeedSupportSection(),{triggerId:a(this).attr("id")},function(i){var j=a(i.Forms).filter("#need-support-section");if(j.length==1){b.AddDownloadedSections(a(".account-wrap .need-support-section-wrapper"),j)}j=a(i.Forms).filter("#support-problem-types");if(j.length==1){b.attachEventsToSupportProblemControls(j)}b.AttachEventsToNeedSupportForm();if(typeof i.TriggerId!=="undefined"){a(".hovered",a("#"+i.TriggerId).parent()).css("display","block")}})}})};b.attachEventsToSupportProblemControls=function(i){d=i.find("#desktopfonts-problems");h=i.find("#webfonts-problems");var k=a("#need-support-problem");var j=a("#support-problem-faq-link");var l=a("#support-problem-type-note");a("#need-support-subject").change(function(){var m=this.selectedIndex;var n=a("#support-problem-type");if(m==0){n.hide()}else{if(m==1){n.show();k.html(d.html());k.change()}else{if(m==2){n.show();k.html(h.html());k.change()}}}});k.change(function(){var m=k.find(":selected");if(!m.val()){l.hide()}else{l.show();j.html(m.data("faq-name"));j.attr("href",m.data("faq-url"))}})};b.AttachEventsToCartTotalSectionsTriggers=function(){a(".cart-total-sections-trigger").click(function(i){if(a(".member-section-cart-total").length>0){a(this).parent().showLoading();a.post(SiteUrls.cartTotalSection(),{triggerId:a(this).attr("id")},function(j){var m=a(j.Forms);for(var k=0;k<m.length;k++){var l=a(m[k]);switch(l.attr("id")){case"cart-total-section":b.AddDownloadedSections(a(".account-wrap .cart-total-section-wrapper"),l);break}}if(typeof j.TriggerId!=="undefined"){a(".hovered",a("#"+j.TriggerId).parent()).css("display","block")}})}i.stopPropagation()})};b.AttachEventsToMiniCartSectionsTriggers=function(){a(".mini-cart-sections-trigger").click(function(i){if(a(".member-section-mini-cart").length>0){a(this).parent().showLoading();a.post(SiteUrls.miniCartSection(),{triggerId:a(this).attr("id")},function(j){var m=a(j.Forms);for(var k=0;k<m.length;k++){var l=a(m[k]);switch(l.attr("id")){case"mini-cart-section":b.AddDownloadedSections(a(".account-wrap .mini-cart-section-wrapper"),l);break}}Fonts.CartSummary.BindAllCartNavigationBlockEvents();if(typeof j.TriggerId!=="undefined"){a(".hovered",a("#"+j.TriggerId).parent()).css("display","block")}})}i.stopPropagation()})};b.AddDownloadedForms=function(i,j){i.each(function(){var k=a(this);b.AddFormToContainer(k,j);k.parent().hideLoading();k.removeMatchedClasses(/^/);a(".close",k).click(function(l){a("select[sb]").selectbox("close");a(this).closest(".hovered").fadeOut("fast");a(this).parentsUntil(".account-nav").removeClass("active");a(this).closest(".dropdown").fadeOut("fast");a(this).parents(".with-dropdown").removeClass("active");a(this).parentsUntil(".with-dropdown").removeClass("active");l.preventDefault()})})};b.AddDownloadedSections=function(i,j){i.each(function(){var k=a(this);b.AddFormToContainer(k,j);k.hideLoading();k.removeMatchedClasses(/^member-section/);k.css("display","block");a(".close",k).click(function(m){a("select[sb]").selectbox("close");a(this).closest(".hovered").fadeOut("fast");a(this).parentsUntil(".account-nav").removeClass("active");m.preventDefault()});var l=a(".account-nav .reset-password-section a.close");if(l.length==1){l.off("click");l.click(function(){Fonts.Account.RestoreMemberSigninForm()})}})};b.AddFormToContainer=function(i,j){var n=a("input[name=UniqueFormId]",j).val();var o=a("input[name=UniqueLabelsId]",j).val();var k=Common.guid();var m=Common.guid();var l=j.html();if(typeof n!=="undefined"){l=Common.replaceAll(l,n,k)}if(typeof o!=="undefined"){l=Common.replaceAll(l,o,m)}i.html(l);b.AttachEventsToMemberSigninForSelector(a(".password-reset-link-trigger",i));Fonts.UI.BindJsonpFormSubmitEvents(i);jQuery.validator.unobtrusive.parse(i)};b.RestoreMemberSigninForm=function(){e();a(".reset-password-messages").hide();a(".reset-password-block").hide();a(".reset-password-part").hide();c('.signin-form a[name="returnUrl"]');c('.signin-part a[name="returnUrl"]')};function c(l){var i=a(l);var j=i.attr("href");if(j!=undefined){var k=j.split("returnUrl=");if(k.length==2){i.attr("href",k[0]+"returnUrl="+encodeURIComponent(window.location))}}}b.RestoreNeedSupportForm=function(){a(".success-need-support-request").hide()};b.OnSuccessCallResetPassword=function(k,n){var s;var o;var p;var r;var j=a(".reset-password-block .password-reset-form:visible");var m=[];for(var q=0;q<j.length;q++){var l=a(j[q]);if(l.attr("id")==n){m=l.closest("li");if(m.length==0){m=l.closest("#login")}break}}if(a(".reset-password-block:visible").size()>0&&m.length>0){r=m.find(".reset-password-messages");o=m.find(".signin-section");p=m.find(".reset-password-section");s={container:r,data:k.Message,callback:function(){o.fadeIn();p.hide()}}}else{r=".dropdown:visible .reset-password-messages";s={container:r,data:k.Message,callback:function(){a(r).hide();a(".dropdown:visible .reset-password-part").hide();a(".dropdown:visible .signin-part").fadeIn();a(".dropdown:visible .password-reset-form").show()}};p=a(".dropdown:visible .password-reset-form")}if(k.Success){p.fadeOut(function(){Fonts.UI.ShowAndRemove(s)})}else{s={container:r,data:k.Message,removeAfter:-1};Fonts.UI.ShowAndRemove(s)}};b.HandleSigninAfterLoad=function(){if(g){a("#member-signin-link").click()}};var g=false;b.ShowSigninPopupAfterLoad=function(){g=true};b.OnSuccessCallNeedSupport=function(i){};b.trackPositionVertical=function(j){j=j.toLowerCase();var i={};if(j=="top"){i[j]=24}else{if(j=="middle"){i.top=145}else{i.top=272}}a("#sample_banner").css(i)};b.trackPositionHorizontal=function(j){j=j.toLowerCase();var i={};if(j=="left"){i.left=3}else{if(j=="center"){i.left=138}else{i.left=278}}a("#sample_banner").css(i)};b.AttachWishlistOptionDropDown=function(){a('input[class="wishListOptionSelection"]').change(function(){if(this.value){var j=a(this).attr("id").substring(a(this).attr("id").lastIndexOf("-")+1);if(j){var i="#account-wishlist-"+j+"-container";switch(this.value){case"delete":a(i+" .delete-wishlist").show();a(i+" .send-wishlist-email").hide();break;case"send-email":a(i+" .delete-wishlist").hide();a(i+" .send-wishlist-email").show();break}}}})};b.OnSuccessEmailWishList=function(k,j){var i=a(".send-email-container",k);if(j.Success==true){Fonts.UI.ShowAndRemove({container:i,data:j.Message});a(".send-email-address",k).val("")}else{a(i).html(j.Message)}};return b}(jQuery));(function(a){a.fn.removeMatchedClasses=function(c){return this.each(function(g){var h=a(this);var d=h.attr("class").split(/\s+/);for(var j=0;j<d.length;j++){var f=d[j];if(f.match(c)){h.removeClass(f)}}})};var b=a("#support-problem-types");if(b.length==1){Fonts.Account.attachEventsToSupportProblemControls(b)}})(jQuery);var Cart=(function(a){var k={};var p={};var l=false;k.LicensesAndTermsMessage=function(s){p.LicensesMessage=s};function q(){var w=new UserMessages(jQuery,"cart-billing-user-messages");w.clearAll();var t=a("input[data-val], select[data-val]","#billing-information-section").valid();var s=a("#agreement-to-license");s.removeClass("necessary-element");var v=a('input[type=checkbox][name="BillingInformationViewModel.LicensesAndTerms"]').is(":checked");if(v===false){w.addError(p.LicensesMessage);s.fadeIn();s.addClass("necessary-element")}var u=a(".accord-bar","#billing-information-section").hasClass("collapse");if((!t||!v)&&u){Fonts.UI.accordBarExpandCollapseHandling(a(".accord-bar","#billing-information-section"))}return t&&v}function r(){var s=a("#agreement-to-authorization");s.removeClass("necessary-element");var t=a('input[type=checkbox][name="PaymentInformationViewModel.DirectDebitAuthorization"]').is(":checked");if(t===false){s.fadeIn();s.addClass("necessary-element")}return t}function d(s){if(s.length!==0){s.click(function(){var t=a("#billing-information-section");if(t.length==0){t=a("#login-summary-section")}Fonts.UI.accordBarNavigateHandling(this,function(){a("html, body").animate({scrollTop:t.offset().top},500)})})}}function e(){var s=a(".proccess-billing .payment-pathway","#billing-information-section");if(s.length!==0){s.click(function(){Fonts.Messages.clearAll();if(q()){Fonts.UI.accordBarNavigateHandling(this,function(){a("html, body").animate({scrollTop:a("#payment-information-section").offset().top},500)})}})}}function c(){var s=a(".proccess-billing .back","#billing-information-section");if(s.length!==0){s.click(function(t){Fonts.UI.accordBarNavigateHandling(this,function(){a("html, body").animate({scrollTop:a("#cart-summary-section").offset().top},500)});t.preventDefault()})}}function o(){if(l===false){l=true;var t=a("#payment-information-submit-credit");if(t.length!==0){t.val(Fonts.Translations.pleaseWaitButton);t.addClass("input-appr")}var s=a("#submit-free-payment");if(s.length!==0){s.val(Fonts.Translations.pleaseWaitButton);s.addClass("input-appr")}a("#payment-information-form")[0].submit()}}function f(){var s=a("#submit-free-payment");if(s&&s.length!==0){s.click(function(t){Fonts.Messages.clearAll();t.preventDefault();if(q()){o()}})}}function g(){var s=a("#payment-information-submit-credit");if(s&&s.length!==0){s.click(function(v){Fonts.Messages.clearAll();v.preventDefault();var w=a(".selected-payment-type").val();var u="#payment-information-section #"+w;var t=a("input",u);var x;if(t.length>0){x=t.valid()}else{x=true}if(w=="DirectDebit"){x=r()}if(q()&&x){o()}})}}function b(){var s=a("#cart-payment-paypal-submit");if(s.length!==0){s.click(function(t){Fonts.Messages.clearAll();t.preventDefault();if(q()){o()}})}}k.AttachEventsToApplyCouponCode=function(){a(".couponcode-wrapper input",".totals-table").not("#apply-promotion-to-subscription").click(function(){Fonts.Messages.clearAll();var s=a("#coupon").val();if(s){var t={couponCode:s};a("#cart-summary-section").showLoading();a.ajax({type:"POST",url:Fonts.Urls.applyCartCoupon(),data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(v){var u=v;if(u&&u.Success){k.RefreshCartItemInformation();k.RefreshCartPageSummary();k.UpdateCartPaymentInformation();Fonts.CartSummary.RefreshCartHeaderSummary();Fonts.Messages.addSuccess(u.Message)}else{Fonts.Messages.addError(u.Message)}a("#coupon").val("");a("#cart-summary-section").hideLoading()}})}})};k.AttachEventsToPaymentTypeSelection=function(){a(".cart-payment-type").click(function(s){var t=a(this).data("payment-type");a(".selected-payment-type","#payment-information-form").val(t);if(t==="PayPal"){a("#payment-information-submit-credit").hide();a("#cart-payment-paypal-submit").show()}else{if(t==="None"){a("#payment-information-submit-credit").hide();a("#cart-payment-paypal-submit").hide()}else{a("#payment-information-submit-credit").show();a("#cart-payment-paypal-submit").hide()}}s.preventDefault()})};function n(s,t){if(s==undefined){s=a("#cart-summary-container")}if(t==undefined){t=s.html()}var v=s.parents(".scrollfollow-wrap");if(v.length==0){v=s.parents(".sub")}var w=a('<aside class="pricing cart-summary" id="cart-summary-container"></aside>').html(t);w.css("float","left");v.append(w);var u=w.outerWidth();w.remove();s.parent().css("width",u)}k.RefreshCartPageSummary=function(v,u){var s=a("#cart-summary-container");if(s.length!==0){try{var w=Fonts.Urls.getCartPageSummary();a.ajax({url:w,beforeSend:function(){s.showLoading()},success:function(x){s.html(x);n(s,x);if(a.isFunction(v)){v()}},error:function(){if(a.isFunction(u)){u()}},complete:function(){s.hideLoading()}})}catch(t){}}};k.RefreshCartItemInformation=function(x,w){var s=a("#cart-details-container");if(s.length!==0){try{var u;var t=a(s).data("type");if(t&&t==="readonly"){var y=a("#OrderHash").val();u=Fonts.Urls.getCartItemsDetailsReadonly()+"?orderhash="+y}else{u=Fonts.Urls.getCartItemsDetails()}a.ajax({url:u,beforeSend:function(){s.showLoading()},success:function(z){s.html(z);a(".cust-phone-required").val(a(".order-cust-phone-required").val());k.BindLicenseQuantityEvents(true);k.BindCartItemFormatEvent();k.AttachEventsToApplyCouponCode();d(a(s).find(".payment-pathway","#cart-summary-section"));if(a.isFunction(x)){x()}},error:function(){if(a.isFunction(w)){w()}},complete:function(){s.hideLoading()}})}catch(v){}}};k.OnSuccessUpdateLicenseQuantity=function(s){if(s&&s.Success){if(s.IsEmptyCart){window.location.href=Fonts.Urls.getCartPageUrl();return}Fonts.CartSummary.RefreshCartHeaderSummary(function(){Fonts.Account.AttachEventsToCartTotalSectionsTriggers();Fonts.Account.AttachEventsToMiniCartSectionsTriggers();TopNavigation.bindCartFloating()});k.RefreshCartPageSummary();k.RefreshCartItemInformation();k.UpdateCartPaymentInformation();if(s.WarningMesssage&&s.WarningMessage!==""){Fonts.Messages.addCaution(s.WarningMesssage)}}};k.BindLicenseQuantityEvents=function(s){if(s){a("div.license-quantity-select-parent form").each(function(u,t){a(t).updateValidation()})}a(".license-quantity").on("change",function(){var B=a(this).val();var u=a("#form-"+B);if(u.length!==0){var y=u.find('input[name="lineNumber"]').val();var x=u.find('input[name="licenseQuantity"]').val();Fonts.Messages.clearAll();if(x==-1){var z=a(this).parents("form").children(".license-quantity-manual");z.show();z.find('input[type="text"]').val(250)}else{try{var t=a("#cart-details-container");var v={lineNumber:y,licenseQuantity:x};var A=Fonts.Urls.getUpdateCartLicenseQuantityAddress();a.ajax({type:"POST",url:A,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(v),beforeSend:function(){if(t){t.showLoading()}},success:function(C){k.OnSuccessUpdateLicenseQuantity(C)},complete:function(){if(t){t.hideLoading()}}})}catch(w){}}}})};k.BindCartItemFormatEvent=function(){a(".cart-item-format-selection").on("change",function(){var x=a(this).val();var s=a("#cart-details-container");var t=a("#form-"+x);if(t.length!==0){var v=t.find('input[name="lineNumber"]').val();var y=t.find('input[name="productVariationId"]').val();var u={lineNumber:v,productVariantionId:y};var w=Fonts.Urls.getUpdateCartItemFormat();Fonts.Messages.clearAll();a.ajax({type:"POST",url:w,data:JSON.stringify(u),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){s.showLoading()},success:function(z){if(z&&z.Success){if(z.IsEmptyCart){window.location.href=Fonts.Urls.getCartPageUrl();return}Fonts.CartSummary.RefreshCartHeaderSummary();k.RefreshCartPageSummary();k.RefreshCartItemInformation();k.UpdateCartPaymentInformation()}else{Fonts.Messages.singleError(z.Message)}},complete:function(){if(s){s.hideLoading()}}})}})};k.BindCartOptionsDeleteEvent=function(){var s=a("#delete-cart-button");if(s){s.click(function(){var t=a(this);Fonts.UI.Confirm(t.data("title"),t.data("message"),t.data("confirmText"),t.data("cancelText"),t.data("onConfirm"),t.data("onCancel"),t.data("onOpen"))})}};k.RemoveAllCartItems=function(){var s=a("#delete-cart-form");if(s){s.submit()}};k.RemoveCartItem=function(u,v){var s=a("#cart-summary-section");if(s.length!==0){try{var w=Fonts.Urls.deleteCartItem();Fonts.Messages.clearAll();a.ajax({type:"POST",url:w,data:"{'lineNumber': '"+u+"'}",contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){s.showLoading()},success:function(x){if(x&&x.Success){if(x.IsEmptyCart||x.ReloadCartPage||v){if(v){s.showLoading()}window.location.href=Fonts.Urls.getCartPageUrl();return}Fonts.CartSummary.RefreshCartHeaderSummary();k.RefreshCartPageSummary();k.RefreshCartItemInformation();k.UpdateCartPaymentInformation()}},complete:function(){s.hideLoading()}})}catch(t){}}};k.UpdateCartPaymentInformation=function(){try{var z=Fonts.Urls.getCartPaymentInformationSection();Fonts.Messages.clearAll();var t=a(".billing-information-country").val();var y=a(".selected-payment-type").val();var x="PaymentInformationViewModel_";var w="";var v=a(document.createElement("form"));a('<input type="text"/>').attr("name",w+"PaymentType").attr("value",y).appendTo(v);a('<input type="text" name="selectedCountryCode"/>').attr("value",t).appendTo(v);if(a("#payment-information-section").length>0){var s=a('input[type=checkbox][name="PaymentInformationViewModel.DirectDebitAuthorization"]').is(":checked");a('<input type="text"/>').attr("name",w+"CreditCardTypeId").attr("value",a("#"+x+"CreditCardTypeId").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"AccountNumber").attr("value",a("#"+x+"AccountNumber").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"CvvNumber").attr("value",a("#"+x+"CvvNumber").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"ExpirationMonth").attr("value",a("#"+x+"ExpirationMonth").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"ExpirationYear").attr("value",a("#"+x+"ExpirationYear").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"PurchaseOrderNumber").attr("value",a("#"+x+"PurchaseOrderNumber").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"DirectDebitAuthorization").attr("value",s).appendTo(v);a('<input type="text"/>').attr("name",w+"DirectDebitAccountNumber").attr("value",a("#"+x+"DirectDebitAccountNumber").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"DirectDebitBankCode").attr("value",a("#"+x+"DirectDebitBankCode").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"DirectDebitBranchCode").attr("value",a("#"+x+"DirectDebitBranchCode").val()).appendTo(v);a('<input type="text"/>').attr("name",w+"DirectDebitCheckDigit").attr("value",a("#"+x+"DirectDebitCheckDigit").val()).appendTo(v)}a.ajax({type:"POST",url:z,dataType:"json",data:v.serialize(),beforeSend:function(){var A=a("#payment-information-section");if(A.length!==0){A.showLoading()}},success:function(B){if(B&&B.Success){if(B.RenderedView.length===0){a("#payment-information-section").remove();a(".billing-information-area .submit.proccess-billing").hide();a(".billing-information-area .submit.submit-cart-payment").show();a(".selected-payment-type","#payment-information-form").val("None")}else{var C=a("#payment-information-section");if(C.length>0){C.remove()}a("#billing-information-section").after(B.RenderedView);a(".billing-information-area .submit.proccess-billing").show();a(".billing-information-area .submit.submit-cart-payment").hide();if(B.PaymentType){a(".selected-payment-type","#payment-information-form").val(B.PaymentType)}else{a(".selected-payment-type","#payment-information-form").val("None")}var A=a(".accord-bar","#payment-information-section");if(A.length!==0){A.click(function(D){Fonts.UI.accordBarExpandCollapseHandling(A);D.preventDefault()})}a("#payment-information-form").updateValidation();g();k.AttachEventsToPaymentTypeSelection();b();Fonts.UI.tabSortSwitcher(a("ul.tabs li, ul.sort li","#payment-information-section"))}}else{}},complete:function(){var A=a("#payment-information-section");if(A.length!==0){A.hideLoading()}}})}catch(u){}};k.OnFeatureUpgradePopup=function(t){if(t.length!==0){var s=a(t);s.lightbox_me({onLoad:function(){BindTextPopperHover(s.find(".textpopper"));s.find(".opent-type-selected-action").click(function(){try{var y=a(this).data("variation-id");var w=s.find("#CartLineNumber").val();var u={lineNumber:w,productVariantId:y};var x=Fonts.Urls.getUpdateCartItemFeature();a.ajax({type:"POST",url:x,data:JSON.stringify(u),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(){s.find(".modal-content").showLoading()},success:function(z){if(z&&z.Success){a("#feature-upgrade-dialog .close").click();if(z.IsEmptyCart){window.location.href=Fonts.Urls.getCartPageUrl();return}Fonts.CartSummary.RefreshCartHeaderSummary();k.RefreshCartPageSummary();k.RefreshCartItemInformation();k.UpdateCartPaymentInformation()}else{var A=new UserMessages(a,"open-type-options-messages-container");A.singleError(z.Message)}},complete:function(){s.find(".modal-content").hideLoading()}})}catch(v){}})},destroyOnClose:true})}};k.onAddCartItemToWishlistPopup=function(t){if(t.length!==0){var s=a(t);s.find("select").selectbox();s.lightbox_me({onLoad:function(){s.find("#add-cart-item-to-new-wishlist-form").updateValidation();Fonts.UI.BindJsonpFormSubmitEvents("#add-cart-item-to-wish-content");Fonts.Account.AttachEventsToMemberSigninForSelector(s.find(".password-reset-link-trigger","#add-cart-item-to-wish-content"));s.find('form[data-ajax="true"] input.ajaxforce').click(function(u){u.preventDefault();var v=a(this).closest("form");if(v.valid()){v.submit()}});s.find(".wislist-popup-close").click(function(v){var u=a(this).closest(".wishlist-modal").find(".close");if(u.length!==0){u.click()}v.preventDefault()})},destroyOnClose:true})}};k.onCreatedAndAddedToWishlist=function(u){if(u.length!==0){a("#add-cart-item-to-wish-content select").selectbox();var v=a(".success.user-message","#add-cart-item-to-wish-content");var s="TempIntervalId",t=v.data(s);clearInterval(t);t=setTimeout(function(){v.children().fadeOut(function(){v.empty()});a(".success-user-message-container","#add-cart-item-to-wish-content").hide()},3000);v.data(s,t);a("#add-cart-item-to-wish-content .wislist-popup-close").click(function(x){var w=a(this).closest(".wishlist-modal").find(".close");if(w.length!==0){w.click()}x.preventDefault()})}};k.showPolicyBalloon=function(t,s){a(t).click(function(){a(this).siblings(s).stop().fadeIn("fast")})};k.closePolicyBalloon=function(t,s){a(t).click(function(){a(this).parent(s).stop().hide()})};k.RefreshCartSections=function(){k.RefreshCartItemInformation();k.RefreshCartPageSummary();k.UpdateCartPaymentInformation()};k.cartVatCalculation=function(){var u="BillingInformationViewModel_";var t=u+"CustomerAddressViewModel_";var s="CustomerAddressViewModel.";if(a("#"+t+"Address1").val().length===0||a("#"+t+"City").val().length===0||a("#"+t+"CountryCode").val().length===0||(a("#"+t+"CountryCode").val()==="US"&&(a("#"+t+"StateCode").length===0||a("#"+t+"StateCode").val().length===0))||a("#"+t+"PostalCode").val().length===0){return}var v=a(document.createElement("form"));if(a("#OrderId").length===1){a('<input type="text"/>').attr("name","OrderId").attr("value",a("#OrderId").val()).appendTo(v)}a('<input type="text" name="VatCode"/>').attr("value",a("#"+u+"VatCode").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"AddressId").attr("value",a("#"+t+"AddressId").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"Address1").attr("value",a("#"+t+"Address1").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"Address2").attr("value",a("#"+t+"Address2").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"City").attr("value",a("#"+t+"City").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"CountryCode").attr("value",a("#"+t+"CountryCode").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"Email").attr("value",a("#"+t+"Email").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"FirstName").attr("value",a("#"+t+"FirstName").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"LastName").attr("value",a("#"+t+"LastName").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"OrganizationName").attr("value",a("#"+t+"OrganizationName").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"Phone").attr("value",a("#"+t+"Phone").val()).appendTo(v);a('<input type="text"/>').attr("name",s+"PostalCode").attr("value",a("#"+t+"PostalCode").val()).appendTo(v);if(a("#"+t+"StateCode").length===1){a(document.createElement("input")).attr("name",s+"StateCode").attr("type","text").attr("value",a("#"+t+"StateCode").val()).appendTo(v)}Fonts.Messages.clearAll();a.ajax({type:"POST",url:Fonts.Urls.getCartVatCalculationUrl(),data:v.serialize(),dataType:"json",success:function(w){if(w.Success&&w.ChangedTaxAmount){if(w.TaxChangedMessage!==""){Fonts.Messages.clearAll();Fonts.Messages.addCaution(w.TaxChangedMessage)}Cart.RefreshCartItemInformation();Cart.RefreshCartPageSummary();Fonts.CartSummary.RefreshCartHeaderSummary()}},global:false,error:function(){}})};k.SendOrderReceiptComplete=function(s){var t={container:s.ResponseContainer+"-messages",data:s.Messages};if(!s.Success){t.removeAfter=-1}Fonts.UI.ShowAndRemove(t);a(s.ResponseContainer).hideLoading()};function i(){var s=a("#modal-survey");if(s.length>0){s.lightbox_me({onLoad:function(){a("#surveyMonkeyInfo").ready(function(){a("iframe#sm_e_s").load(function(){a(this).css("padding-bottom","0")})});a("#surveyMonkeyInfo").show()},destroyOnClose:true})}}function h(){a("#cart-login-details-container .reset-password-section a.close").click(function(){Fonts.Account.RestoreMemberSigninForm()})}function m(u,s,t){CheckFontsToolkitStatusTimer=setTimeout(function(){a.ajax({type:"POST",url:u,success:function(v){if(v.Status==="generated"){s(v.FileUrl,v.Message)}else{if(v.Status==="not_generated"&&v.Success){t(v.Message)}else{CheckFontsToolkitStatus(u,s,t)}}},error:function(){CheckFontsToolkitStatus(u,s,t)}})},5000)}function j(){a("#download-kit").click(function(){var u=new UserMessages(jQuery,"publish-settings-messages");var s=a(this).data("checkUrl");var t=a(this).data("actionUrl");a.ajax({type:"POST",url:t,beforeSend:function(){a("#download-kit").hide();a("#download-kit-working").show();a("#download-kit-loading").showLoading()},success:function(v){if(v.Status==="generated"){a("#download-kit").show();a("#download-kit-working").hide();a("#download-kit-loading").hideLoading();a("[name=download-kit-iframe]").attr("src",v.FileUrl)}else{if(v.Status==="in_progress"){m(s,function(w,x){u.singleSuccess(x);a("#download-kit").show();a("#download-kit-working").hide();a("#download-kit-loading").hideLoading();a("[name=download-kit-iframe]").attr("src",w)},function(w){u.singleError(w);a("#download-kit").show();a("#download-kit-working").hide();a("#download-kit-loading").hideLoading()})}}if(v.Message!==""){if(v.Success){u.singleSuccess(v.Message)}else{u.singleError(v.Message)}}},error:function(){a("#download-kit").show();a("#download-kit-working").hide();a("#download-kit-loading").hideLoading();u.singleError(Fonts.Translations.getErrorMessage())}})})}a(document).ready(function(){d(a(".payment-pathway","#cart-summary-section"));e();c();f();b();g();n();i();h();j()});return k}(jQuery));Fonts.CartSummary=(function(a){var c={};var b=false;c.setCartPageIsActive=function(){b=true};c.OnSuccessCallRemoveCartItem=function(g){var h=a("<div>").html(g).find("#ReloadCartPage");if(h&&h.val()==="True"&&b){window.location.href=Fonts.Urls.getCartPageUrl();return}Fonts.CartSummary.UpdateAllAddToCartButtons();if(b){Fonts.Cart.RefreshCartItemInformation();Fonts.Cart.RefreshCartPageSummary();Fonts.Cart.UpdateCartPaymentInformation()}TopNavigation.bindCartFloating();Fonts.Account.AttachEventsToCartTotalSectionsTriggers();Fonts.Account.AttachEventsToMiniCartSectionsTriggers()};c.AttachCartOptionsDropDown=function(){a('input[name="cartOptionSelection"]').change(function(){if(this.value){switch(this.value){case"wishlist":a("div.cart-option-wish-list").show();a("p.go-to-wish-list-container").show();a("div.cart-option-quote").hide();a("div.cart-option-delete").hide();break;case"quote":a("div.cart-option-wish-list").hide();a("p.go-to-wish-list-container").hide();a("div.cart-option-quote").show();a("div.cart-option-delete").hide();break;case"deletecart":a("div.cart-option-wish-list").hide();a("p.go-to-wish-list-container").hide();a("div.cart-option-quote").hide();a("div.cart-option-delete").show();break}}})};c.RefreshCartHeaderSummary=function(i,h){try{var j=Fonts.Urls.getCartFloatingNavigation();a.ajax({url:j,beforeSend:function(){a("#cart-floating-nav-container").showLoading()},success:function(k){a("#cart-floating-nav-container").html(k);c.BindAllCartNavigationBlockEvents();if(typeof i!=="undefined"){i()}},error:function(){if(typeof h!=="undefined"){h()}},complete:function(){a("#cart-floating-nav-container").hideLoading()}})}catch(g){}};c.AddToCartBegin=function(h){var g=d(h);c.ManageAddToCartButtons(g,false,false,true);Fonts.UI.showAsideSpinner()};c.AddToCartSuccess=function(h){if(h){if(h.Html){var i=a(h.Html);var g=d(h.ContainerId);if(window._gaq){window._gaq.push(["_trackEvent","BuyPath","CrossSellModalShow"])}i.lightbox_me({destroyOnClose:true});g.each(function(){c.ManageAddToCartButtons(a(this),true,false,false)})}else{e(h)}}Fonts.UI.hideAsideSpinner()};c.AddToCombinedCartSuccess=function(g){a("#combined-cart-modal").trigger("close");e(g)};function e(h){var g=d(h.ContainerId);if(h.Success){c.RefreshCartHeaderSummary(function(){var j=Fonts.CartSummary.GetAddedProductVariationsToCart();c.UpdateWishListAddToCartButtons(j);g.each(function(){var k=a(this);var m=a("select",k);var n=m.val();if(m.length==0){n=k.find('input[name="VariationId"]').val()}var l=a.inArray(n,j)>-1;c.ManageAddToCartButtons(k,!l,l,false)});TopNavigation.bindCartFloating();Fonts.Account.AttachEventsToCartTotalSectionsTriggers();Fonts.Account.AttachEventsToMiniCartSectionsTriggers()},function(){c.ManageAddToCartButtons(g,true,false,false)})}else{c.ManageAddToCartButtons(g,true,false,false);var i=Fonts.UI.Alert(h.MessageTitle);i.addError(h.Message)}}c.WishListAddToCartSuccess=function(g){var h={container:"#wish-list-add-to-cart-user-messages",data:g.Messages};if(g.Success){c.RefreshCartHeaderSummary(function(){c.UpdateAllAddToCartButtons();Fonts.UI.ShowAndRemove(h);TopNavigation.bindCartFloating();Fonts.Account.AttachEventsToCartTotalSectionsTriggers();Fonts.Account.AttachEventsToMiniCartSectionsTriggers();a("#wish-list-add-to-cart").parent().hideLoading()},function(){a("#wish-list-add-to-cart").parent().hideLoading()})}else{h.removeAfter=-1;Fonts.UI.ShowAndRemove(h)}};c.WishListAddToCartFailure=function(){c.ManageAddToCartButtons(a("#wish-list-add-to-cart"),true,false,false);a("#wish-list-add-to-cart").parent().hideLoading()};c.AddToCartFailure=function(){c.UpdateAllAddToCartButtons();Fonts.UI.hideAsideSpinner()};c.GetAddedProductVariationsToCart=function(){var h=a("#ProjectVariationsAlreadyInCart").val();var g=[];if(h){g=h.split(",")}return g};c.ManageAddToCartButtons=function(g,j,k,l){var h=a.makeArray(g);for(var i in h){f(a(h[i]),j,k,l)}};c.UpdateAllAddToCartButtons=function(){var g=a(".form-add[data-addToCartIdentifier]"),h=Fonts.CartSummary.GetAddedProductVariationsToCart();g.each(function(){var i=a(this),j=a.inArray(i.find("[name=VariationId]").val(),h)>-1;c.ManageAddToCartButtons(i,!j,j,false)});c.UpdateWishListAddToCartButtons(h)};c.UpdateWishListAddToCartButtons=function(h){var i=a("#whish-list-products"),g;if(i.length){g=a("#wish-list-add-to-cart");if(c.allWhishListProductsInCart(i,h)){g.find(".add-to-cart-button").hide();g.find(".in-cart-button").show()}else{g.find(".add-to-cart-button").show();g.find(".in-cart-button").hide()}}};c.allWhishListProductsInCart=function(q,k){var g=false,o,p,m=q.find("input"),n=m.length,h,l;for(h=0;h<n;h++){g=false;o=m[h].value.split(",");p=o.length;for(l=0;l<p;l++){if(a.inArray(o[l],k)>-1){g=true;break}}if(!g){break}}return g};function d(g){return a(".form-add[data-addToCartIdentifier='"+g+"']")}function f(i,j,k,l){var g=i.find(".add-to-cart-button");var h=i.find(".in-cart-button");var m=i.find(".add-to-cart-wait");if(j){g.show()}else{g.hide()}if(k){h.show()}else{h.hide()}if(l){m.show()}else{m.hide()}}c.BindCartItemRemoveAction=function(g){if(g){g.click(function(h){a(this).parent().parent().prev(".confirm-remove").show();a(this).closest(".cart-info").hide();h.stopPropagation()})}};c.BindCartItemCancelRemoveAction=function(g){if(g){g.click(function(h){a(this).closest(".confirm-remove").hide();a(this).closest(".confirm-remove").next().show();h.stopPropagation()})}};c.AttachEventsToRemoveCartItemLink=function(){a(".remove-cart-item-a").click(function(){a(this).parents("form.remove-cart-item-from").submit()})};c.BindAllCartNavigationBlockEvents=function(){c.BindCartItemRemoveAction(a(".hovered-cart .remove"));c.BindCartItemCancelRemoveAction(a(".hovered-cart .cancel"));c.AttachEventsToRemoveCartItemLink()};return c}(jQuery));Fonts.Contacts=(function(a){var b={};b.NeedSupportSubmitSuccess=function(c){if(c.Success){Header.ClearFields("#need-support-form");Fonts.UI.ShowAndRemove({container:".need-support-request-messages",data:c.Messages})}};b.SalesQuoteSubmitSuccess=function(c){b.showAndRemoveMessage(c,".sales-quote-form .messages-container")};b.LibraryInformationRequestSubmitSuccess=function(c){b.showAndRemoveMessage(c,".library-information-request-form .messages-container")};b.SiteCommentsSubmitSuccess=function(c){b.showAndRemoveMessage(c,".site-comments-form .messages-container")};b.showAndRemoveMessage=function(d,c){var e={container:c,data:d.Message,removeAfter:2000};if(!d.Success){e.removeAfter=-1}Fonts.UI.ShowAndRemove(e)};b.ShowStatesInRequestForm=function(){var c=a("#Country");var d=function(e){if(a(e).val()!="US"){a("#state-list").hide()}else{a("#state-list").show()}};d(c);c.change(function(){d(a(this))})};return b}(jQuery));Fonts.ValidationMessages=(function(a){var b={};var c=[];b.setInvalidPhoneNumberGeneralMessage=function(d){c.invalidPhoneNumberGeneral=d;return this};b.getInvalidPhoneNumberGeneralMessage=function(){return c.invalidPhoneNumberGeneral};b.setInvalidPhoneNumberForUsAndCa=function(d){c.invalidPhoneNumberUsAndCa=d;return this};b.getInvalidPhoneNumberForUsAndCa=function(){return c.invalidPhoneNumberUsAndCa};b.setInvalidPostalCodeForUsMessage=function(d){c.invalidPostalCodeForUs=d;return this};b.getInvalidPostalCodeForUsMessage=function(){return c.invalidPostalCodeForUs};b.setInvalidPostalCodeForCaMessage=function(d){c.invalidPostalCodeForCa=d;return this};b.getInvalidPostalCodeForCaMessage=function(){return c.invalidPostalCodeForCa};return b}(jQuery));Fonts.Dropdowns=(function(a){var d={},b=null,c=null;d.attachSkyFontsDropdowns=function(e,f){Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".dev-add-skyfonts-dropdown",close:".dev-add-to-skyfonts-close",onInitialized:function(g){Fonts.SkyFontDropdown.onInitializedDropdown(g,f)}})};d.AttachAllDropdowns=function(e){Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".account-wishlist-dropdown",close:".account-wishlist-close",callback:function(f){f.find(".send-wishlist-email").hide();f.find(".delete-wishlist").show();f.find('[id ^= "delete-wish-list"]').attr("checked",true);f.find("#SendToEmailAddress").val("")}});Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".add-to-wishlist-dropdown",close:".add-to-wishlist-close",callback:function(f){f.find(".wish-list-drop-down-list").children(":selected").removeAttr("selected");f.find(".wish-list-drop-down-list").children(":first").attr("selected","selected");f.find(".sbSelector").text(f.find(".wish-list-drop-down-list").children(":selected").text());f.find(".new-wishlist-name").val("")}});Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".add-to-web-fonts",close:".add-to-web-fonts-close",callback:function(f){f.find(".web-fonts-drop-down-list").children(":selected").removeAttr("selected");f.find(".web-fonts-drop-down-list").children(":nth-child(2)").attr("selected","selected");f.find(".sbSelector[id $= "+f.find(".web-fonts-drop-down-list").attr("sb")+"]").text(f.find(".web-fonts-drop-down-list").children(":selected").text());f.find(".add-to-project-font-selector").children(":selected").removeAttr("selected");f.find(".add-to-project-font-selector").children(":nth-child(1)").attr("selected","selected");f.find(".sbSelector[id $= "+a(".add-to-project-font-selector").attr("sb")+"]").text(f.find(".add-to-project-font-selector").children(":selected").text());f.find(".new-webfontsproject-name").val("").hide()}});Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".cart-options-dropdown",close:".cart-options-close",callback:function(f){f.find(".cart-option-wish-list").show();f.find(".cart-option-quote").hide();f.find(".cart-option-delete").hide();f.find("#cart-option-add-to-wish-list").attr("checked","checked");f.find(".wish-list-drop-down-list").children(":selected").removeAttr("selected");f.find(".wish-list-drop-down-list").children(":first").attr("selected","selected");f.find(".sbSelector").text(f.find(".wish-list-drop-down-list").children(":selected").text());f.find(".new-wishlist-name").val("")}});Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".sign-in-dropdown",close:".sign-in-close",callback:function(f){f.find('[id $= "signin-user-name"]').val("");f.find('[id $= "signin-password"]').val("");f.find('[id $= "reset-password-email"]').val("");f.find('[id $= "signin-remember-me"]').removeAttr("checked")}});Fonts.Dropdowns.AttachDropdown({container:e,dropdown:".simple-dropdown",close:".simple-close",callback:null});d.attachSkyFontsDropdowns(e)};d.AttachDropdown=function(h){var g=function(k,i){var j=b.closest(".with-dropdown");(i==null)?j.find(".dropdown").fadeOut("fast"):j.find(".dropdown").fadeOut("fast",function(){i(j)});k.parentsUntil(".with-dropdown").removeClass("active");k.parents(".with-dropdown").removeClass("active");b=null;c=null},e=h.container,f=e.find(".with-dropdown "+h.dropdown);f.closest(".with-dropdown").children(".trigger").click(function(i){var j=a(this).parentsUntil(".list-add"),k=a(this);j.siblings(".with-dropdown").removeClass("active");j.siblings().children(".dropdown").fadeOut("fast");if(k.parent().hasClass("active")){g(b,h.callback)}else{if(b!=null){g(b,c)}k.parent().addClass("active");a(".dropdown",k.parent()).fadeIn("fast");b=k;c=h.callback}i.preventDefault()});e.find(".dropdown .close"+h.close+", .dropdown-close"+h.close+", .dropdown "+h.close).click(function(){g(a(this).parents(".with-dropdown").find(".trigger"),h.callback)});a.each(e.find('form[data-ajax="true"] input.ajaxforce'),function(j,i){if(!i.IsAjaxButtonClickBound){a(i).click(function(k){k.preventDefault();var l=a(this).closest("form");if(l.valid()){l.submit()}});i.IsAjaxButtonClickBound=true}});e.find(".list-add, .pricing .with-dropdown, .page-header .with-dropdown").click(function(i){i.stopPropagation()});if(a.browser.msie&&parseInt(a.browser.version,10)<8){e.find(".with-dropdown .trigger").click(function(){e.find(".font-results li").css("z-index","0");a(this).parents("li").eq(0).siblings().css("z-index","-1");a(this).closest(".font-results-parent").siblings("ul").children("li").css("z-index","-1")})}if(a.browser.msie&&parseInt(a.browser.version,10)<8){e.find(".order-details .sbHolder").click(function(){e.find(".font-results li").css("z-index","0");a(this).parents("li").eq(0).siblings().css("z-index","-1");a(this).closest(".font-results-parent").siblings("ul").children("li").css("z-index","-1")})}if(typeof h.onInitialized==="function"){h.onInitialized(f)}};d.AttachHtmlClick=function(){a("html").click(function(){a("select[sb]").selectbox("close");a(".dropdown").hide();a(".with-dropdown").removeClass("active")})};return d}(jQuery));Fonts.Fileuploader=(function(a){var c={};var b="";c.clickToSelectFileMessage=function(d){b=d};c.CreateFileUploader=function(f,l,d,j,i,k){var e=a("#"+f);var g=a("input[data-fileupload=file]",e);var h=new AjaxUpload(e,{autoSubmit:d,action:l,responseType:k,name:a(g).attr("name"),onChange:function(n,m){a(g).val(n)},onSubmit:function(n,m){this.disable();if(typeof j==="function"){j()}},onComplete:function(m,n){this.enable();Fonts.Fileuploader.ClearFileField(g);if(typeof i==="function"){i(n)}}});return h};c.SetFileUploader=function(g,k,d,i,h,j){var f=a("input[data-fileupload=file]",g);var e=a("div[data-fileupload=browse]",g);c.fileupload=new AjaxUpload(e,{autoSubmit:d,action:k,responseType:j,name:a(f).attr("name"),onChange:function(m,l){a(f).val(m)},onSubmit:function(m,l){this.disable();c.fileupload.setData(c.SetData(g));if(typeof i==="function"){i()}},onComplete:function(l,m){this.enable();c.ClearFileField(f);if(typeof h==="function"){h(m)}else{a(".messages-container",g).html(m);c.ClearForm(g)}}});c.ClearFileField(f);g.submit(function(l){if(g.valid()){c.fileupload.submit()}l.preventDefault();return false})};c.SetData=function(d){var e=d.serializeArray();var f={};a.each(e,function(){if(f[this.name]!==undefined){if(!f[this.name].push){f[this.name]=[f[this.name]]}f[this.name].push(this.value||"")}else{f[this.name]=this.value||""}});return f};c.ClearForm=function(e){a("input[type=text]",e).val("");a("textarea",e).val("");var d=a("input[data-fileupload=file]",e);c.ClearFileField(d)};c.ClearMessagesContainer=function(d){a(".messages-container",d).html("")};c.ClearFileField=function(d){a(d).val(b)};c.FileSelected=function(d){var e=a(d).val();return e!=null&&e!=b};return c}(jQuery));var FontPreview=(function(a){var h={},b=".preview-change",g={imageUrlTextProperty:"RenderText",imageWidthUrlProperty:"width",imageType:"thumbnail",searchImageDefaultWidth:880,textBoxClass:"new-font-preview",textBoxClassWebFonts:"input-webfont-preview",defaultText:"The quick brown fox jumps over a lazy dog",webFontDivSelector:".webfont-preview-text",frsUrl:"",cdnFrsUrl:"",tryItOutImageWidth:"",defaultTextsList:{},defaultTextsInUppercase:{},defaultTextsInLowercase:{}};function d(i){return encodeURIComponent(i).replace(/%20/g,"+")}function c(i){return decodeURIComponent(i.replace(/\+/g,"%20"))}function f(i,j){return("&RenderText="+a("a[data-shop-id="+i+"] img").data("sample-text"))===c(j)}function e(k,l,m,j,i){if((g.defaultTextsList[l]||f(k,l))&&(!m||m==="32")&&(!j||j==="000000")&&(!i||i==="ffffff")){return g.cdnFrsUrl}return g.frsUrl}h.SetDefaultTextsList=function(j){var i=j.length;while(i--){var k=j[i];g.defaultTextsList["&RenderText="+d(k)]=true;g.defaultTextsInUppercase[k.toUpperCase()]=k;g.defaultTextsInLowercase[k.toLowerCase()]=k}};h.ChangeDefaultText=function(i){g.defaultText=i;return this};h.SetFrsUrl=function(i){g.frsUrl=i;return this};h.SetCdnFrsUrl=function(i){g.cdnFrsUrl=i;return this};h.SetTryItOutImageWidth=function(i){g.tryItOutImageWidth=i;return this};h.GetQueryStringValue=function(k,i){var l=new RegExp(i+"=([^&]*)","i"),j=k.match(l),m;if(j){m=(j[1]||"");return c(m)}return null};h.SetQueryStringValue=function(j,i,l){var k=new RegExp("("+i+"=)([^&]*)");return j.replace(k,"$1"+d(l).replace("$","$$$"))};h.HtmlEncode=function(i){return a("<div/>").text(i).html()};h.CancelTextbox=function(l){var j=l.closest(".preview"),k=j.find(".preview-image"),i=j.find(b);k.show();l.remove();i.hide()};h.BindInputEvents=function(m){var j=false,k=13,l=27,i=17;m.on("keydown",function(n){if(n.which===k){h.UpdateImage(m,j)}else{if(n.which===l){h.CancelTextbox(m)}}j=n.which===i}).on("keyup",function(n){j=n.which===i}).on("blur",function(){setTimeout(function(){h.CancelTextbox(m)},200)})};h.UpdateImage=function(r,w){var l=r.closest(".preview"),q=l.find(".preview-image"),p=q.find("img:first"),i=l.find(b),v=p.attr("src"),t=r.val(),u=q.attr("data-shop-id");var k=a("input[name=colorpicker-foreground]").val();var j=a("input[name=colorpicker-background]").val();var n=a("select[name=font-size]").val();var m=[];a(".search-featuredicons li.feature-active a").each(function(z,y){m.push(a(y).data("ot-feature"))});var o=h.GetQueryStringValue(v,g.imageWidthUrlProperty);var x=o!=undefined&&o!=""?o:g.searchImageDefaultWidth;var s=h.GetFrsImageUrl(g.imageType,0,u,x,t,null,null,k,j,n,m,p.data("char-coverage"));r.remove();i.hide();p.attr("src",s);q.show();if(w){h.UpdateAllImages(t)}};h.UpdateAllImages=function(m){var j=a("input[name=colorpicker-foreground]").val();var i=a("input[name=colorpicker-background]").val();var l=a("select[name=font-size]").val();var k=[];a(".search-featuredicons li.feature-active a").each(function(o,n){k.push(a(n).data("ot-feature"))});a(".preview-image").each(function(){var q=a(this),n=q.find("img:first"),o=n.attr("src"),s=q.data("shop-id"),r=q.parents(".preview-container");var p=h.GetQueryStringValue(o,g.imageWidthUrlProperty);var v=p!=undefined&&p!=""?p:g.searchImageDefaultWidth;var t=m;if(t==undefined){t=h.GetQueryStringValue(o,g.imageUrlTextProperty)}var u=h.GetFrsImageUrl(g.imageType,0,s,v,t,null,null,j,i,l,k,n.data("char-coverage"));if(o!==u){r.showLoading();n.load(function(){r.hideLoading()});n.attr("src",u)}});if(m!=undefined){h.SaveDefaultPreviewText(m)}if(a("input[name=colorpicker-foreground]").length>0){h.SavePreviewImageTextColor(j)}if(a("input[name=colorpicker-background]").length>0){h.SavePreviewImageBackgroundColor(i)}if(a("select[name=font-size]").length>0){h.SavePreviewImageFontSize(l)}if(a(".search-featuredicons li a").length>0){h.SavePreviewImageOtFeatures(k)}};h.GetFrsImageUrl=function(s,x,q,t,C,l,u,n,m,p,v,k){var B="";var D="";var z="";var w="";var r="";var A="";var o="";var j="";if(Common.isNumeric(x)&&Common.isNumeric(q)){if(!Common.isNumeric(t)){t=g.tryItOutImageWidth}D="&width="+t;if(Common.isNumeric(p)){A="&TextSize="+p}if(n&&n.length==6){o="&TextColor=%23"+n}if(m&&m.length==6){j="&BgColor=%23"+m}if(l){w="&CodePage="+l;r="&IsFullImage="+(u?"True":"False")}else{z="&RenderText="+(C?d(C):g.defaultText)}B="http://"+e(q,z,p,n,m)+"/ImagingService.ashx?imagetype="+s+"&shopid="+q;if((g.defaultTextsList[z]||f(q,z))&&k){if(k.match(/lowercase/i)){z=z.toLowerCase()}if(k.match(/uppercase/i)){z=z.toUpperCase()}}B+=D+z+A+o+j+w+r;var y=[],i=[];a.each(v,function(F,E){if(E=="swsh"||E=="salt"||E=="nalt"||E=="cswh"){i.push(E+"=1")}else{y.push(E)}});if(y.length>0){B+="&otf="+y.join("|")}if(i.length>0){B+="&"+i.join("&")}}return B};h.ReplaceImageWithTextBox=function(k){var j=k.find("img:first"),n=j.attr("src"),o=h.GetQueryStringValue(n,g.imageUrlTextProperty),l=a('<input type="text" class="'+g.textBoxClass+'" />'),i=j.data("char-coverage");if(i){var m=null;if(i.match(/lowercase/i)){m=g.defaultTextsInLowercase[o]}if(i.match(/uppercase/i)){m=g.defaultTextsInUppercase[o]}if(m){o=m}}l.val(h.HtmlEncode(o));k.hide();h.BindInputEvents(l);l.insertAfter(k).select();a(b,k.parent()).show()};h.InitializeEvents=function(n){var k=n.closest(".font-container"),m=a(".action-save-font-preview",k),i=a(".action-change-font-preview-all",k),l=a(".action-reset-font-preview-all",k),j="click";n.off(j).on(j,function(o){o.preventDefault();var p=k.find(".preview-image:visible");if(p.length){h.ReplaceImageWithTextBox(p)}});m.off(j).on(j,function(){h.UpdateImage(k.find("."+g.textBoxClass))});i.off(j).on(j,function(){h.UpdateImage(k.find("."+g.textBoxClass),true)});l.off(j).on(j,function(){h.CancelTextbox(k.find("."+g.textBoxClass));h.UpdateAllImages(g.defaultText)})};h.UpdateText=function(l,n){var j=l.closest(".preview"),k=j.find(g.webFontDivSelector),i=j.find(b),m=l.val();l.remove();i.hide();if("false"==k.data("enable-subsetting").toLowerCase()){k.text(m).show()}if(n){h.UpdateAllText(m)}};h.UpdateAllText=function(i){a(g.webFontDivSelector).each(function(){var j=a(this);if("false"==j.data("enable-subsetting").toLowerCase()){j.text(i).show()}});h.SaveDefaultPreviewText(i)};h.CancelTextboxForWebfonts=function(l){var j=l.closest(".preview"),k=j.find(g.webFontDivSelector),i=j.find(b);k.show();l.remove();i.hide()};h.BindInputEventsForWebfonts=function(m){var j=false,k=13,l=27,i=17;m.on("keydown",function(n){if(n.which===k){h.UpdateText(m,j)}else{if(n.which===l){h.CancelTextboxForWebfonts(m)}}j=n.which===i}).on("keyup",function(n){j=n.which===i}).on("blur",function(){setTimeout(function(){h.CancelTextboxForWebfonts(m)},200)})};h.ReplaceDivWithTextBox=function(i){var l=a.trim(i.text()),j=i.data("font-family"),k=a('<input type="text" value="'+h.HtmlEncode(l)+'" class="'+g.textBoxClassWebFonts+'" style="font-family:\''+j+"'\" />");i.hide();h.BindInputEventsForWebfonts(k);k.insertAfter(i).focus();a(b,i.parent()).show()};h.InitializeEventsForWebfonts=function(n){var k=n.closest(".font-container"),m=a(".action-save-font-preview",k),i=a(".action-change-font-preview-all",k),l=a(".action-reset-font-preview-all",k),j="click";n.off(j).on(j,function(p){p.preventDefault();var o=k.find(g.webFontDivSelector+":visible");if(o.length){h.ReplaceDivWithTextBox(o)}});m.off(j).on(j,function(){h.UpdateText(k.find("."+g.textBoxClassWebFonts))});i.off(j).on(j,function(){h.UpdateText(k.find("."+g.textBoxClassWebFonts),true)});l.off(j).on(j,function(){h.CancelTextboxForWebfonts(k.find("."+g.textBoxClassWebFonts));h.UpdateAllText(g.defaultText)})};h.BindEvents=function(){a(".try-it").off("click").each(function(){var i=a(this);if(i.hasClass("try-webfont")){h.InitializeEventsForWebfonts(i)}else{h.InitializeEvents(i)}})};h.attachColorPicker=function(j){var k=".colorpicker-"+j;if(a(k).length>0){var i="#"+a(k).val();a("."+j+"Selector .selectorSwitch").css("background-color",i);a("."+j+"Selector .colorPalette").ColorPicker({onChange:function(m,l,n){a(k).val(l).trigger("change");a("."+j+"Selector .selectorSwitch").css("background-color","#"+a(k).val())},color:i,flat:true});a("."+j+"Selector .selectorSwitch").click(function(){h.toggleColorPicker(j)})}};h.toggleColorPicker=function(j){var i=a("."+j+"Selector .colorPalette:visible").length;a(".colorPalette").hide();if(!i||i==0){a("."+j+"Selector .colorPalette").show()}};h.attachColorPickerCloseListener=function(){var i=false;a(".colorPalette").hover(function(){i=true},function(){i=false});a("body").mouseup(function(){if(!i){a(".colorPalette").hide()}})};h.SaveDefaultPreviewText=function(i){i=i.replace(/\n/g,"<br />");document.cookie="__fontPreview_DefaultTextIndex="+escape(i)+"; path=/"};h.GetDefaultPreviewText=function(){return Cookies.get("__fontPreview_DefaultTextIndex")};h.SaveItemsPerPageQuantity=function(i){Cookies.set("__fontPreview_ItemsPerPage",i,365)};h.SavePreviewImageTextColor=function(i){document.cookie="__fontPreview_PreviewImageTextColor="+i+"; path=/"};h.GetPreviewImageTextColor=function(){var i=Cookies.get("__fontPreview_PreviewImageTextColor");if(i==undefined){i="000000"}return i};h.SavePreviewImageBackgroundColor=function(i){document.cookie="__fontPreview_PreviewImageBackgroundColor="+i+"; path=/"};h.GetPreviewImageBackgroundColor=function(){var i=Cookies.get("__fontPreview_PreviewImageBackgroundColor");if(i==undefined){i="ffffff"}return i};h.SavePreviewImageFontSize=function(i){document.cookie="__fontPreview_PreviewImageFontSize="+i+"; path=/"};h.GetPreviewImageFontSize=function(){var i=Cookies.get("__fontPreview_PreviewImageFontSize");if(i==undefined){i="32"}return i};h.SavePreviewImageOtFeatures=function(i){document.cookie="__fontPreview_PreviewImageOtFeatures="+i+"; path=/"};h.GetPreviewImageOtFeatures=function(){return Cookies.get("__fontPreview_PreviewImageOtFeatures")};return h}(jQuery));Fonts.Products=(function(a){var e={};var c=false;function d(h,j,m,k,l){var f=h.find(".submit>input.add-to-project");var n=h.find(".submit>input.add-to-project-wait");var g=h.find(".submit>input.added-to-project");var i=h.find(".submit>form.upgrade-subscription");if(j===true){f.show()}else{f.hide()}if(m===true){n.show()}else{n.hide()}if(k===true){g.show()}else{g.hide()}if(l!==true){i.show()}else{i.hide()}}e.updateAddToProjectSubmitButtonToWait=function(f){d(f,false,true,false,false)};e.updateAddToProjectSubmitButtonToAdd=function(f){d(f,true,false,false,false)};e.updateAddToProjectSubmitButtonToAdded=function(f){d(f,false,false,true,false)};e.updateAddToProjectSubmitButtonToUpgrade=function(f){d(f,false,false,false,true)};e.getCustomerSubscriptionTier=function(){return parseInt(a("#project-choose").data("customerSubscriptionTier"),10)};e.selectTab=function(f){a(f.toLowerCase()+"-tab").click()};e.updateSampleImageUrl=function(l,p,k,m,r,g,n,i,h,j,o,f){var q=FontPreview.GetFrsImageUrl(l,p,k,m,r,g,n,i,h,j,o,f);if(q==""){q="/Content/img/not-found.gif"}if(Common.isNumeric(m)){a("#product-"+p+"-sample-"+l+"-image").attr("width",m)}a("#product-"+p+"-sample-"+l+"-image").attr("src",q)};e.updateSampleImage=function(k,j){var o=a("input[name=ImageType]",j).val();var r=a("input[name=ProductId]",j).val();var n=a("select[name=FrsVariationId]",j).val();var p=a("input[name=image-text]",j).val();var s=a("textarea[name=sample-text]",j);var t=s.val();var f=s.data("char-coverage");var g=a("select[name=CodePage]",j).val();var q=a("input[name=IsFullImage]",j).val();var i=a("input[name=colorpicker-foreground]",j).val();var h=a("input[name=colorpicker-background]",j).val();var m=a("select[name=font-size]",j).val();if(typeof n=="undefined"){n=a("input[name=FrsVariationId]",j).val()}var l=[];a(".search-featuredicons li.feature-active a").each(function(v,u){l.push(a(u).data("ot-feature"))});FontPreview.SaveDefaultPreviewText(t);if(a("input[name=colorpicker-foreground]",j).length>0){FontPreview.SavePreviewImageTextColor(i)}if(a("input[name=colorpicker-background]",j).length>0){FontPreview.SavePreviewImageBackgroundColor(h)}if(a("select[name=font-size]",j).length>0){FontPreview.SavePreviewImageFontSize(m)}if(a(".search-featuredicons li a").length>0){FontPreview.SavePreviewImageOtFeatures(l)}e.updateSampleImageUrl(o,r,n,p,t,g,q,i,h,m,l,f)};e.updateWebFontSample=function(i,h){var g=a("input[name=colorpicker-foreground]",h).val();var f=a("input[name=colorpicker-background]",h).val();var j=a("select[name=font-size]",h).val();a(".web-fonts-preview textarea, #font_feature_sample, #advPreviewDiv").css({"background-color":"#"+f,color:"#"+g,"font-size":j+"px"});i.preventDefault()};e.attachTextSubmitListeners=function(){a(".products-sample-images").bind("submit",function(f){var g=a(".sample-text",a(f.currentTarget)).val();a(".products-sample-images").each(function(){a(".sample-text",a(this)).val(g);e.updateSampleImage(f,this);f.preventDefault()})});a(".products-sample-images input, .products-sample-images select").bind("change",function(f){e.updateSampleImage(f,a(this).closest(".products-sample-images"));f.preventDefault()});a(".products-sample-images textarea").bind("input",function(f){var g=a(f.currentTarget).val();a(".products-sample-images").each(function(){a(".sample-text",a(this)).val(g);e.updateSampleImage(f,this);f.preventDefault()})});a(".products-webfont-sample input, .products-webfont-sample select").bind("change",function(f){e.updateWebFontSample(f,a(this).closest(".products-webfont-sample"))});a(".products-webfont-waterfall").bind("submit",function(f){var g=a("textarea[name=sample-text]",this).val();e.updateWebFontsWaterfall(g);f.preventDefault()});a(".web-fonts-preview textarea").bind("input",function(f){var g=a(this).val();e.updateWebFontsWaterfall(g);f.preventDefault()});a("#browserPreviewPager input[name=browser-preview-next]").bind("click",function(f){a("#browser-list-request-form input[name=preselectOnReload]").val("first");e.moveSelectOption(a("#browserSelector select"),a("#osSelector select"),"next")});a("#browserPreviewPager input[name=browser-preview-previous]").bind("click",function(f){a("#browser-list-request-form input[name=preselectOnReload]").val("last");e.moveSelectOption(a("#browserSelector select"),a("#osSelector select"),"prev")})};e.updateWebFontsWaterfall=function(f){if(f===""){f=a(".products-webfont-waterfall").attr("data-default")}f=f.replace(/\n/g,"<br />");a(".webfont-waterfall-sample").each(function(){a(this).html(f)});a(".web-fonts-preview textarea").val(f);a(".products-webfont-waterfall textarea").val(f);FontPreview.SaveDefaultPreviewText(f)};e.moveSelectOption=function(j,h,f){var k=j.children("option:selected");var g=(f=="next")?"last":"first";if(k.val()==j.children("option:"+g).val()){if(h==null){var i=(f=="next")?"first":"last";j.children("option:"+i).attr("selected","selected")}else{e.moveSelectOption(h,null,f)}}k[f]("option").attr("selected","selected");j.change();j.selectbox("detach");j.selectbox("attach")};e.changeSelectOption=function(f,g){f.val(g);f.change();f.selectbox("detach");f.selectbox("attach")};e.updateCharacterMap=function(g){if(g!=""){a("#generated-character-map").html(g)}var h=a("#character-map-char-count-update").text();if(h!=""){a("#character-map-char-count").text(h)}var f=a("#character-map-code-range");var i=a("#character-map-code-range-update");if(i.html()!=""){f.selectbox("detach");f.html(i.html());f.find('option[value="'+i.data("range")+'"]').attr("selected","selected");f.selectbox("attach")}};e.updateBrowserList=function(f){a("#browserSelector").html(f);if(a("#browser-list-request-form input[name=preselectOnReload]").val()=="last"){a("#browserSelector option:last").attr("selected","selected")}a("#browserSelector select.adorn").selectbox();a("#browser-preview-image-request-form").submit()};e.updateBrowserPreviewImage=function(f){a("#browserPreviewImage").html(f);a("#browserPreviewImage").hideLoading()};e.setOpenTypeVariationsList=function(g,f){window.location.href=window.location.pathname+"?var="+g};e.AddWebFontToProjectComplete=function(){a("aside.pricing").hideLoading()};e.ShowSubmitSpecimenDialogForm=function(g){a(".carousel .form-container").html(g);var i=a("#specimen-upload-form");var h=a("#specimen-upload-form form");var l=a("#submit-specimen-dialog");var f=a("#specimen-upload-accept");var m=a("input[data-fileupload=file]",a("#thumbnail"));Fonts.Fileuploader.ClearFileField(m);a(l).lightbox_me({destroyOnClose:true});var n=Fonts.Fileuploader.CreateFileUploader("thumbnail",Fonts.Urls.addSpecimenImageThumb(),false,function(){i.showLoading()},function(o){if(o.Success){i.hide();f.html(o.AcceptDialogHtml);f.show();Fonts.Fileuploader.ClearMessagesContainer(l)}else{a(".messages-container",l).html(o.Messages)}Fonts.Fileuploader.ClearFileField(m);i.hideLoading()},"json");var j=a("input[data-fileupload=file]",a("#image"));Fonts.Fileuploader.ClearFileField(j);var k=Fonts.Fileuploader.CreateFileUploader("image",Fonts.Urls.addSpecimenImage(),false,function(){i.showLoading()},function(o){Fonts.Fileuploader.ClearFileField(j);i.hideLoading();if(o.Success){if(Fonts.Fileuploader.FileSelected(m)){n.submit()}else{i.hide();f.html(o.AcceptDialogHtml);f.show();Fonts.Fileuploader.ClearMessagesContainer(l)}}else{a(".messages-container",l).html(o.Messages)}},"json");h.submit(function(o){if(h.valid()){k.setData(Fonts.Fileuploader.SetData(h));k.submit()}o.preventDefault();return false})};e.OnSuccessAcceptSpecimenImage=function(f){if(f.Success){a("#specimen-upload-form").show();a("#specimen-upload-accept").hide()}a(".messages-container",a("#submit-specimen-dialog")).html(f.Messages);e.HideAcceptSpecimenImageLoading()};e.ShowAcceptSpecimenImageLoading=function(){a("#specimen-accept-form").showLoading()};e.HideAcceptSpecimenImageLoading=function(){a("#specimen-accept-form").hideLoading()};e.RejectSpecimenImage=function(){a("#specimen-upload-form").show();a("#specimen-upload-accept").hide()};e.AttachFontFeaturesRollovers=function(){a("#features-list li a").mouseenter(function(g){f("#features-list",false)});a("#opentype-features-list li a").mouseenter(function(g){f("#opentype-features-list",true)});function f(g,h){if(!c&&typeof currentPage.ProductUrlKey!=="undefined"&&currentPage.ProductUrlKey!=""){c=true;var i=a(this).data("selected-variation-id");a.post(Fonts.Urls.fontFeaturesRolloversUrl(),{urlKey:currentPage.ProductUrlKey,variationId:i,renderOnlyFrsSupportedFeatures:h},function(j){a(g).replaceWith(j);BindTextPopperHover(a(".textpopper",g));c=false})}}};e.UpdatePromotionCounter=function(g){var h=new Date(g);var i=new Date();var f=new Date(h-i);var l=Math.floor(f/1000)%60;var k=Math.floor(f/(1000*60))%60;var j=Math.floor(f/(1000*60*60));if(f<=0){document.location.reload()}a("#promotionHours").html(j<10?"0"+j:j);a("#promotionMinutes").html(k<10?"0"+k:k);a("#promotionSeconds").html(l<10?"0"+l:l)};e.StartPromotionCounter=function(f){e.UpdatePromotionCounter(f);window.setInterval("Fonts.Products.UpdatePromotionCounter("+f+")",1000)};var b=function(){Fonts.UI.asideProductVariationSelects("#product-variation-select, #webfont-variation-select");Fonts.UI.productVariationSelects();Fonts.UI.bindStylePrice()};b();return e}(jQuery));Fonts.Families=(function(a){var b={};b.AttachSearchListItemHowerFunctionality=function(){var f="font-mouseover",d="mouseenter",e="mouseleave",c=a(".font-results-parent, .font-child");c.off(d).on(d,function(){a(this).addClass(f)}).off(e).on(e,function(){var g=a(this);if(!g.has(".dropdown:visible").length){g.removeClass(f)}})};b.AttachOnProductVariationChangeEventHandler=function(c){c.find('select[name="VariationId"]').change(function(){var d=a(this).closest("form"),g=a(this).val(),e=Fonts.CartSummary.GetAddedProductVariationsToCart(),f=a.inArray(g,e)>-1;Fonts.Families.updateFeatureUpgradeDialog(g);Fonts.CartSummary.ManageAddToCartButtons(d,!f,f,false)})};b.AttachAttribute=function(c){a.each(c,function(){c.attr("data-load-locally","true")})};b.OnFeatureUpgradePopup=function(d){if(d.length!==0){var c=a(d);c.lightbox_me({onLoad:function(){BindTextPopperHover(c.find(".textpopper"));var e=a(".opent-type-selected-action");if(e){e.click(function(){var g=a(this).data("variation-id");var f=a(this).data("cart-identifier");Fonts.Families.setOpenTypeVariationsList(g,f)})}},destroyOnClose:true})}};b.AttachIconEvents=function(d){var h=a("#search-form-webicon-popup"),f=0,e=a("#search-form-desktopicon-popup"),c=function(i){clearTimeout(f);f=setTimeout(function(){i.hide()},2000)},g=function(i,m){var l=i.offset(),j=i.outerHeight(true),n=l.top-m.parent().offset().top+j+18,k=l.left-m.parent().offset().left-20;clearTimeout(f);m.css({top:n+"px",left:k+"px"}).fadeIn("fast")};a("a.product-web-link",d||a(document)).mouseenter(function(){e.hide();g(a(this),h)}).mouseleave(function(){c(h)});a("a.product-desktop-link",d||a(document)).mouseenter(function(){h.hide();g(a(this),e)}).mouseleave(function(){c(e)})};b.AttachSearchListItem=function(c){b.AttachIconEvents();a.each(c,function(){var d=a(this);d.closest("li").find("a.product-count").click(function(){d.click()});d.closest("li").find("button#search-skyfonts-expand-family").click(function(e){d.click();e.preventDefault()});a(this).data("dataloaded",false)});c.toggle(function(){var p=a(this),f=p.next().next(),q=p.find("input.font-selected-wishlist-id").val(),h=p.find("input.font-family-id").val(),i=p.find("input.font-family-url-key").val(),o=p.find("input.font-family-query-font-type").val(),k=p.data("dataloaded"),l=p.data("isWebFontsTab"),n,d,r,g,j,m=p.parents("li").find("a.product-count"),e=p.closest("li").find("button#search-skyfonts-expand-family");p.children().children("b.toggle-label").text(Fonts.Translations.getHideLabel());p.removeClass("results-hidden");f.show();if(typeof l==="undefined"){l="false"}if(!k){p.find("a").showLoading();if(m.length!==0){a(m).showLoading()}if(e.length!==0){a(e).showLoading()}n=window.location.pathname,d=/\/search\/wish-lists/.test(n)?Fonts.Urls.getWishListProductsAddress():/\/search/.test(n)?Fonts.Urls.searchFamilyProductsAddress():Fonts.Urls.familyProductsAddress(),r=a("#ShowAllFontsRadioButton").is(":checked"),g=a("#DefaultTextIndex").val()||"",data={};data.familyId=h;data.showFree=a("#ShowWebFontFreeRadioButton").is(":checked");data.onlyWebFonts=l;data.urlKey=i;data.defaultText=g;data.selectedWishListId=q;data.queryFontType=o;data.searchtext=a("#searchtext").val();data.SearchType=a("#SearchType").val();data.sourceUrl=a("#browse-products-form").attr("action");data.onlyDesktopFonts=a("#ShowWebFontDesktopRadioButton").is(":checked");a("#refinements-container").find("p.refine-refinement:not(.default-refine):visible").each(function(){c=a(this);select=c.find(':input[name$="Criteria"]');input=c.find(':input[name$="Value"]');key=select.val();val=input.val();if(!val){val=""}if(key&&val){data[key]=val}});a.ajax({url:d,type:"GET",data:data,cache:false,success:function(s){f.html(s);b.AttachSearchEvents(f,true);b.AttachIconEvents(f);WebFontsPlansFree.BindSelectFreeSubscriptionInList(f);p.find("a").hideLoading();if(m.length!==0){m.hideLoading()}if(e.length!==0){e.hideLoading()}a.waypoints("refresh")}})}p.data("dataloaded",true)},function(){a(this).children().children("b.toggle-label").text(Fonts.Translations.getShowLabel());a(this).addClass("results-hidden");var d=a(this).next().next();d.hide();a.waypoints("refresh")})};b.AttachSearchEvents=function(c,e){var d=c.find("#fonts-face-declaration");if(d.length==0){d=c.filter("#fonts-face-declaration")}if(d.length){Fonts.FontFace.addWebfontCss(d.text());d.remove()}Fonts.WebFontManager.StartWebFontsListener(c);c.find("input.show-me").show();c.find("select.adorn").selectbox();Fonts.UI.AttachAddToWebFontDropDownsEvents(c);Fonts.WebFontDropdown.AttachAddToWebFontEvents(c.find("div.add-to-web-fonts select.add-to-project-font-selector"));FontPreview.BindEvents();Fonts.Families.AttachSearchListItemHowerFunctionality();Fonts.Families.AttachSignInEvents(c);Fonts.UI.productVariationSelects(c);Fonts.UI.wishListDropDowns(c);Fonts.Dropdowns.AttachAllDropdowns(c);Fonts.Account.AttachEventsToMemberSigninForSelector(c.find("a.password-reset-link-trigger"));Fonts.Families.AttachOnProductVariationChangeEventHandler(c);Fonts.Account.AttachEventsToSigninFormsTriggers();a(c.find("div.resetable-sing-in-block .trigger")).click(function(){Fonts.Account.RestoreMemberSigninForm()});if(e){Fonts.Scrolling.ResetWaypoints()}};b.updateFeatureUpgradeDialog=function(c){a("div.opentype-options div.options-selector").each(function(){var d=a("a.opent-type-selected-action",a(this));var e=a("span.input-appr",a(this));if(d.data("variation-id")==c){d.hide();e.show()}else{d.show();e.hide()}})};b.setOpenTypeVariationsList=function(g,c){var d=a("form[data-addtocartidentifier="+c+"]"),e=d.find('select[id$="-variation-select"]');if(e.length==0){e=a("#webfont-variation-select")}if(e){var f=e.children("option[value="+g+"]").text();Fonts.Families.updateFeatureUpgradeDialog(g);e.selectbox("change",g,f)}a("#feature-upgrade-dialog .close").click()};b.renderKeywordMessages=function(c){var d={container:a(".add-keyword-form .messages-container"),data:c.Messages};if(!c.Success){d.removeAfter=-1}Fonts.UI.ShowAndRemove(d)};b.showSubsciptionPlanDialog=function(c){a(c).showLoading();a("#select-a-subscription-dialog").remove();a.ajax({url:Fonts.Urls.getSubscriptionPlanDialog(),success:function(d){var e=a(d);e.lightbox_me({destroyOnClose:false,onLoad:function(){WebFontsPlans.setPaymentFrequency();WebFontsPlans.bindChangePlanEvent();WebFontsPlans.init();a("#select-a-subscription-container").bind("subscription_finished",function(){e.trigger("close")})}})},complete:function(){a(c).hideLoading()}})};b.AttachSignInEvents=function(c){var d=c.find(".web-fonts-sign-in");if(d.length==0){d=c.filter(".web-fonts-sign-in")}d.click(function(){var f=a(this).parent("form");var e=f.find('input[name="returnUrl"]');e.val(window.location);f.submit()})};b.OnSuccessRateFamily=function(c){Fonts.UI.ShowAndRemove({container:"#user-messages",data:c.Messages,removeAfter:(c.Success?null:-1)})};return b}(jQuery));Fonts.Spinner=(function(a){var b={};var c=0;var d;var e=20;b.enableSpinners=function(){var f=b.countActiveSpinners();if(f>0){window.clearInterval(d);d=window.setInterval(function(){b.spinSpinner()},100)}};b.disableSpinners=function(){var f=b.countActiveSpinners();if(f==0){window.clearInterval(d)}};b.spinSpinner=function(){var f=c*e;if(f!==0){f=f*-1}a(".loading-indicator").css("background-position",f+"px 0");a(".loading-indicator-inverse").css("background-position",f+"px 20px");if(c==11){c=0}c++};b.countActiveSpinners=function(){var f=a(".loading-indicator-inverse:visible").length;if(typeof f=="undefined"){f=0}return f+a(".loading-indicator").length};b.showSpinner=function(f){a(f).show();b.enableSpinners()};b.hideSpinner=function(f){a(f).hide();b.disableSpinners()};return b}(jQuery));WebFontsPlansFree=(function(a){var c={};var b=false;c.AddToCartCheck=function(d,e,i,f,h){i();var g;if(e!=null&&e.length==1){e.find("#ActionSubscriptionTier").val(d.attr("data-subscription-tier"));g=function(){e.submit();a("#select-a-subscription-container").trigger("subscription_finished")}}else{g=function(){}}a.ajax({type:"POST",url:SiteUrls.getAddToCartCheck(),data:h?h:e.serialize(),dataType:"json",async:false,success:function(j){if(j.Success){if(j.ShowDialog){var k=a(j.DialogHtml);k.lightbox_me({onLoad:function(){a("#downgrade-continue").click(function(){g();k.trigger("close")});if(j.IsCreateFreePlanDialog){a("#create-free-account-form").updateValidation();Fonts.UI.BindJsonpFormSubmitEvents(k)}},onClose:function(){if(j.IsCreateFreePlanDialog&&b){window.location.reload()}},destroyOnClose:true})}else{g()}}else{a("#default-user-messages-container").replaceWith(j.Messages)}},complete:function(){f()}})};c.BindSelectFreeSubscription=function(){var d=a("#free-plan");a("#free-plan .select-subscription-button").click(function(g){g.preventDefault();var f=a(this);c.AddToCartCheck(f,a("#plans-and-pricing-form"),function(){d.showLoading()},function(){d.hideLoading()})});a("#start-free-plan-button").click(function(f){f.preventDefault();a("#start-free-plan-form").submit()});c.BindSelectFreeSubscriptionInList();a(".btn-free-webfonts").click(function(g){g.preventDefault();var f=a(this);var h=f.css("z-index");c.AddToCartCheck(f,null,function(){f.css("z-index",1);a("body").showLoading()},function(){f.css("z-index",h);a("body").hideLoading()},{actionSubscriptionTier:f.data("subscription-tier")})});a(".dbcms-content form button.select-subscription-button").click(function(h){h.preventDefault();var f=a(this);var g=f.parent();var i=g.find('input[name="ActionSubscriptionTier"]').val();WebFontsPlansFree.AddToCartCheck(f,null,function(){g.showLoading()},function(){g.hideLoading()},{actionSubscriptionTier:i})})};c.BindSelectFreeSubscriptionInList=function(e){var d=e?e.find(".create-free-plan button.select-subscription-button"):a(".create-free-plan button.select-subscription-button");d.click(function(h){h.preventDefault();var f=a(this);var g=f.parent();c.AddToCartCheck(f,null,function(){g.showLoading()},function(){g.hideLoading()},{actionSubscriptionTier:f.data("subscription-tier")})})};c.BeforeCreateFreePlan=function(){var d=a("#free-plan-eula");if(d.length==0||d.length==1&&Fonts.Account.CheckEulaCheckbox(d,"create-free-account-form")){a(".modal-content").showLoading();return true}return false};c.OnSuccessCreateFreePlan=function(d){if(!d.Success&&d.ErrorMessage){var f=new UserMessages(a,"create-free-account-form .messages-container");f.clearErrors();f.addError(d.ErrorMessage)}else{a(".modal").html(a(d.Html).html());b=b|d.ReloadPageAfterDialogClose;var e=a("#create-free-account-form");if(e.length>0){e.updateValidation();Fonts.UI.BindJsonpFormSubmitEvents(a(".modal"))}else{window._gaq.push(["_trackEvent","WFS_Signup","Free"])}}};c.init=function(){c.BindSelectFreeSubscription()};return c}(jQuery));$(function(){WebFontsPlansFree.init()});Fonts.WebFontDropdown=(function(a){var b={};b.AddWebFontToProject=function(h){if(h){var c=a("#add-to-project-"+h.ContainerId),f=new UserMessages(jQuery,"messages-"+h.ContainerId),d=a("#product-name-"+h.FontId,c).first().val();if(!d){d=""}var g=a("option[value='"+h.ProjectId+"']",c).first().text();var e=a.format(h.Message,d,g);Fonts.UI.updateWebFontProjectDropDowns(h);if(h.Success){c.parents(".modal-content").children("#hasChanges").val("1");f.singleSuccess(e)}else{if(h.Warning){f.singleCaution(e)}else{f.singleError(e)}}}};b.AddAllFamilyWebFontsToProject=function(g){if(g){var c=a("#add-to-project-family-"+g.FamilyId),e=new UserMessages(jQuery,"messages-add-to-project-family-"+g.FamilyId),f=a("option[value='"+g.ProjectId+"']",c).first().text(),d=a.format(g.Message,f);Fonts.UI.updateWebFontProjectDropDowns(g);if(g.Success){e.singleSuccess(d)}else{if(g.Warning){e.singleCaution(d)}else{e.singleError(d)}}}};b.AttachAddToWebFontEvents=function(c){if(c){a(c).change(function(){var e=a(this).parents(".dropdown-inner");var f=parseInt(a(this).find(":selected").data("tier"),10);var d=parseInt(e.parents(".add-to-web-fonts").find("#customer-subscription-tier").val(),10);if(d>=f){e.find(".add-to-web-font-button").show();e.find(".add-to-web-font-upgrade-button").hide()}else{e.find(".add-to-web-font-button").hide();e.find(".add-to-web-font-upgrade-button").show()}})}};b.dropdownClose=function(){a('[id^="add-to-project"]:visible').toggle();a(".with-dropdown.active").removeClass().addClass("with-dropdown")};return b}(jQuery));$(document).ready(function(){Fonts.WebFontDropdown.AttachAddToWebFontEvents($(".add-to-web-fonts .add-to-project-font-selector"));Fonts.UI.AttachAddToWebFontDropDownsEvents()});Fonts.WishListDropdown=(function(a){var b={};b.AddToWishListSubmit=function(d){var c=a(d).parents("form:first");var e=b.GetClosestSelectedProductVariationId(c);c.find("input[name=VariationId]").val(e);c.submit()};b.GetClosestSelectedProductVariationId=function(d){var c=d.find("input[name=DefaultVariationId]:first");while(d.parent().length>0){d=d.parent();var e=d.find("select[name=VariationId]:first");if(e.length>0){return e.val()}if(a(d).hasClass("font-results-parent")||a(d).hasClass("font-child")){return 0}}return c.length>0?c.val():0};b.AddToWishListSuccess=function(d){if(d){var c=new UserMessages(jQuery,"messages-"+d.ContainerId);if(d.Success){c.singleSuccess(d.Message)}else{if(d.IsWarningMessage){c.singleCaution(d.Message)}else{c.singleError(d.Message)}}}};b.CreateAndAddToWishListSuccess=function(e){if(e){var d=new UserMessages(jQuery,"messages-"+e.ContainerId);var c=a("#"+e.ContainerId);if(e.WishListSelectHtml){c.find("input.new-wishlist-name").val("");Fonts.UI.updateWishListDropDowns(e)}if(e.Success){d.singleSuccess(e.Message)}else{if(e.IsWarningMessage){d.singleCaution(e.Message)}else{d.singleError(e.Message)}}}};return b}(jQuery));$(function(){Fonts.UI.wishListDropDowns()});Fonts.FontFace=(function(a){return{addWebfontCss:function(c){var d=0,g="webfont-style-"+d,e,f,b=a.trim(c);if(!b){return}while(a("#"+g).length>0){d++;g="webfont-style-"+d}e=a('<style type="text/css" id="'+g+'"></style>').appendTo("head");f=e.get(0);if(f&&f.styleSheet){f.styleSheet.cssText=b}else{e.text(b)}}}}(jQuery));Fonts.WebFonts=(function(a){var h={};var c=null;var g={clearAll:function(i){if(typeof i==="string"&&typeof this[i]==="object"&&typeof this[i].clearAll==="function"){this[i].clearAll()}},routeMessage:function(m,i,j){if(typeof i!=="string"||i===""){return}var l=this;function n(){if(typeof j!=="string"||j===""){if(l["default"]===undefined){l["default"]=Fonts.Messages}return l["default"]}if(l[j]===undefined){l[j]=new UserMessages(jQuery,j)}return l[j]}var k=n();if(m==="success"){k.singleSuccess(i)}else{if(m==="error"){k.singleError(i)}else{if(m=="warning"){k.singleCaution(i)}}}}};function d(k){var j=a("#"+k+"-d");var i=j.html()||"";i=i.replace(/&amp;/ig,"&");j.remove();return i}function e(k){a("#try-it-out").showLoading();var l=a("#advPreviewDiv"),i=l.data("ot-js-id"),m=l.data("font-id"),j=l.data("win-menu-name");LoadAllFeatures(i,m,j,function(n){var o=a(a("#dev-opentype-features").html());o.find("li").each(function(){var p=a(this),s=p.attr("id"),q,r;if((a.inArray(s,currentFeatures)===-1)||(n.indexOf(s)!==-1)){p.addClass("dev-remove")}else{q=p.find("img"),r=q.data("src");q.attr("src",r||"").removeAttr("data-src")}}).filter(".dev-remove").remove();o.appendTo("#dev-opentype-features-container");if(typeof k==="function"){k(o)}a("#try-it-out").hideLoading()})}function f(i){if((i instanceof (jQuery))&&i.length){window.jsParentDirectory=i.data("otf-js-url")}}h.manageCheckBoxesUI=function(j,i){a(j).live("change",function(){var l=a(this).is(":checked"),m=a(i),k=a(m).is(":checked");if(!l){if(k){a(m).attr("checked",false)}}if(a(j+":not(:checked)").size()===0){a(m).attr("checked",true)}});a(i).change(function(){a(j).attr("checked",a(this).is(":checked"))})};h.getWebFontsResponseHeader=function(k){function i(){return"X-WebFonts-Response-Context"}var j=k.getResponseHeader(i())||null;return j?a.parseJSON(decodeURIComponent(j)):null};h.updateUnobtrusiveValidation=function(i){a.validator.unobtrusive.parse(i)};h.EnsureAllVisibleWebFontDeclarations=function(){var i=[];a(".web-fonts-preview").each(function(){var k=a(this);var j=d(k.attr("id"));i.push(j)});a(".font-face-declaration").each(function(){i.push(a(this).html().replace(/&amp;/ig,"&"))}).remove();Fonts.FontFace.addWebfontCss(i.join("\r\n"))};h.OnSignIn=function(i){Fonts.Messages.clearAll();if(i.Success){window.location.reload()}else{Fonts.Messages.addError(i.Message)}};h.OnPublishSettingsPopup=function(j){if(j){var i=a(j);i.lightbox_me({onLoad:function(){i.find(".link-action").click(function(){a(this).parent().find("textarea").focus().select()});Fonts.UI.tabSortSwitcher(a("ul.sort li"));var k=new UserMessages(jQuery,"publish-settings-messages");i.find("#download-kit-nofonts").click(function(){k.singleError(a(this).data("message"))});i.find("#download-kit").click(function(){var l=a(this).data("checkUrl");var m=a(this).data("actionUrl");a.ajax({type:"POST",url:m,beforeSend:function(){i.find("#download-kit").hide();i.find("#download-kit-working").show();i.find("#download-kit-loading").showLoading()},success:function(n){if(n.Status==="generated"){i.find("#download-kit").show();i.find("#download-kit-working").hide();i.find("#download-kit-loading").hideLoading();i.find("[name=download-kit-iframe]").attr("src",n.FileUrl)}else{if(n.Status==="in_progress"){b(l,function(o,p){k.singleSuccess(p);i.find("#download-kit").show();i.find("#download-kit-working").hide();i.find("#download-kit-loading").hideLoading();i.find("[name=download-kit-iframe]").attr("src",o)},function(o){k.singleError(o);i.find("#download-kit").show();i.find("#download-kit-working").hide();i.find("#download-kit-loading").hideLoading()})}}if(n.Message!==""){if(n.Success){k.singleSuccess(n.Message)}else{k.singleError(n.Message)}}},error:function(){i.find("#download-kit").show();i.find("#download-kit-working").hide();i.find("#download-kit-loading").hideLoading();k.singleError(Fonts.Translations.getErrorMessage())}})})},onClose:function(){if(c!==null){clearTimeout(c)}i=null},destroyOnClose:true})}};h.clearAddNewDomainMessages=function(){var j=new UserMessages(jQuery,"domain-list-user-messages");if(j.length!==0){j.clearAll()}var i=a("#form-add-new-domain");if(i.length!==0){i.validate().resetForm();i.find("[data-valmsg-summary=true]").removeClass("validation-summary-errors").addClass("validation-summary-valid").find("ul").empty();i.find("[data-valmsg-replace]").removeClass("field-validation-error").addClass("field-validation-valid").empty()}};function b(k,i,j){c=setTimeout(function(){a.ajax({type:"POST",url:k,success:function(l){if(l.Status==="generated"){i(l.FileUrl,l.Message)}else{if(l.Status==="not_generated"&&l.Success){j(l.Message)}else{b(k,i,j)}}},error:function(){b(k,i,j)}})},5000)}h.OnProjectPublished=function(i){if(i){if(i.Success){Fonts.Messages.singleSuccess(i.Message);a("#"+i.ProjectId).replaceWith(a(i.Html));a("#"+i.ProjectId).find(".accord-bar").click(function(j){Fonts.UI.accordBarExpandCollapseHandling(this);j.preventDefault()})}else{Fonts.Messages.singleError(i.Message);h.ReloadWebProject(i.ProjectId)}}};h.EditFontsTabsNavigation=function(i,j,m,k){var l=a(i);l.hide().filter(":first").show();a(j).click(function(n){n.preventDefault();if(!a(this).hasClass(m)){l=a(i);l.hide();l.filter(this.hash||a(this).data("link")).fadeIn(500);a(j).removeClass(m);a(this).addClass(m);if(k){k(a(this))}return false}})};h.createOpenTypeFeatureCss=function(r){if(r.length>0){var n="-moz-font-feature-settings : '";var o="-moz-font-feature-settings : ";var u="-webkit-font-feature-settings : ";var p="-ms-font-feature-settings : '";var q="font-feature-settings : ";var s="-o-font-feature-settings : ";var j=false;for(var m=0;m<r.length;m++){var l=r[m].split("_");var k=l[0];var t=l[1]||1;if(k=="calt"){j=true}u+='"'+k+'" '+t;q+='"'+k+'" '+t;s+='"'+k+'" '+t;n+=k+"= "+t;o+='"'+k+'" '+t;p+=k+"= "+t;if(m!=(r.length-1)){p+=",";u+=",";n+=",";o+=",";s+=",";q+=","}else{if(j){s+=";";q+=";";u+=";";n+="';";o+=";";p+="';"}else{s+=',"calt" 0;';q+=',"calt" 0;';u+=',"calt" 0;';n+="','calt=0';";o+=',"calt" 0;';p+="','calt=0';";j=false}}}return n+"\n"+o+"\n"+u+"\n"+p+"\n"+s+"\n"+q}else{return""}};h.TurnOnOTF=function(i,k,j){var l="font-family: '"+j+"';";if(k.length>0){l+="\n"+h.createOpenTypeFeatureCss(k)}a(i).attr("style",l);ApplyFeaturesForElementsByStyle(i)};h.initOpenTypeFeaturesTab=function(R,F){var S=R.data("targetProjectId");var I=function(){var Z=R.find(".selectors-listing > ul > .active-selector").first();if(Z.length==0){return null}else{return Z}};if(R.find("#features_tab").length>0){var y=R.find("#selector");y.autocomplete({serviceUrl:SiteUrls.getOtSelectors(),minChars:1,params:{projectId:S},onSelect:function(ab,aa){var Z=I();if(Z!=null){Y(Z)}a('.selectors-listing > ul > li[data-selector="'+ab+'"] > div').trigger("click")}});var x=a("#font_feature_sample");var G=a("#font_feature_sample_input");var H=R.find("#fontSelector");var L=R.find("#features-list");var i=R.find("span.active-selector");var C=G.val();var W=function(){var Z=[];L.find(".feature-active").each(function(){Z.push(a(this).attr("id"))});x.html(G.val());var aa=H.find("option:selected").data("win-menu-name");h.TurnOnOTF(x,Z,aa)};var V=function(Z){R.find(".features-content .with-popup > li").each(function(){var aa=a(this).attr("id");if(Z.indexOf(aa)!=-1&&(a(this).is(":visible"))){a(this).addClass("feature-active")}else{a(this).removeClass("feature-active")}});W()};var Y=function(Z){V("");Z.removeClass("active-selector");i.hide();W();L.hide()};y.on("change",function(){var Z=I();if(Z!=null){Y(Z)}});var Q=function(){var ac=H.find("option:selected");if(ac.length>0&&ac.attr("value")!="0"){var ab=ac.data("ot-js-id");var ad=ac.attr("value");var aa=ac.data("win-menu-name");var Z=R.children().first();Z.showLoading();LoadAllFeatures(ab,ad,aa,function(ah){R.find("#features-list li").each(function(){var aj=a(this).attr("id");if((a.inArray(aj,currentFeatures)!=-1)&&(ah.indexOf(aj)==-1)){a(this).show()}else{a(this).removeClass("feature-active");a(this).hide()}});var ae=I();if(ae!=null){var af=ae.data("fontid");var ai=ae.data("saved-otf");if(ai==null){ai=""}var ag=false;if(af!=ad){Fonts.UI.Confirm(H.data("title"),H.data("message"),H.data("confirmText"),H.data("cancelText"),function(){ag=true;T(null);ae.data("fontid",ad);W()},function(){if(!ag){Y(ae)}});g.clearAll("edit-fonts-messages")}else{V(ai);W()}}else{W()}Z.hideLoading()})}};H.selectbox({onChange:function(aa,Z){Q()}});var T=function(ab){var aa=I();var Z=H.find("option:selected");if(aa!=null&&Z.length>0){if(ab){ab.showLoading()}var ae=aa.data("selector");var ac=Z.attr("value");var ad="";R.find(".feature-active:visible").each(function(){ad+=a(this).attr("id")+","});a.post(SiteUrls.updateSelectorOtf(),{projectId:S,fontId:ac,selector:ae,openTypeFeatures:ad},function(af,ai,aj){if(ab){ab.hideLoading()}R.find("#hasChanges").val("1");var ah=h.getWebFontsResponseHeader(aj);if(ah){g.routeMessage(ah.type,ah.message,"edit-fonts-messages");var ag=ah.otf;V(ag);aa.data("saved-otf",ag)}})}};R.on("click.toogleclass",".selectors-listing > ul > li > div",function(){var aa=a(this).closest("li");aa.toggleClass("active-selector").siblings("li").removeClass("active-selector");if(aa.hasClass("active-selector")){L.show();var ac=a(this).html();i.html(ac);i.show();R.find("#selector").val(ac);var Z=aa.data("fontid");var ab=H.find("option[value="+Z+"]");if(!ab.is(":selected")){H.selectbox("change",Z,ab.html())}else{Q()}}else{L.hide();i.hide()}});R.on("click",".remove-selector",function(){var ab=a(this).closest("li");var Z=a(this).closest("ul");var aa=ab.data("selector");Z.showLoading();a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:SiteUrls.detachProjectSelector(),data:JSON.stringify({ProjectId:S,SelectorId:"",Selector:aa,FontId:0}),success:function(ac){R.find("#hasChanges").val("1");Z.hideLoading();if(ac.success){ab.remove();if(I()==null){L.hide();i.hide()}}Z=null},complete:function(){if(Z!=null){Z.hideLoading()}}})});L.find("li").on("click",function(){var aa=I();var Z=H.find("option:selected");if(aa!=null&&Z.length>0){a(this).toggleClass("feature-active");T(a(this))}});R.find(".remove-all-feat").on("click",function(){if(I()!=null){R.find(".feature-active").removeClass("feature-active");T(a(this))}});R.find(".apply-all-feat").on("click",function(){if(I()!=null){R.find(".features-content .with-popup > li:visible:not(.feature-active)").addClass("feature-active");T(a(this))}});R.find("#remove-all").on("click",function(){var Z=a(this).closest("div");Fonts.UI.Confirm(a(this).data("title"),a(this).data("message"),a(this).data("confirmText"),a(this).data("cancelText"),function(){var aa=R.find(".selectors-listing > ul > li");var ab="";aa.each(function(){ab+=a(this).data("selector")+","});Z.showLoading();a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:SiteUrls.detachProjectSelectors(),data:JSON.stringify({ProjectId:S,Selectors:ab}),success:function(ac){R.find("#hasChanges").val("1");if(ac.success){aa.remove();L.hide();i.hide()}},complete:function(){Z.hideLoading()}})})});G.on("keyup change input propertychange",function(){W()});R.find("#reset_text").on("click",function(){G.val(C);W()});BindTextPopperHover(a(".textpopper"));L.hide();i.hide();var U=function(aa,ab){var Z=aa.find("option[value='"+ab+"']");if(!Z.is(":selected")){aa.selectbox("change",ab,Z.html())}};var M=function(ae,af,ak,ai,aj){var ab=R.find("#"+ae);var ac=ab.find("input").first();var aa=function(an){return an.selectbox({onChange:function(ap,ao){if(ap=="00.0em"){ad.selectbox("detach");ad.hide();ab.show();ac.focus()}else{if(ao.isOpen&&aj){aj()}}}})};var ad=aa(R.find("#"+ak));var Z=a("#"+af);var am=function(ar,ao,an){var ap=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(ar);if(ap){var aq=parseFloat(ap);if(aq<=ao||aq>an){return false}else{return true}}return false};var al=function(ao,an){var ap=a(an).data("invalid-msg");ao.html("").append("<span>"+ap+"</span>");a(an).addClass("input-validation-error");ao.show()};var ah=function(ao,an){if(ao.is(":visible")){a(an).removeClass("input-validation-error");ao.html("").hide()}};var ag=function(ao){ab.hide();var an=ai();if(ao&&(an!=null)){ad.find("option:selected").removeAttr("selected");ad.find('option[value="'+an+'"]').attr("selected","selected")}ad=aa(ad);if(!ao&&aj){aj()}};ac.on("keydown",function(an){if(an.keyCode==27||an.keyCode==13){an.stopPropagation();return false}});ac.on("keyup",function(an){ah(Z,ac);if(an.keyCode==13){if(ab.is(":visible")){var ao=ac.val();var ar=am(ao);if(!ar){al(Z,this)}else{ad.find("option:selected").removeAttr("selected");var at=parseFloat(ao).toFixed(1)+"em";var aq=parseFloat(at);var ap=ad.find("option").filter(function(au){return parseFloat(a(this).attr("value"))==aq});if(ap.length==0){ad.append('<option selected ="selected" value="'+at+'" > '+at+"</option>")}else{ap.attr("selected","selected")}ag();Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures()}}}else{if(an.keyCode==27){an.stopPropagation();ag(true);return false}}});ac.on("blur",function(an){if(ab.is(":visible")){ah(Z,ac);ag(true)}});return ad};var K=function(){var ab=s.find("option:selected").attr("value");if(ab!="00.0em"){N=ab}var ac=t.find("option:selected").attr("value");if(ac!="00.0em"){O=ac}var aa=A.css("backgroundColor");var Z=j.find("option:selected").attr("value");return{fontSize:ab,lineHeight:ac,color:aa,alignment:Z,isUnderlined:X.hasClass("selected-item"),features:[]}};var s=M("advCustomFontSize","advSizeErrors","advFontSizeSelector",function(){return N},function(Z){z("fontSize",K().fontSize);setTimeout(function(){w.focus()},50)});var t=M("advCustomLineHeightSize","advLineHeightErrors","advLineHeightSelector",function(){return O},function(){Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures();setTimeout(function(){w.focus()},50)});var j=R.find("#advAlignSelector").selectbox({onChange:function(aa,Z){if(Z.isOpen){Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures();w.focus()}}});var A=R.find("#advColorPicker");A.ColorPicker({color:"#000000",onChange:function(aa,Z,ab){z("color","#"+Z);A.css("backgroundColor","#"+Z);Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures()},onHide:function(){setTimeout(function(){w.focus()},50)}});var q=R.find("#advFeaturesList");var u=R.find("#advPreviewDiv");var r=R.find("#advFontSelector");var v=R.find("#adv_font_feature_sample_input");var X=R.find("#advUnderlineBtn");var w=R.find("#adv_font_feature_sample_input_copy");var B=K();var D=function(){var ai=Fonts.advFontPreview.getLastTextSelection();var aj=Fonts.advFontPreview.getTextPropertiesByCharacter();var aa=K();var af=aa.fontSize;var Z=aa.color;var ah=aa.isUnderlined;if(ai.start!=aj.length){af=aj[ai.start].fontSize;Z=aj[ai.start].color;ah=aj[ai.start].isUnderlined}var ad=false;var ac=false;var ae=false;if(ai.length>0){for(var ag=ai.start+1;ag<ai.end;ag++){var ab=aj[ag];if(ab.fontSize!=af){ad=true}if(ab.isUnderlined!=ah){ae=true}if(ab.color!=Z){ac=true}}}if(ad){af=B.fontSize}if(ae){ah=B.isUnderlined}if(ac){Z=B.color}U(s,af);A.css("backgroundColor",Z);if(ah){X.addClass("selected-item")}else{X.removeClass("selected-item")}};Fonts.advFontPreview.init({advTextEditor:v,advTextEditorCopy:w,advFeatureIcons:q,advPreviewDiv:u,advResetText:R.find("#adv_reset_text"),updateUiBySelection:D,onReset:function(){s.selectbox("change","01.0em","1.0em");t.selectbox("change","01.5em","1.5em");j.selectbox("change","left",j.find('option[value="left"]').html());X.removeClass("selected-item");A.ColorPickerSetColor("000000")},getCurrentFontProperties:K,getFamilyName:function(){return r.find("option:selected").data("win-menu-name")}});var P=function(){var ac=r.find("option:selected");if(ac.length>0&&ac.attr("value")!="0"){var ab=ac.data("ot-js-id");var ad=ac.attr("value");var aa=ac.data("win-menu-name");var Z=R.children().first();Z.showLoading();LoadAllFeatures(ab,ad,aa,function(ae){R.find("#advFeaturesList li").each(function(){var af=a(this).attr("id");if((a.inArray(af,currentFeatures)!=-1)&&(ae.indexOf(af)==-1)){a(this).show()}else{a(this).hide()}});Z.hideLoading();if(w.is(":visible")){w.focus()}else{v.focus()}Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures();E()})}};var E=function(){D();Fonts.advFontPreview.displaySelectionAvailableFeatureIcons()};r.selectbox({onChange:function(aa,Z){P()}});var N=null;var O=null;var J=function(ah){var ae=r.find("option:selected").data("win-menu-name");var ad=K();var ai=Fonts.advFontPreview.getAdvTextPreviewProperties();var ab="";var Z="";if(ai.length>0){ab+=".class-with-otf-main { font-family: "+ae+"; line-height: "+ad.lineHeight+";";ab+="text-align:"+ad.alignment+";}\n";for(var af=0;af<ai.length;af++){var ag=ai[af];var aa="font-size: "+ag.fontSize+";\n";aa+="color: "+ag.color+";\n";if(ag.isUnderlined){aa+="text-decoration: underline;\n"}else{aa+="text-decoration: none;\n"}aa+=h.createOpenTypeFeatureCss(ag.features);var ac="class-with-otf-"+af;ab+="."+ac+" { \n   "+a.trim(aa.replace(/;\n/g,";\n   "))+"\n}\n";Z+='<span class="'+ac+'">'+ag.text+"</span>"}Z='<div class="class-with-otf-main">'+Z+"</div>"}return ah.replace("{1}",ab).replace("{2}",Z)};var z=function(aa,ad){var ab=Fonts.advFontPreview.getLastTextSelection(),ac=Fonts.advFontPreview.getTextPropertiesByCharacter();if(ab.length>0){for(var Z=ab.start;Z<ab.end;Z++){ac[Z][aa]=ad}Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures();return true}return false};X.on("click",function(){z("isUnderlined",!a(this).hasClass("selected-item"));a(this).toggleClass("selected-item");w.focus()});R.find("#advAllFeaturesOff").on("click",function(){var ab=Fonts.advFontPreview.getLastTextSelection(),ac=Fonts.advFontPreview.getTextPropertiesByCharacter();q.find(".feature-active").removeClass("feature-active");if(ab.length>0){for(var aa=ab.start;aa<ab.end;aa++){var Z=ac[aa].features;Z.splice(0,Z.length)}Fonts.advFontPreview.markAvailableFeatureIcons();Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures()}});R.find("#advAllFeaturesOn").on("click",function(){var ab=Fonts.advFontPreview.getLastTextSelection(),ac=Fonts.advFontPreview.getTextPropertiesByCharacter();if(ab.length>0){var aa=[];q.find("li:visible.available-state").each(function(){if(!a(this).hasClass("feature-active")){a(this).addClass("feature-active")}aa.push(a(this).attr("id")+"_1")});for(var Z=ab.start;Z<ab.end;Z++){ac[Z].features=a.merge([],aa)}}E();Fonts.advFontPreview.resetAdvTextPreviewElementAccordingCharFeatures()});var m=R.find("#advanced-selectors");var k=R.find("#advanced-css");var n=R.find("#advancedTabSwitcher");var o=k.find("#advCssContent");var p=o.val();R.find("#viewCssButton").on("click",function(){n.attr("href","#advanced-css");o.val(J(p));m.hide();k.show()});R.find("#backFromCss").on("click",function(){n.attr("href","#advanced-selectors");m.show();k.hide()});R.find("#selectCss").on("click",function(){o[0].select()});if(F){var l=false;Fonts.WebFonts.EditFontsTabsNavigation(".project-font-content,.features-content",".tabbed-controls > a","active-tab",function(){if(!l){P();l=true}})}else{P()}Fonts.WebFonts.EditFontsTabsNavigation(".tool-views > div",".subcontrols-inner > a","active-tab",function(Z){if(Z[0].id=="advancedTabSwitcher"){w.focus();v.select();Fonts.advFontPreview.refreshLastTextSelection();E()}});return true}return false};h.OnEditFontsPopup=function(k){if(k.FontsFaceDeclarationString){a('head style[id^="webfont-style"]').remove();Fonts.FontFace.addWebfontCss(k.FontsFaceDeclarationString)}if(k.WebFontsToLoad){a("body").append(k.WebFontsToLoad)}var i="";if(k.Html){i=a(k.Html)}else{if(typeof k==="string"){i=a(k)}}var j=i.data("targetProjectId");jsParentDirectory=i.find("#OtfJsUrl").val();i.lightbox_me({onLoad:function(){Fonts.WebFontManager.StartWebFontsListener();i.find("#select-all-fonts").click(function(){var l=a(this);i.find(".select-font").each(function(){a(this).attr("checked",l.is(":checked"))})});i.find("#select-all-deleted-fonts").click(function(){var l=a(this);i.find(".select-deleted-font").each(function(){a(this).attr("checked",l.is(":checked"))})});i.find(".select-font").click(function(){i.find("#select-all-fonts").attr("checked",i.find(".select-font:checked").length===i.find(".select-font").length)});i.find(".select-deleted-font").click(function(){i.find("#select-all-deleted-fonts").attr("checked",i.find(".select-deleted-font:checked").length===i.find(".select-deleted-font").length)});a.validator.unobtrusive.parse("#frmAddSelectorsWithFont");h.initOpenTypeFeaturesTab(i,true);h.initRemovedFontSection(i)},onClose:function(){a("#showRemovedFontsLink",i).unbind("click.showRemovedFontsLink");if(i.find("#hasChanges").val()==="1"){h.ReloadWebProject(j)}},destroyOnClose:true})};h.initRemovedFontSection=function(i){var j=a("#showRemovedFontsLink",i);a("#removedFontsWrapper",i).hide();if(j.length>0){j.bind("click.showRemovedFontsLink",function(k){k.preventDefault();a("#removedFontsWrapper",i).toggle();if(j.data("status")==="show"){j.text(j.data("texthide")).data("status","hide")}else{j.text(j.data("textshow")).data("status","show")}})}};h.OnNewOtSelectorAdded=function(k,l,n){var j=h.getWebFontsResponseHeader(n);if(j){g.routeMessage(j.type,j.message,"edit-fonts-messages");var m=a(".selectors-listing > ul");if(j.type==="success"){a("#hasChanges").val("1");m.append(a(k).find("li"));m.find("li").last().children("div").trigger("click")}else{if(j.type==="confirm"){var i=a("#fontSelector");Fonts.UI.Confirm(i.data("title"),j.message,i.data("confirmText"),i.data("cancelText"),function(){a.post(SiteUrls.updateSelectorOtf(),{projectId:j.projectId,fontId:j.fontId,selector:j.selector,openTypeFeatures:""},function(o,q,s){a("#hasChanges").val("1");var p=m.find('li[data-selector="'+j.selector+'"]');var r=h.getWebFontsResponseHeader(s);if(r){g.routeMessage(r.type,r.message,"edit-fonts-messages");if(p.length>0){p.replaceWith(a(o).find("li"))}else{m.append(a(o).find("li"))}m.find('li[data-selector="'+j.selector+'"]').children("div").trigger("click")}})})}}}};h.OnRemoveSelectedFonts=function(i){var k=new UserMessages(jQuery,"edit-fonts-messages");var j=a("section.modal.edit-web-fonts");if(j.find(".select-font:checked").length===0){k.singleCaution(i);return false}return true};h.RemoveSelectedFonts=function(n,m,j){var k=a("section.modal.edit-web-fonts");var l={ProjectId:m,FontsToRemove:[]};a.map(k.find(".select-font:checked"),function(p){var q=a(p).data("fontId");l.FontsToRemove.push(q)});var o=new UserMessages(jQuery,"edit-fonts-messages");if(l.FontsToRemove.length===0){o.singleCaution(a(this).data("nothingToRemoveMessage"));return}var i=a("#hiddenProjectFontCount").val();a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:n,data:JSON.stringify({projectId:l.ProjectId,fontsToRemove:l.FontsToRemove,projectFontCount:i}),success:function(r){if(r.Removed){var q=[];a.each(r.Removed,function(t,v){var u=k.find("input[data-font-id="+v.toString()+"]");q.push(u.closest("li").detach());u.removeClass("select-font");u.addClass("select-deleted-font");u.attr("checked",false)});var p=a("ul.font-results.restore-fonts");a.each(q,function(t,u){u.appendTo(p)});if(a("ul.font-results.delete-fonts li").length===0){a("div.submit.delete-fonts").hide()}a("ul.font-results.restore-fonts").show();a("div.submit.restore-fonts").show();a("#select-all-deleted-fonts").attr("checked",false);a("div.edit_fonts_desc_wrap.restore-fonts").each(function(){a(this).show()});a(".font-results.delete-fonts").find("li").last().removeClass("with-border");a(".font-results.delete-fonts").height("auto");if(r.ProjectSize){k.find("#add-edit-fonts-project-size").html(r.ProjectSize)}var s=a("#hiddenProjectFontCount").val();a("#hiddenProjectFontCount").val(s-r.Removed.length)}if(r.HideOtfTab){k.find("#otf_tab_link").hide()}if(r.OtfTabContent){k.off("click.toogleclass",".selectors-listing > ul > li > div");k.off("click",".remove-selector");k.find("#features_tab").replaceWith(r.OtfTabContent);h.initOpenTypeFeaturesTab(k,false)}if(r.Success){o.singleSuccess(r.Message)}else{o.singleError(r.Message)}k.find("#select-all-fonts").attr("checked",false);k.find("#hasChanges").val("1")},beforeSend:function(){k.find("#"+j).showLoading();k.find("#removeFontsButton").hide();k.find("#removeFontsWaitButton").show()},complete:function(){k.find("#"+j).hideLoading();k.find("#removeFontsButton").show();k.find("#removeFontsWaitButton").hide()}})};h.RestoreSelectedFonts=function(o,n,j){var k=a("section.modal.edit-web-fonts"),l={ProjectId:n,FontsToRestore:[]},m=[];a.map(k.find(".select-font"),function(q){var r=a(q).data("fontId");m.push(r)});a.map(k.find(".select-deleted-font:checked"),function(q){var r=a(q).data("fontId");if(m.indexOf(r)==-1){l.FontsToRestore.push(r)}});var p=new UserMessages(jQuery,"edit-fonts-messages");if(l.FontsToRestore.length===0){p.singleCaution(a(this).data("nothingToRestoreMessage"));return}var i=a("#hiddenProjectFontCount").val();a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:o,data:JSON.stringify({projectId:l.ProjectId,fontsToRestore:l.FontsToRestore,projectFontCount:i}),success:function(r){if(r.Restored){var s=[];a.each(r.Restored,function(u,w){var v=k.find("input[data-font-id="+w.toString()+"]");s.push(v.closest("li").detach());v.removeClass("select-deleted-font");v.addClass("select-font");v.attr("checked",false)});a.each(m,function(u,w){var v=k.find("input[data-font-id="+w.toString()+"]");v.attr("checked",false)});var q=a("ul.font-results.delete-fonts");a.each(s,function(u,v){v.appendTo(q)});if(a("ul.font-results.restore-fonts li").length===0){a("#select-all-deleted-fonts").attr("checked",false);a("ul.font-results.restore-fonts").hide();a("div.submit.restore-fonts").hide();a("div.edit_fonts_desc_wrap.restore-fonts").each(function(){a(this).hide()})}a("ul.font-results.delete-fonts").show();a("div.submit.delete-fonts").show();a("#select-all-fonts").attr("checked",false);a("div.edit_fonts_desc_wrap.delete-fonts").each(function(){a(this).show()});a(".font-results.restore-fonts").find("li").last().removeClass("with-border");a(".font-results.restore-fonts").height("auto");if(r.ProjectSize){k.find("#add-edit-fonts-project-size").html(r.ProjectSize)}var t=a("#hiddenProjectFontCount").val();a("#hiddenProjectFontCount").val(t+r.Restored.length)}if(r.HideOtfTab){k.find("#otf_tab_link").hide()}if(r.OtfTabContent){k.off("click.toogleclass",".selectors-listing > ul > li > div");k.off("click",".remove-selector");k.find("#features_tab").replaceWith(r.OtfTabContent);h.initOpenTypeFeaturesTab(k,false)}if(r.Success){p.singleSuccess(r.Message)}else{p.singleError(r.Message)}k.find("#select-all-deleted-fonts").attr("checked",false);k.find("#hasChanges").val("1")},beforeSend:function(){k.find("#"+j).showLoading();k.find("#restoreFontsButton").hide();k.find("#restoreFontsWaitButton").show()},complete:function(){k.find("#"+j).hideLoading();k.find("#restoreFontsButton").show();k.find("#restoreFontsWaitButton").hide()}})};h.OnRestoreSelectedFonts=function(l,i){var o=new UserMessages(jQuery,"edit-fonts-messages"),m=a("section.modal.edit-web-fonts"),n=[],k=[],j=false;a.map(m.find(".select-font"),function(p){var q=a(p).data("fontId");n.push(q)});a.map(m.find(".select-deleted-font:checked"),function(p){var q=a(p).data("fontId");if(n.indexOf(q)==-1){k.push(q)}else{j=true}});if(k.length===0){o.singleCaution(j===true?i:l);return false}return true};h.OnDownloadDesktopFontsPopup=function(j){if(j){var i=a(j);i.lightbox_me({onLoad:function(){h.EnsureAllVisibleWebFontDeclarations()},onClose:function(){i.find("li").each(function(){a(this).hideLoading()})},destroyOnClose:true})}};h.onBeginDownload=function(i){var j=UserMessages(a,"download-web-fonts-messages");j.clearAll();a("#"+i).showLoading()};h.OnDownloadDesktopFontFile=function(l){if(l){if(l.Success){var k=a("section.download-web-fonts");k.find("#download-web-fonts-header").replaceWith(l.DownloadDesktopFontsHeaderHtml);var i=a("<iframe name='"+l.UniqueFileIdentifier+"' style='display:none'></iframe>");i.attr("src",l.LoadFileActionUrl);a("body").append(i)}else{var j=new UserMessages(jQuery,"download-web-fonts-messages");j.singleError(l.Message)}}};h.ConfirmDeleteProject=function(l){var k=a("#"+l);var i=k.find(".delete>a");var m=k.find(".web-project-name").text();var j=a.format(i.data("message"),m);Fonts.UI.Confirm(i.data("title"),j,i.data("confirmText"),i.data("cancelText"),function(){h.DeleteProject(l)})};h.DeleteProject=function(i){a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:Fonts.Urls.getDeleteProjectAddess(),data:JSON.stringify({projectId:i}),success:function(m){var k=a("#"+i);var l=k.find(".web-project-name").text();var j=a.format(m.Message,l);k.hideLoading();if(m.Success){k.remove();Fonts.Messages.singleSuccess(j);if(a("#projects").children().length==0){a(".no-projects").show();a("#manage-projects-empty-header").show();a("#manage-projects-header").hide()}}else{Fonts.Messages.singleError(j)}},beforeSend:function(){a("#"+i).showLoading()},complete:function(){a("#"+i).hideLoading()}})};h.OnShowExportProject=function(j,k,l){var i=h.getWebFontsResponseHeader(l);if(i){g.routeMessage(i.type,i.message);if(i.type==="success"){if(j){a(j).lightbox_me({onLoad:function(){a(".link-action").click(function(){a(".txt-project-token").select()})},destroyOnClose:true})}}}};h.OnShowImportProject=function(j,k,l){var i=h.getWebFontsResponseHeader(l);if(i){g.routeMessage(i.type,i.message);if(i.type==="success"){if(j){a(j).lightbox_me({onLoad:function(){a(".txt-project-token").focus();a("#formImportExportProject").updateValidation();a(".submit-import").click(function(m){m.preventDefault();var n=a("#formImportExportProject");if(a(n).valid()===true){a(n).submit()}});a(".reset-import").click(function(m){m.preventDefault();a(".txt-project-token").val("").focus()})},destroyOnClose:true})}}}};h.OnProjectImported=function(j,k,l){var i=h.getWebFontsResponseHeader(l);if(i){g.routeMessage(i.type,i.message);if(i.type==="success"||i.type==="warning"){a("#"+i.projectId).replaceWith(j);a("#"+i.projectId).find(".accord-bar").click(function(m){Fonts.UI.accordBarExpandCollapseHandling(this);m.preventDefault()});if(i.type==="success"){Fonts.Messages.singleSuccess(i.message)}else{Fonts.Messages.singleCautionWithFadeOut(i.message)}}a(".import-project-container").trigger("close")}};h.OnUpdateProjectName=function(j,k,l){var i=h.getWebFontsResponseHeader(l);if(i){if(i.projectId){a("#showName"+i.projectId.replace(/-/g,"")).html(j);a("#"+i.projectId).find("h1").html(i.projectName)}}};h.OnProjectCreated=function(l,m,n){var j={validation:function(){a("#create_project_form_container").html(l);h.updateUnobtrusiveValidation("#new_projects_form")},success:function(){var o=a(l);a("#projects").prepend(o);a("#ProjectName").val("");a(".no-projects").hide();a("#manage-projects-header").show();a("#manage-projects-thankyou-header").hide();a("#manage-projects-empty-header").hide();o.find(".accord-bar").click(function(p){Fonts.UI.accordBarExpandCollapseHandling(this);p.preventDefault()})},error:function(){a("#create_project_form_container").html(l);h.updateUnobtrusiveValidation("#new_projects_form")}};var k=h.getWebFontsResponseHeader(n);if(k){g.routeMessage(k.type,k.message);var i=j[k.type];if(a.isFunction(i)){i(k)}}a("#create_project_form_container").hideLoading()};h.OnProjectNameEditorLoaded=function(i){a.validator.unobtrusive.parse("#"+i);a("#"+i).find("a.btnSave").click(function(j){j.preventDefault();var k=a(this).parents("form");if(a(k).valid()===true){a(k).submit()}})};h.OnDomainAdded=function(k,l,n){var j=h.getWebFontsResponseHeader(n);if(j){g.routeMessage(j.type,j.message,"domain-list-user-messages");var i={success:function(){a("#form-add-new-domain").hideLoading();a(k.DomainsHtml).appendTo("#domains");a("input.txt-add-new-domain").val("");a("#remove_project_domains_container").removeClass("hidden");a("#domain_list_container").find("#hasChanges").val("1")},error:function(){a("#form-add-new-domain").hideLoading();a("#add_domain").html(k.NewDomainFormHtml);if(k.DomainsHtml){a(k.DomainsHtml).appendTo("#domains");a("#domain_list_container").find("#hasChanges").val("1")}h.updateUnobtrusiveValidation("#form-add-new-domain");a("#domain-list-user-messages p").css({overflow:"hidden","word-break":"break-all"})}};var m=i[j.type];if(a.isFunction(m)){m()}}};h.OnDomainUpdated=function(k,l,n){var j=h.getWebFontsResponseHeader(n);if(j){g.routeMessage(j.type,j.message,"domain-list-user-messages");var i={success:function(){a("#domain_items").hideLoading();a("#"+j.containerId).html(k);a("#domain_list_container").find("#hasChanges").val("1")},warning:function(){a("#domain_items").hideLoading();a("#"+j.containerId).html(k);h.updateUnobtrusiveValidation(j.formId)},error:function(){a("#domain_items").hideLoading();a("#"+j.containerId).html(k);h.updateUnobtrusiveValidation(j.formId)}};var m=i[j.type];if(a.isFunction(m)){m()}}};h.AttachRemoveHandlers=function(){function i(k){var l={ProjectId:a(k).data("projectId"),DomainsToRemove:[]};a.map(a("#domain_items .check-box-delete"),function(m,n){if(a(m).is(":checked")===true){var o=a(m).data("domainUrl");l.DomainsToRemove.push(o)}});return l}function j(k){return function(){var l=i(k);if(l.DomainsToRemove.length===0){return}a("#domain_items").showLoading();a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:a(k).data("actionUrl"),data:JSON.stringify({projectId:l.ProjectId,domainsToRemove:l.DomainsToRemove}),success:function(m,o,p){a("#domain_items").hideLoading();var n=h.getWebFontsResponseHeader(p);if(n){g.routeMessage(n.type,n.message,"domain-list-user-messages");if(n.type==="success"){a("#domain_items .all-delete").attr("checked",false);a("#domain_items").find(".check-box-delete:checked").parents("tr").remove();a("#domain_list_container").find("#hasChanges").val("1");if(a("#domains").find("tr").size()===0){a("#remove_project_domains_container").addClass("hidden")}}}}})}}h.manageCheckBoxesUI("#domain_items .check-box-delete","#domain_items .all-delete");h.OnRemoveSelectedDomains=function(k,q,p,n,l,o){h.clearAddNewDomainMessages();var m=i(k);if(m.DomainsToRemove.length===0){if(a("#domain-list-user-messages .error-user-message-container:visible").length==0){a("#domain-list-user-messages").find(".error.user-message").append("<p>"+o+"</p>");a("#domain-list-user-messages").find(".error-user-message-container").fadeIn()}return}a("#domain-list-user-messages").find(".error-user-message-container").fadeOut();Fonts.UI.Confirm(q,p,n,l,j(k))}};h.OnGetDomainsForProject=function(j){var i=a(j);i.lightbox_me({onLoad:function(){h.AttachRemoveHandlers();a.validator.unobtrusive.parse("#add_domain form");a("#form-add-new-domain .btnSave").click(function(){var k=new UserMessages(jQuery,"domain-list-user-messages");if(k.length!==0){k.clearAll()}});a("#domain_items .btnSave").live("click",function(k){k.preventDefault();h.clearAddNewDomainMessages();var l=a(this).parents("form");if(a(l).valid()===true){a(l).submit()}})},onClose:function(){var k=a(j).data("targetProjectId");a("#domain_items .btnSave").die("click");if(i.find("#hasChanges").val()==="1"){h.ReloadWebProject(k)}},destroyOnClose:true})};h.OnDowngradeToFreePlan=function(i){if(i){a(i).lightbox_me({onLoad:function(){},destroyOnClose:true})}};h.ReloadWebProject=function(j){var i=a("#"+j);var k=a("#project-"+j+"-list-item");var l=i.data("reloading");if(typeof l==="undefined"){l=0}if(l===0){a.ajax({type:"POST",contentType:"application/json charset=utf-8",url:Fonts.Urls.getUpdateProjectAddress(),data:JSON.stringify({projectId:j}),beforeSend:function(){k.showLoading();i.data("reloading",1)},success:function(m,o,p){var n=h.getWebFontsResponseHeader(p);if(n){if(n.type==="success"){if(m){a("#"+j).replaceWith(m);a("#"+j).find(".accord-bar").click(function(q){Fonts.UI.accordBarExpandCollapseHandling(this);q.preventDefault()})}}}},complete:function(){k.hideLoading();i.data("reloading",0)}})}};h.InitHomePage=function(){var i=a(".brand ul");if(i.length>0){i.bxSlider({auto:false,autoHover:true,displaySlideQty:1,moveSlideQty:1});i.find("a.open-popup").click(function(){var j=a(this);var k=a(a("#fonts-modal-alert").html());k.find("#alert-title").html(j.attr("title"));k.find(".modal-content").replaceWith("<img src='"+j.data("fullImageSrc")+"' alt='"+j.attr("title")+"' />");k.css("width","auto");k.css("height","auto");k.lightbox_me({destroyOnClose:true})});a(".brand .prevClient").click(function(){i.goToPreviousSlide()});a(".brand .nextClient").click(function(){i.goToNextSlide()})}};h.PojectPageviewsPopup=function(j){if(j){var i=a(j);i.lightbox_me({onClose:function(){},destroyOnClose:true})}};h.AddToSkyFontsMockupFontsPopup=function(j){if(j.FontsFaceDeclarationString){a('head style[id^="webfont-style"]').remove();Fonts.FontFace.addWebfontCss(j.FontsFaceDeclarationString)}if(j.WebFontsToLoad){a("body").append(j.WebFontsToLoad)}var i="";if(j.Html){i=a(j.Html)}else{if(typeof j==="string"){i=a(j)}}i.lightbox_me({onLoad:function(){var k=a(".skyfonst-1-day-mockup-add-button");if(k.length>0){Fonts.Dropdowns.attachSkyFontsDropdowns(k)}},onClose:function(){},destroyOnClose:true})};h.initProductPreviewOtf=function(){var j=a(".search-featurestab .trigger"),i=a("#dev-opentype-features-container");f(j);a("#try-it-out-tab").on("click",function(){if(j.length&&i.children().length===0){e(function(){BindTextPopperHover(i.find(".textpopper"));j.on("click",function(){var l=i,m=a(this),k="active-trigger";m.toggleClass(k);if(m.hasClass(k)){l.show()}else{l.hide()}}).trigger("click");Fonts.advFontPreview.init({advTextEditor:a("#adv_font_feature_sample_input"),advTextEditorCopy:a("#adv_font_feature_sample_input_copy"),advFeatureIcons:a("#opentype-features-list"),advPreviewDiv:a("#advPreviewDiv"),advResetText:a("#adv_reset_text"),isProductPage:true,onReset:function(){a(".foregroundSelector .colorPalette").ColorPickerSetColor("000000");a(".backgroundSelector .colorPalette").ColorPickerSetColor("ffffff");a('#try-it-out select[name="font-size"]').selectbox("change","32","32")}})})}})};return h}(jQuery));$(function(){Fonts.WebFonts.InitHomePage()});Fonts.WishLists=(function(a){var c={};var b={};c.SetWishListEmptyNameMessage=function(d){b.failedCloneMessage=d};c.GetFailedCloneMessage=function(){return b.failedCloneMessage};c.SetSuccessClonedWishlist=function(d){b.successCloned=d};c.GetSuccessClonedWishListTitle=function(){return b.successCloned};c.SetFailedCloneTitle=function(d){b.failedCloneTitle=d};c.GetFailedCloneTitle=function(){return b.failedCloneTitle};c.parseWishList=function(d){a("#wishlist-content").html(d)};c.OnWebFontsWishListPopup=function(g){var e=a(g),d=e.find("section.modal"),f=e.find("#fonts-face-declaration");if(d.length===0){d=e}if(f.length){a('head style[id^="webfont-style"]').remove();Fonts.FontFace.addWebfontCss(f.text());f.remove()}d.lightbox_me({onLoad:function(){Fonts.WebFontManager.StartWebFontsListener(d);Fonts.Dropdowns.AttachDropdown({container:d,dropdown:".add-to-web-fonts",close:".add-to-web-fonts-close",callback:function(h){h.find(".web-fonts-drop-down-list").children(":selected").removeAttr("selected");h.find(".web-fonts-drop-down-list").children(":nth-child(2)").attr("selected","selected");h.find(".sbSelector[id $= "+h.find(".web-fonts-drop-down-list").attr("sb")+"]").text(h.find(".web-fonts-drop-down-list").children(":selected").text());h.find(".add-to-project-font-selector").children(":selected").removeAttr("selected");h.find(".add-to-project-font-selector").children(":nth-child(1)").attr("selected","selected");h.find(".sbSelector[id $= "+a(".add-to-project-font-selector").attr("sb")+"]").text(h.find(".add-to-project-font-selector").children(":selected").text());h.find(".new-webfontsproject-name").val("").hide()}});Fonts.UI.AttachAddToWebFontDropDownsEvents(d)},onClose:function(){if(d.find("#hasChanges").val()==="1"){document.location.reload()}},destroyOnClose:true})};c.OnWebFontAddedToProject=function(h){if(h){var f=UserMessages(jQuery,"web-fonts-wish-list-messages"),d=a(".web-fonts-wish-list .font[data-font-id="+h.FontId+"]").find("h3").text(),g=a(".web-fonts-wish-list select option[value='"+h.ProjectId+"']").first().text(),e=a.format(h.Message,d,g);Fonts.UI.updateWebFontProjectDropDowns(h);if(h.Success){a(".web-fonts-wish-list").find("#hasChanges").val("1");f.singleSuccess(e)}else{f.singleError(e)}}};c.OnCreateProjectWithWebFont=function(h){if(h){var f=UserMessages(jQuery,"web-fonts-wish-list-messages");var d=a(".web-fonts-wish-list .font[data-font-id="+h.FontId+"]").find("h3").text();var g=h.ProjectName;var e=a.format(h.Message,d,g);if(h.Success){a(".web-fonts-wish-list").find("#hasChanges").val("1");f.singleSuccess(e)}else{f.singleError(e)}}};c.ChangeContainerContent=function(d,e,f){a(d).html(e.ContainerContent);a("#selected-wishlistId option[value="+f+"]").html(a("#selected-wishlistName").html());a("#selected-wishlistId").selectbox("detach");a("#selected-wishlistId").selectbox();jQuery.validator.unobtrusive.parse(d);if(typeof e.Message!="undefined"){Fonts.UI.ShowAndRemove({container:"#wishlists-messages-container",data:e.Message})}};c.OnSuccessWishListDelete=function(e,d){if(d.Success){a("#wishlist-"+e+"-row").remove()}if(typeof d.Message!="undefined"){Fonts.UI.ShowAndRemove({container:"#wishlists-messages-container",data:d.Message})}};c.CancelEditingWishListName=function(e){var d=a(e).parent().parent();a("input[name=Name]",d).val(a("input[name=OldName]",d).val())};c.OnSuccessRemoveItem=function(d){if(d.Success==true){var e=function(){a("#variation-"+d.ProductVariationId+"-row").remove()};Fonts.UI.ShowAndRemove({container:a("#variation-"+d.ProductVariationId+"-row"),data:d.Messages,callback:e})}else{Fonts.UI.ShowAndRemove({container:a("#variation-"+d.ProductVariationId+"-row-messages"),data:d.Messages})}};c.CloneWishlistButtonEvent=function(){var d=a("#clone-wish-list-form");if(d&&a("#cloneWishListName").valid()){var e=a("#cloneWishListName");d.parent().showLoading();a.ajax({type:"POST",url:d.attr("action"),data:d.serialize(),dataType:"json",success:function(f){if(f&&f.Success){Fonts.UI.updateWishListDropDowns(f);e.val("")}if(!f.ModelStateIsValid&&f.FormHtml){a("#clone-wish-list-form").replaceWith(f.FormHtml);a("#clone-wish-list-form #clone-wishlist-button").click(Fonts.WishLists.CloneWishlistButtonEvent)}var g={container:d.find("span.messages-container"),data:f.Message};Fonts.UI.ShowAndRemove(g)},complete:function(){d.parent().hideLoading()}})}};return c}(jQuery));Fonts.advFontPreview=(function(a){var w={},b,c,e,f,v,z,d,k,u,C=function(){},x=function(){},t=function(E,D){return window[getFunctionName("'"+E+"'","ReplaceGlyphVariant")](D)},j=function(D,E){var H=[],F=D.length,G=E.length,I;if(F&&G){while(F--){I=D[F];G=E.length;while(G--){if(E[G]===I){H.push(I);break}}}}return H},r=function(D){var E=D.length,F={};while(E--){F[D[E].replace(/_\d+$/,"")]=true}return F},p=function(D,G){var E=D.length,F=-1;while(E--){if(D[E].replace(/_\d+$/,"")===G){F=E;break}}return F},q=function(){var G=v,D=n(),E=D.features.slice(0),F;if(G.start!=z.length){E=z[G.start].features.slice(0)}if(G.length>0){for(F=G.start+1;F<G.end;F++){E=j(E,z[F].features);if(E.length===0){break}}}return E},l=function(D){return D.replace(/\n/g,"<br>")},n=function(){return{fontSize:null,lineHeight:null,color:null,alignment:null,isUnderlined:false,features:[]}},o=function(){return a("#advPreviewDiv").data("win-menu-name")},i=function(D,E){var F;if(D.length!=E.length){return false}else{for(F=0;F<D.length;F++){if((a.inArray(D[F],E)==-1)||(a.inArray(E[F],D)==-1)){return false}}}return true},m=function(){var K=-1,J=-1,F=e[0],D=e,G=D.val(),H=null,I,E,L;if(F.selectionStart!=null){K=F.selectionStart;J=F.selectionEnd}else{if(document.selection.createRange){H=document.selection.createRange();I=document.selection.createRange();E=I.duplicate();L=G.length;K=0;J=0;I.moveStart("character",-1);while(I.parentElement()==F){I.moveStart("character",-1);K++}E.moveEnd("character",1);while(E.parentElement()==F){J++;E.moveEnd("character",1)}if(J>0){J=L-J+1}}}return{start:K,end:J,length:J-K,text:K!=J?G.substring(K,J):"",ieRange:H}},g=function(E,H,G){var J=G.length,F,I;for(I=0;I<J;I++){F=G[I].split("_");try{window[getFunctionName("'"+H+"'",F[0])](E[0],F[1])}catch(D){if(console){console.log("Error applying feature -"+F[0]+". Exception - "+D.message)}}}},s=function(F,E){var J=a("<div>"),H=v,I=q(),D=t(F,E),M={},N=[],K,L,G;if(D>1){J.html(H.text);g(J,F,I);L=J.html();for(G=1;G<=D;G++){J.html(L);g(J,F,[E+"_"+G]);K=J.html();if(L!==K&&!M[K]){N.push(G);M[K]=true}}}return N},y=function(E,D,K){var L=a("#dev-glyph-variations-content"),J=a('<div class="dev-variant"><span></span></div>'),I=q(),H=v,M=K.length,G,F;L.html("");J.find("span").html(H.text);for(F=0;F<M;F++){G=J.clone();Fonts.WebFonts.TurnOnOTF(G,I.concat([D+"_"+K[F]]),E);G.attr("data-feature",D).attr("data-variant",K[F]).appendTo(L)}w.bindFeatureVariantEvents();a("#dev-glyph-variations-container").show()},B=function(F,L,D){var K=v,H,E,G,I,J;for(J=K.start;J<K.end;J++){E=z[J].features;G=r(E);H=G[F];if(D){if(!H){E.push(F+"_"+L)}}else{if(H){I=p(E,F);E.splice(I,1)}}}},A=function(){w.markAvailableFeatureIcons();w.resetAdvTextPreviewElementAccordingCharFeatures();f.focus()},h=function(D,F){var E=D.data("feature"),G=D.data("variant");if(F){b.find("#"+E).addClass("feature-active")}B(E,G,true);A()};w.markAvailableFeatureIcons=function(){var E=v,D,F;if(E.length>0){D=o();F=a("<div>"+E.text+"</div>");F.css("font-family",D);b.find(".feature-active:visible").each(function(){var G=a(this).attr("id");applyOtJsForElement(F[0],[G],1,D)});b.find("li:visible:not(.feature-active)").each(function(){var I=a(this),G=a(F[0].cloneNode(true)),H=I.attr("id");applyOtJsForElement(G[0],[H],1,D);if(a.trim(G.html())!=a.trim(F.html())){I.addClass("available-state").removeClass("feature-inactive")}else{I.removeClass("available-state").addClass("feature-inactive")}})}else{b.find("li:visible").removeClass("available-state").removeClass("feature-active").addClass("feature-inactive")}};w.displaySelectionAvailableFeatureIcons=function(){var D=q(),E=r(D);b.find("li:visible").each(function(){var F=a(this),G=F.attr("id");if(E[G]){F.addClass("feature-active")}else{F.removeClass("feature-active")}});w.markAvailableFeatureIcons()};w.getAdvTextPreviewProperties=function(){var H=e.val(),G=[],F,E,D;if(z.length>0){F=a.extend(true,{start:0,text:H},z[0]);G.push(F);for(D=1;D<z.length;D++){E=z[D];if(E.fontSize!=F.fontSize||E.color!=F.color||E.isUnderlined!=F.isUnderlined||!i(E.features,F.features)){F.text=H.substring(F.start,D);F=a.extend(true,{start:D,text:H.substring(D)},z[D]);G.push(F)}}}return G};w.resetAdvTextPreviewElementAccordingCharFeatures=function(){var E=o(),D=n(),H,G,I,F;c.html("").css("font-family",E);if(D.lineHeight){c.css("line-height",D.lineHeight)}if(D.alignment){c.css("text-align",D.alignment)}if(z.length>0){H=w.getAdvTextPreviewProperties();for(F=0;F<H.length;F++){G=H[F];I=a("<span></span>").html(G.text);Fonts.WebFonts.TurnOnOTF(I,G.features,E);if(G.color){I.css("color",G.color)}if(G.fontSize){I.css("font-size",G.fontSize)}if(G.isUnderlined){I.css("text-decoration","underline")}else{I.css("text-decoration","none")}I.css("line-height",D.lineHeight);I.html(l(I.html()));c.append(I)}}};w.bindAdvFeatureIconsClick=function(){b.find("li").on("click",function(){var F=a(this),D=F.attr("id"),E=o(),G;if(F.hasClass("available-state")||F.hasClass("feature-active")){G=s(E,D);if(!u&&G.length>1){if(!F.hasClass("feature-active")){y(E,D,G)}else{B(D,0,false);F.removeClass("feature-active")}}else{F.toggleClass("feature-active");B(D,1,F.hasClass("feature-active"))}A()}})};w.bindFeatureVariantEvents=function(){var D;a("#dev-glyph-variations-content .dev-variant").on("click",function(){var E=a(this);h(E,true);E.data("active",0)}).hover(function(){var E=a(this);D=setTimeout(function(){h(E,false);E.data("active",1)},300)},function(){var G=a(this),E=G.data("active"),F;clearTimeout(D);if(E){F=G.data("feature");B(F,0,false);A();G.data("active",0)}})};w.bindHideVariantPreview=function(){var D=a("#dev-glyph-variations-container");a("html").on("mouseup",function(){D.hide()})};w.bindTextEditorEvents=function(){e.on("keyup input propertychange click",function(D){var I,F,G,H,J,E;if(D.type=="propertychange"&&D.originalEvent&&D.originalEvent.propertyName&&D.originalEvent.propertyName=="style.display"){return}I=v;v=m();if(D.type=="input"||D.type=="propertychange"){if(!(D.type=="propertychange"&&D.originalEvent&&D.originalEvent.propertyName&&D.originalEvent.propertyName!="value")){F=I.start;G=z[F];H=e.val();if(I.length>0){z.splice(I.start,I.length)}if(H.length>z.length){J=H.length-z.length;if(z.length==I.start){G=n()}for(E=0;E<J;E++){z.splice(I.start+E,0,a.extend(true,{},G))}}else{if(H.length<z.length){z.splice(v.start,z.length-H.length)}}}}w.displaySelectionAvailableFeatureIcons();C();w.resetAdvTextPreviewElementAccordingCharFeatures()}).on("select",function(){v=m();w.displaySelectionAvailableFeatureIcons();C()}).on("blur",function(){var D=e.scrollTop();if(v.length>0){var E=e.val();E=E.substring(0,v.start)+'<span class="selected_text">'+v.text+"</span>"+E.substring(v.end);f.html(l(E))}else{f.html(l(e.val()))}e.css("display","none");f.css("display","block");f.scrollTop(D)});if(a.browser.mozilla){e.on("mousedown",function(D){if(D.ctrlKey&&e[0].selectionStart){e[0].selectionStart=null;e[0].selectionEnd=null}})}};w.bindTextEditorCopyEvents=function(){f.on("focus",function(){var D;f.css("display","none");e.css("display","block");e.focus();if(v.length>0){D=e[0];if(D.selectionStart!=null){D.selectionStart=v.start;D.selectionEnd=v.end}else{if(v.ieRange){v.ieRange.select()}}}})};w.bindResetEvent=function(){d.on("click",function(){x();e.val(k);v={start:0,end:0,length:0,text:""};f.html(l(k));w.resetTextPropertiesByCharacter();w.displaySelectionAvailableFeatureIcons();C();w.resetAdvTextPreviewElementAccordingCharFeatures()})};w.getLastTextSelection=function(){return v};w.refreshLastTextSelection=function(){v=m()};w.getTextPropertiesByCharacter=function(){return z};w.resetTextPropertiesByCharacter=function(){var D=n(),F=e.val(),G=F.length,E;z=[];for(E=0;E<G;E++){z.push({fontSize:D.fontSize,color:D.color,isUnderlined:D.isUnderlined,features:D.features.slice()})}};w.init=function(D){e=D.advTextEditor;f=D.advTextEditorCopy;b=D.advFeatureIcons;c=D.advPreviewDiv;d=D.advResetText;u=D.isProductPage||false;k=e.val();v={start:0,end:0,length:0,text:""};if(typeof D.getCurrentFontProperties==="function"){n=D.getCurrentFontProperties}if(typeof D.getFamilyName==="function"){o=D.getFamilyName}if(typeof D.updateUiBySelection==="function"){C=D.updateUiBySelection}if(typeof D.onReset==="function"){x=D.onReset}w.resetTextPropertiesByCharacter();w.bindAdvFeatureIconsClick();w.bindTextEditorEvents();w.bindTextEditorCopyEvents();w.bindResetEvent();w.bindHideVariantPreview();if(D.isProductPage){f.focus();e.select();v=m();w.displaySelectionAvailableFeatureIcons();w.resetAdvTextPreviewElementAccordingCharFeatures()}};return w}(jQuery));$(function(){BindTextPopperHover($(".textpopper"));FontPreview.BindEvents();$(".badge img").mouseover(function(){var j=$(this).attr("src");$(this).attr("src",j.replace("/g/","/c/"))}).mouseout(function(){var j=$(this).attr("src").replace("/c/","/g/");$(this).attr("src",j)});$("li.switch-a").click(function(j){$("div.switch-a").show();$("div.switch-b").hide();$(this).children().addClass("active");$("li.switch-b a").removeClass("active");j.preventDefault()});$("li.switch-b").click(function(j){$("div.switch-b").show();$("div.switch-a").hide();$(this).children().addClass("active");$("li.switch-a a").removeClass("active");j.preventDefault()});$(".accord-bar:not(.dev-suspended)").click(function(j){Fonts.UI.accordBarExpandCollapseHandling(this);j.preventDefault()});$(".accord-bar.collapse").append("<span>"+Fonts.Translations.getOpenLabel()+"</span>");$(".accord-bar.collapse").next(".pairing").css("display","none");$(".accord-bar:not(.collapse)").append("<span>"+Fonts.Translations.getCloseLabel()+"</span>");var f=$(".cart .accord-group.expand-modal-init");var d=f.length==1;$(".cart .accord-group").each(function(){var j=$(this).parent();if($(this).hasClass("expand-init")&&!d||$(this).hasClass("expand-modal-init")&&d){return}if(!j.hasClass("accord-group-init")&&!j.hasClass("accord-group-container")&&!d){j.addClass("accord-group-init")}else{$(this).find(".accord-bar").trigger("click")}});if(d){f.find("input:visible:first").focus();setTimeout(function(){$("html, body").animate({scrollTop:f.offset().top},500)},500)}$(".trigger-tutorial").click(function(j){$(".tutorial-wrap").stop().slideToggle("fast");$(".close-tutorial").show();$(".trigger-tutorial").hide();j.preventDefault()});$(".close-tutorial").click(function(j){$(".tutorial-wrap").stop().slideToggle("fast");$(".close-tutorial").hide();$(".trigger-tutorial").show();try{$f().stop()}catch(k){}j.preventDefault()});Fonts.UI.tabSortSwitcher($("ul.tabs li, ul.sort li").not($("#search-tabs li")));var i=0;var g=[];$(".carousel-content li").each(function(j){g[j]=i;i+=$(this).width();if(!$(this).width()){alert("Please, fill in width & height for all your images!");return false}});var a=$(".carousel .carousel-content");a.width(i);var b=$(".carousel-content li img");var c=false;$(".carousel-controls a").click(function(j){$(".carousel-controls li").removeClass("active");$(this).parent().addClass("active");var k=$(this).parent().prevAll(".carousel-controls li").length;if(g.length>k){if(!c){b.each(function(){var l=$(this);l.attr("src",l.data("image-src"))});c=true}a.stop().animate({marginLeft:-g[k]+"px"},450)}j.preventDefault()});$(".controls li:first").addClass("active");Fonts.Dropdowns.AttachAllDropdowns($("body"));Fonts.Dropdowns.AttachHtmlClick();function e(t,l){var v=l.length-1;var p;var u;var j;var k;for(p=v;p>=0;p--){if(t>=p/v){u=(t-p/v)/(1/v);j=l[p];k=l[p+1];break}}if(!k){return j}var o=k[0]-j[0];var s=j[0]+Math.floor(o*u);var n=k[1]-j[1];var r=j[1]+Math.floor(n*u);var m=k[2]-j[2];var q=j[2]+Math.floor(m*u);return[s,r,q]}var h=$(".rating-bar");if(h.length>0){h.slider({from:1,to:10,step:0.1,round:1,dimension:"",limits:false,skin:"plastic",onstatechange:function(l){var k=this.getPrcValue()/100;if(k>100){k=100}var j=e(k,[[255,2,2],[251,255,2],[5,255,4]]);$(this.domNode).find(".jslider-value").css("background-color","rgb("+j[0]+","+j[1]+","+j[2]+")");$(this.domNode).find(".jslider-arrow").css("border-top-color","rgb("+j[0]+","+j[1]+","+j[2]+")")}})}$("#searchwhere-1").selectbox();$("#Subject").selectbox({effect:"hide"});Cart.BindCartOptionsDeleteEvent();(function(j){var k={init:function(l){var m={container:"body",topAdjust:0,bottomAdjust:0};return this.each(function(){if(l){j.extend(m,l)}j(this).data("sfContainer",j(this).parents(m.container).eq(0));j(this).data("sfTopAdjust",m.topAdjust);j(this).data("sfBottomAdjust",m.bottomAdjust);j(this).addClass("sfElement");j(window).scroll(k.update);j(window).resize(k.resize);k.monitor(j(this).parents(m.container).eq(0))})},monitor:function(m){if(j(m).css("position")!=="absolute"){j(m).css("position","relative")}var l=j(document.createElement("iframe"));l.css({position:"absolute",top:0,right:0,bottom:0,left:0,width:"100%",height:"100%","z-index":-1,border:"none",background:"#fff",visibility:"hidden"});j(m).append(l)},update:function(){var l=j(window).scrollTop();j(".sfElement").each(function(){var n=j(this);var u=n.outerHeight(true);var m=n.data("sfContainer");var r=m.outerHeight(true);var x=n.data("sfTopAdjust");var o=n.data("sfBottomAdjust");var v=m.offset().top;v-=x;var s=v+r-u;s-=o;var t=s-n.parent().offset().top;t+=x;var w="auto";var p=j(".cms-nav");if(p.length>0){var q=p.parents(".wrap").width();var y=p.width()-(p.parents(".content").width()-q)/2;if(y>0){w="5px"}if(y==p.width()){w=j(window).width()-q+j(window).scrollLeft()+5+"px"}}if(l>v&&l<s){n.css({position:"fixed",top:x,left:"auto",right:w,width:n.width()})}else{if(l>s){n.css({position:"absolute",top:t,left:"auto",right:w,width:n.width()})}else{n.css({position:"",top:"",left:"",right:"",width:""})}}})},resize:function(){var l=j(".cms-nav");if(l.length>0){var m=l.parents(".wrap").width();var n=l.width()-(l.parents(".content").width()-m)/2;if(n>0){l.css("left",m-n)}else{l.css("left",m+20);l.find(".sfElement").css("right","")}}}};j.fn.scrollFollow=function(l){if(k[l]){return k[l].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof l==="object"||!l){return k.init.apply(this,arguments)}else{j.error("Method "+l+" does not exist on jQuery.scrollFollow")}}};j(".scrollfollow-wrap div").scrollFollow({container:".wrap",topAdjust:30,bottomAdjust:96});j(document).ready(function(){j(".cms-nav").scrollFollow("resize")});j(".resetable-sing-in-block .trigger, .resetable-sing-in-block .sign-in").click(function(){Fonts.Account.RestoreMemberSigninForm()});Fonts.Account.AttachEventsToNeedSupportForm();Fonts.Account.AttachEventsToMemberSignin();Cart.AttachEventsToApplyCouponCode();Cart.AttachEventsToPaymentTypeSelection();Cart.BindLicenseQuantityEvents();Cart.BindCartItemFormatEvent();Fonts.Account.HandleSigninAfterLoad();Fonts.CartSummary.AttachCartOptionsDropDown();Fonts.Account.AttachWishlistOptionDropDown()}(jQuery))});var SkyFontsClient={timerId:null,infiniteConnectionTestTimerId:null,startingPort:50000,port:0,connectionChecked:false,connectionStatus:false,uid:1,QueuedFonts:[],logins:[]};SkyFontsClient.isFunction=function(a){return Object.prototype.toString.call(a)=="[object Function]"};SkyFontsClient.check=function checkForSkyFonts(e){var j=e.tryCount||1,a=e.alreadyHasSkyfonts===true,f=e.onprogress,h=e.onsuccess,c=e.onfailure;SkyFontsClient.connectionStatus=false;SkyFontsClient.logins=[];if(!SkyFontsClient.isFunction(f)){f=function(){}}if(!SkyFontsClient.isFunction(h)){h=function(){}}if(!SkyFontsClient.isFunction(c)){c=function(){}}if(j<=1){SkyFontsClient.connectionChecked=true;f()}var i=null;var b=document.createElement("script");b.onerror=function(){clearTimeout(i);i=null;if((j+1)<=3){SkyFontsClient.check({tryCount:j+1,alreadyHasSkyfonts:e.alreadyHasSkyfonts,onprogress:e.onprogress,onsuccess:e.onsuccess,onfailure:e.onfailure});return}c({status:"Failure",exception:"Server unreachable"})};var d="$__SkyFontsClient__$$__callback"+(SkyFontsClient.uid++);window[d]=function(k){SkyFontsClient.connectionStatus=true;if(k.logins){SkyFontsClient.logins=k.logins}h(k)};b.onload=function(){clearTimeout(i);i=null};var g=SkyFontsClient.startingPort+j;SkyFontsClient.port=g;b.src="http://localhost:"+g+"/TestConnection?"+new Date().getTime()+"&jsonCallback="+d;document.body.appendChild(b);i=setTimeout(function(){clearTimeout(i);i=null;if((j+1)<=3){SkyFontsClient.check({tryCount:j+1,alreadyHasSkyfonts:e.alreadyHasSkyfonts,onprogress:e.onprogress,onsuccess:e.onsuccess,onfailure:e.onfailure});return}c({status:"Failure",exception:"Operation timed out"})},5000)};SkyFontsClient.addFont=function(d){d.type=d.type||"ttf";d.fontname=d.fontname||"UNKNOWN FONT";d.fonturl=d.fonturl||"";d.provider=d.provider||"UNKNOWN PROVIDER";d.version=d.version||"0";d.fontlocalname=d.fontlocalname||"UNKNOWN FONT";var e=d.onprogress,f=d.onsuccess,b=d.onfailure;if(!SkyFontsClient.isFunction(e)){e=function(h){}}if(!SkyFontsClient.isFunction(f)){f=function(h){}}if(!SkyFontsClient.isFunction(b)){b=function(h){}}if(SkyFontsClient.connectionChecked===true){if(!SkyFontsClient.connectionStatus){b({status:"Failure",exception:"SkyFonts Client not running"});return}}e();var c="$__SkyFontsClient__$$__callback"+(SkyFontsClient.uid++);window[c]=function(h){if(h.status=="Success"){f(h)}else{b(h)}};var g=null;var a=document.createElement("script");a.onerror=function(){clearTimeout(g);g=null;b({status:"Failure",exception:"SkyFonts Client not running properly."})};a.onload=function(){clearTimeout(g);g=null};a.src="http://localhost:"+SkyFontsClient.port+"/TrialFont?"+new Date().getTime()+"&jsonCallback="+c+"&data="+encodeURIComponent('{"Type": "'+d.type+'", "Name": "'+d.fontname+'", "Url": "'+d.fonturl+'", "Provider" : "'+d.provider+'", "Version" : "'+d.version+'", "WinMenuName" : "'+(d.winmenuname||d.fontlocalname)+'", "ProviderUserToken": "'+d.providerUserToken+'", "ProviderUsername": "'+d.providerUsername+'"}');document.body.appendChild(a);g=setTimeout(function(){clearTimeout(g);g=null;b({status:"Failure",exception:"SkyFonts Client did not respond in time"})},5000)};SkyFontsClient.infiniteCheckConnection=function(b){if(SkyFontsClient.infiniteConnectionTestTimerId==null){var c=b.onsuccess,a=b.onfailure;if(!SkyFontsClient.isFunction(c)){c=function(d){}}if(!SkyFontsClient.isFunction(a)){a=function(d){}}SkyFontsClient.infiniteConnectionTestTimerId=setTimeout(function(){SkyFontsClient.check({onsuccess:function(d){window.clearTimeout(SkyFontsClient.infiniteConnectionTestTimerId);SkyFontsClient.infiniteConnectionTestTimerId=null;c(d)},onfailure:function(){SkyFontsClient.infiniteConnectionTestTimerId=null;SkyFontsClient.infiniteCheckConnection(b);a()}})},2000)}};SkyFontsClient.getCurrentUsername=function(b){if(b!=""){if(SkyFontsClient.logins){if(SkyFontsClient.logins.length){for(var a=0;a<SkyFontsClient.logins.length;a++){if((SkyFontsClient.logins[a]["provider"]||"").toLowerCase()==b.toLowerCase()){return SkyFontsClient.logins[a]["username"]}}}}}return""};SkyFontsClient.tryLaunch=function(h){h.type=h.type||"ttf";h.fontname=h.fontname||"UNKNOWN FONT";h.fonturl=h.fonturl||"";h.provider=h.provider||"UNKNOWN PROVIDER";h.version=h.version||"0";h.fontlocalname=h.fontlocalname||"UNKNOWN FONT";var i=h.onprogress,j=h.onsuccess,c=h.onfailure;if(!SkyFontsClient.isFunction(i)){i=function(e){}}if(!SkyFontsClient.isFunction(j)){j=function(e){}}if(!SkyFontsClient.isFunction(c)){c=function(e,k,l){}}i();var f="skyfonts://trial?type="+h.type+"&fontname="+h.fontname+"&url="+h.fonturl+"&provider="+h.provider+"&version="+h.version+"&winmenuname="+h.fontlocalname;if(navigator.msLaunchUri){navigator.msLaunchUri(f,function(){j()},function(){c("IE10","LATEST VERSION OF SKYFONTS IS NOT INSTALLED")})}else{var g=document.getElementById("skyfonts-applauncher");if(g==null){g=document.createElement("iframe");g.id="skyfonts-applauncher";g.style.height="1px";g.style.width="1px";g.style.position="absolute";g.style.visibility="hidden";document.body.appendChild(g)}if(navigator.userAgent.indexOf("MSIE")!=-1){try{var d=new ActiveXObject("SkyFonts.IsInstalled");g.src=f}catch(b){c("IE<=9","LATEST VERSION OF SKYFONTS IS NOT INSTALLED",b)}}else{try{g.contentWindow.location=f;var a=false;window.onblur=function(){a=true};if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){j()}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.setTimeout(function(){try{if(g.contentWindow.location=="about:blank"){}j()}catch(k){c("Opera","LATEST VERSION OF SKYFONTS IS NOT INSTALLED",k);console.log(k)}},0)}else{window.setTimeout(function(){if(a!==true){c("Chrome","LATEST VERSION OF SKYFONTS IS NOT INSTALLED")}else{j()}},800)}}}catch(b){if(b.name=="NS_ERROR_UNKNOWN_PROTOCOL"){c("Firefox","LATEST VERSION OF SKYFONTS IS NOT INSTALLED",b);console.log(b)}}}}};Fonts.SkyFontDropdown=(function(a){var e={},h=function(l){var j=l.container,k=l.form,m=k.find('select[name="SkyFontsOption"]'),n=m.find('option[value="'+m.val()+'"]').index();m.selectbox("detach").find("option:lt("+n+")").remove();m.selectbox();j.find(".btn-widthdropdown").addClass("skyfonts-active")},i=function(j){var k=function(){var m=a(this),n=j[m.val()];if(n){m.html(n.Html);if(n.Inactive){m.attr("data-marked",1)}else{m.removeAttr("data-marked")}}},l=function(){var m=a(this),n=m.val();m.selectbox("detach");a.each(m.find("option"),k);m.val(n).selectbox()};a.each(a('select[name="SkyFontsOption"]'),l)},b=function(l){var k=l.form,j=l.contentWrapper,m=l.userMessages;m.clearAll();j.showLoading();a.ajax({type:k.attr("method"),url:k.attr("action"),data:k.serialize(),datatype:"json"}).done(function(n){if(n.Success){h(l);i(n.Data.OptionsList);var o=k.find("select"),q=o.val(),p=o.find('option[value="'+q+'"]');o.selectbox("detach");p.attr("data-marked",1);o.val(q).selectbox();l.onAdded(n.Data)}m.addMessage(n,function(){if(n.Success){l.container.find(".dev-add-skyfonts-dropdown-button").click()}})}).fail(function(){m.addError(Fonts.Translations.getErrorMessage())}).always(function(){j.hideLoading()})},g=function(){a("#skyfonts-client-mac-panel").toggle();a("#skyfonts-client-win-panel").toggle();a("#skyfonts-client-mac-version-panel").toggle();a("#skyfonts-client-win-version-panel").toggle()},d=function(k){a("#skyfonts-client-win-instruction-panel").toggle();a("#skyfonts-client-click-panel").toggle();a("#skyfonts-client-instruction-panel").toggle();a("#skyfonts-client-final-panel").toggle();a(k.version).toggle();var j=a("<iframe style='display:none'></iframe>"),l=a(k.button).data("url");a(k.button).closest("div.form-submit.clearfix").toggle();j.attr("src",l);a("body").append(j);if(window._gaq){window._gaq.push(["_trackEvent","SkyFonts","ClientDownload",l])}},c=function(m){var o=a("#skyfonts-client-switch-win"),l=a("#skyfonts-client-switch-mac"),n=a("#skyfonts-client-win-download"),j=a("#skyfonts-client-additional-win-download"),k=a("#skyfonts-client-mac-download");if(o.length>0){o.bind("click",function(){g()})}if(l.length>0){l.bind("click",function(){g()})}if(n.length>0){n.bind("click",function(p){var q={button:"#skyfonts-client-win-download",version:"#skyfonts-client-win-version-panel"};d(q);p.preventDefault()})}if(j.length>0){j.bind("click",function(p){var q={button:"#skyfonts-client-additional-win-download",version:"#skyfonts-client-win-version-panel"};d(q);p.preventDefault()})}if(k.length>0){k.bind("click",function(p){var q={button:"#skyfonts-client-mac-download",version:"#skyfonts-client-mac-version-panel"};d(q);p.preventDefault()})}a("#skyfonts-client-instruction-panel").click(function(p){m.trigger("close");p.preventDefault()})},f=function(k){var j=k.contentWrapper,l=k.userMessages;SkyFontsClient.check({onprogress:function(){l.clearAll();j.showLoading()},onsuccess:function(m){if(m.success){if(m.isLoggedin){b(k);j.hideLoading()}else{j.hideLoading();l.addError(Fonts.Translations.getSignInToSkyFontsClientMessage())}}else{Fonts.SkyFontDropdown.showDownloadModal(function(){j.hideLoading()})}},onfailure:function(){Fonts.SkyFontDropdown.showDownloadModal(function(){j.hideLoading()})}})};e.showDownloadModal=function(j,k){k=typeof k!=="undefined"?k:true;a.ajax({url:Fonts.Urls.downloadSkyFontsClientModalUrl(),type:"GET",data:{hideInstructions:!k},beforeSend:function(){},success:function(l){var m=a(l);m.lightbox_me({onLoad:function(){c(m)},destroyOnClose:true})},error:function(){}}).always(function(){if(typeof j==="function"){j()}})};e.onInitializedDropdown=function(k,j){k.closest(".dev-skyfonts-wrapper").on("click",function(l){l.stopPropagation()});k.find("form").on("submit",function(l){l.preventDefault();var m={form:a(this)};m.container=m.form.closest(".dev-skyfonts-wrapper");m.contentWrapper=m.container.find("div.dev-add-skyfonts-container");m.userMessages=new UserMessages(a,m.container.find('div[id^="messages-"]').attr("id"));m.onAdded=function(n){if(typeof j==="function"){j(n)}};f(m)});k.find("select").selectbox()};return e}(jQuery));Fonts.SkyFonts=(function(a){var r={};var n="ActivatedGoogleWebFonts";var b="ActivatedGoogleFontCodes";var s="#topPopularFonts";var f=10;function h(){a("#show-download-skyfonts-client-dialog").click(function(){var u=a(this);u.showLoading();Fonts.SkyFontDropdown.showDownloadModal(function(){u.hideLoading()},false)})}function g(u){var v=u.closest("li");v.showLoading();a.ajax({type:"POST",url:Fonts.Urls.allActiveSkyfontsCountUrl(),datatype:"json"}).done(function(w){if(w.Success){a(".dev-total-active-font-count").html(w.Data);v.remove();Fonts.Timers.destroy(u)}}).always(function(){v.hideLoading()})}function t(){a.ajax({type:"POST",url:Fonts.Urls.getRemainingCredits(),datatype:"json"}).done(function(u){if(u.Success){if(u.Data.MockUpRemainingCredits!==-1){a(".dev-mockup-remaining-credits").html(u.Data.MockUpRemainingCredits)}if(u.Data.MockUpRemainingCredits!==-1){a(".dev-desktop-remaining-credits").html(u.Data.DesktopRemainingCredits)}}})}function l(){a("#skyfonts-show-active-fonts").click(function(){var u=a(this);a.ajax({url:Fonts.Urls.activeFontsUrl(),type:"GET",beforeSend:function(){u.showLoading()},success:function(v){u.hideLoading();Fonts.SkyFonts.bindAllActiveFontsModal(a(v))},error:function(){u.hideLoading()}})})}r.bindAllActiveFontsModal=function(u){u.lightbox_me({onLoad:function(){var v=JSON.parse(u.find(".dev-skyfonts-remaining-times").html());Fonts.SkyFonts.bindTimersAndDropdows(u,v);Fonts.Scrolling.InitSkyFontsActiveFontsInfiniteScrolling()},onBeforeClose:function(){Fonts.Timers.unbindOnExpired(u.find("span.dev-timer"))},onClose:function(){Fonts.Timers.refresh()},destroyOnClose:true})};r.bindExpiredFontsModal=function(u){u.lightbox_me({onLoad:function(){Fonts.Dropdowns.attachSkyFontsDropdowns(u,function(){t()});Fonts.Scrolling.InitSkyFontsExpiredFontsInfiniteScrolling()},onBeforeClose:function(){},destroyOnClose:true})};r.bindTimersAndDropdows=function(u,v){Fonts.Dropdowns.attachSkyFontsDropdowns(u,function(w){Fonts.Timers.update([{Guid:w.SkyFontId,RemainingTime:w.RemainingMiliseconds}]);t()});Fonts.Timers.bindOnExpired(u.find("span.dev-timer"),function(){g(a(this))});Fonts.Timers.bind(v)};r.AttachActiveFontsEvents=function(v,x){var u=a(x),w=JSON.parse(a(v).find(".dev-skyfonts-remaining-times").html());Fonts.SkyFonts.bindTimersAndDropdows(u,w)};function m(){a("#skyfonts-show-expired-fonts").click(function(){var u=a(this);a.ajax({url:Fonts.Urls.expiredFontsUrl(),type:"GET",beforeSend:function(){u.showLoading()},success:function(v){u.hideLoading();Fonts.SkyFonts.bindExpiredFontsModal(a(v))},error:function(){u.hideLoading()}})})}r.AttachExpiredFontsEvents=function(v,w){var u=a(w);Fonts.Dropdowns.attachSkyFontsDropdowns(u,function(){t()})};function j(){Cookies.set(n,"",-1);a("#show-google-webfonts-dialog").click(function(){var y=a(this);var z=Common.queryStringToObject(u);var v=z.fonts;var x=location.hash;var A=undefined;if(x!=undefined&&x.toLocaleLowerCase().lastIndexOf(s.toLowerCase(),0)===0){A=x.substr(s.length,x.length-s.length);A=Math.floor(A);if(isNaN(A)||A<=0){A=f}}var w=null;if(v!=undefined){w={keyword:v,showAddMultipleFontsButton:true}}if(A!=undefined){w={showAddMultipleFontsButton:true,topPopularFonts:A}}a.ajax({url:Fonts.Urls.googleWebFontsDialogUrl(),type:"GET",data:w,beforeSend:function(){y.showLoading()},success:function(B){if(B.redirectUrl){window.location=B.redirectUrl}else{y.hideLoading();var C=a(B);C.lightbox_me({onLoad:function(){Fonts.Dropdowns.attachSkyFontsDropdowns(C);a(".add-to-skyfonts-button input").click(d);a(".add-multi-to-skyfonts-button input.input-submit").click(e);Fonts.Scrolling.InitGoogleWebFontInfiniteScrolling();q(C);i(C)},destroyOnClose:true})}},error:function(){y.hideLoading()}})});var u=location.search;if(u&&u.toLowerCase().indexOf("showgooglefontsdialog")!=-1){a("#show-google-webfonts-dialog").click()}}r.AttachGoogleWebFontEvents=function(v,x){var u=a(x);Fonts.Dropdowns.attachSkyFontsDropdowns(u);a(".add-to-skyfonts-button input",u).click(d);a(".add-multi-to-skyfonts-button input.input-submit",u).click(e);var y=a("style",v).eq(0);if(0==y.length){y=a(v).filter("style").eq(0)}if(y.length>0){var w=a('<style type="text/css"></style>');w.html(y.html());a(".skyfonts-google-webfonts .modal-content").before(w[0])}q(u)};function e(){var u=a(this);var A=u.parents(".dev-skyfonts-wrapper.skyfonts-wrapper").find(".dev-add-skyfonts-dropdown-button");var y=u.parents(".modal-content");var B=new UserMessages(a,"messages-multi");var x=new Array();var v=new Array();a.each(a(".add-to-skyfonts-button input"),function(D,C){x.push(C)});y.showLoading();B.clearAll();w();function w(){if(x.length==0){B.addSuccess(Fonts.Translations.getGoogleWebFontsAddSuccessMessage(),function(){A.click()});z();y.hideLoading()}else{var C=x.pop();v.push(a(C).parents(".dev-add-skyfonts-container").find('input[name="google-webfont-url"]'));d.apply(C,[null,w,function(){var D=a(".error.user-message p",y);if(D.length>0){var E=new Array();a.each(D,function(H,F){var G=F.innerHTML;if(a.inArray(G,E)==-1){E.push(G);B.addError(G)}})}z();y.hideLoading()}])}}function z(){a.each(v,function(D,C){o(C.val(),C)})}}function d(w,E,D){var u=a(this);var F=u.parents(".dev-skyfonts-wrapper.skyfonts-wrapper").find(".dev-add-skyfonts-dropdown-button");var v=u.parents(".dropdown-inner");var C=v.is(":visible");var A=v.find('input[name="google-webfont-url"]');var z=A.val();var y=v.find('input[name="google-webfont-name"]').val();var B=v.find('input[name="google-webfont-version"]').val();var x=v.find('input[name="google-webfont-local-name"]').val();var G=new UserMessages(a,v.find('div[id^="messages-"]').attr("id"));SkyFontsClient.check({onprogress:function(){G.clearAll();if(C){v.showLoading()}},onsuccess:function(H){if(H.success){if(C){v.hideLoading()}SkyFontsClient.addFont({type:"ttf",fontname:y,fonturl:z,provider:"Google",version:B,fontlocalname:x,onprogress:function(){if(C){v.showLoading()}},onsuccess:function(){G.addSuccess(Fonts.Translations.getGoogleWebFontsAddSuccessMessage(),function(){if(C){F.click()}});if(C){v.hideLoading();o(z,A)}if(window._gaq){window._gaq.push(["_trackEvent","SkyFonts","GoogleFontAdd",y])}if(E){E()}},onfailure:function(I){if(I.exception=="Provider not enabled"){G.addError(Fonts.Translations.getGoogleWebFontsEnableProviderMessage());if(C){v.hideLoading()}if(D){D()}}else{Fonts.SkyFontDropdown.showDownloadModal(function(){if(C){v.hideLoading()}if(D){D()}})}}})}else{if(C){v.hideLoading()}G.addError(Fonts.Translations.getErrorMessage());if(D){D()}}},onfailure:function(){Fonts.SkyFontDropdown.showDownloadModal(function(){if(C){v.hideLoading()}if(D){D()}})}})}function o(w,x){var v=Cookies.get(b);var u=[];if(v!=undefined){u=JSON.parse(v)}var y=Common.getHashCode(w);if(a.inArray(y,u)==-1){u.push(y);Cookies.set(b,JSON.stringify(u),null,location.pathname);c(x)}}function c(u){u.parents(".dev-skyfonts-wrapper.skyfonts-wrapper").find(".dev-add-skyfonts-dropdown-button").addClass("skyfonts-active")}function q(v){var w=Cookies.get(b);if(w!=undefined){var u=JSON.parse(w);v.find('input[name="google-webfont-url"]').each(function(){var x=a(this);if(a.inArray(Common.getHashCode(x.val()),u)!=-1){c(x)}})}}function i(u){var v=u.find("#google-webfonts-keyword");u.find(".alpha-keyword").click(function(){var w=a(this).data("keyword");v.val(w);p(u,w)});v.data("previous-keyword",v.val());v.keyup(function(){var w=a(this).val();p(u,w)});u.find(".skyfonts-google-keywords .remove").click(function(w){w.preventDefault();v.val("");v.keyup()});u.find(".batch-install a").click(function(w){w.preventDefault();v.val("");var x=a(this).data("top-limit");location.hash=s+x;p(u,null,x)})}function p(w,v,B){var x=w.find(".modal-content");var u=w.find(".font-results");var A=w.find("#google-webfonts-keyword");var z=A.data("previous-keyword");if(z==null){z=""}var y=B!=null?{showAddMultipleFontsButton:true,topPopularFonts:B}:{keyword:v};if(B!=null||z.toLowerCase()!=v.toLowerCase()){a.ajax({url:Fonts.Urls.googleWebFontsDialogUrl(),type:"GET",data:y,beforeSend:function(){x.showLoading()},success:function(C){var D=a(C);var E=D.find("li");u.find("li").remove();u.scrollTop(0);u.append(E);Fonts.SkyFonts.AttachGoogleWebFontEvents(D,E);var F=D.find("#google-webfonts-next-page");w.find("#google-webfonts-next-page").attr("href",F.length==1?F.attr("href"):null);A.data("previous-keyword",v);x.hideLoading()},error:function(){x.hideLoading()}})}}r.bindRightPanelRemainigTimeEvents=function(w){var v=a("#dev-fonts-history-wrapper"),u=v.find("#dev-top10-active-fonts"),x=v.find("span.dev-timer"),y=function(){u.hideLoading();u.showLoading();a.ajax({type:"POST",url:Fonts.Urls.activeAndExpiredFontsUrl(),datatype:"json"}).done(function(z){u.hideLoading();if(z.Success){v.html(z.Data.Html);Fonts.Timers.refresh();Fonts.SkyFonts.bindRightPanelRemainigTimeEvents(z.Data.Fonts);l();m()}}).fail(function(){u.hideLoading()})};Fonts.Timers.bindOnExpired(x,function(){Fonts.Timers.unbindOnExpired(x);y()});Fonts.Timers.bind(w)};function k(){a(".skyfonts-machines .skyfonts-machines-remove").click(function(){var v=a(this),u=a("#skyfonts-machines-remove-form");u.find("#deviceId").val(v.data("device-id"));u.find("#revoke").val(v.data("active"));u.submit()})}r.OnSkyFontsMachineRemoveSuccess=function(u){a("#skyfonts-machine-section-pairing").html(u);k()};a(function(){j();h();l();m();k()});return r}(jQuery));(function(d){function j(b,a,c){a="("+c.replace(k,"\\$1")+")";return b.replace(RegExp(a,"gi"),"<strong>$1</strong>")}function g(b,a){this.el=d(b);this.el.attr("autocomplete","off");this.suggestions=[];this.data=[];this.badQueries=[];this.selectedIndex=-1;this.currentValue=this.el.val();this.intervalId=0;this.cachedResponse=[];this.onChange=this.onChangeInterval=null;this.ignoreValueChange=!1;this.serviceUrl=a.serviceUrl;this.isLocal=!1;this.options={autoSubmit:!1,minChars:1,maxHeight:300,deferRequestBy:0,width:0,highlight:!0,params:{},fnFormatResult:j,delimiter:null,zIndex:9999};this.initialize();this.setOptions(a);this.el.data("autocomplete",this)}var k=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");d.fn.autocomplete=function(b,a){var c;if("string"==typeof b){if(c=this.data("autocomplete"),"function"==typeof c[b]){c[b](a)}}else{c=new g(this.get(0)||d("<input />"),b)}return c};g.prototype={killerFn:null,initialize:function(){var b,a,c;b=this;a=Math.floor(1048576*Math.random()).toString(16);c="Autocomplete_"+a;this.killerFn=function(a){0===d(a.target).parents(".autocomplete").size()&&(b.killSuggestions(),b.disableKillerFn())};this.options.width||(this.options.width=this.el.width());this.mainContainerId="AutocompleteContainter_"+a;d('<div id="'+this.mainContainerId+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete" id="'+c+'" style="display:none; width:300px;"></div></div></div>').appendTo("body");this.container=d("#"+c);this.fixPosition();window.opera?this.el.keypress(function(a){b.onKeyPress(a)}):this.el.keydown(function(a){b.onKeyPress(a)});this.el.keyup(function(a){b.onKeyUp(a)});this.el.blur(function(){b.enableKillerFn()});this.el.focus(function(){b.fixPosition()});this.el.change(function(){b.onValueChanged()})},extendOptions:function(b){d.extend(this.options,b)},setOptions:function(b){var a=this.options;this.extendOptions(b);if(a.lookup||a.isLocal){this.isLocal=!0,d.isArray(a.lookup)&&(a.lookup={suggestions:a.lookup,data:[]})}d("#"+this.mainContainerId).css({zIndex:a.zIndex});this.container.css({maxHeight:a.maxHeight+"px",width:a.width})},clearCache:function(){this.cachedResponse=[];this.badQueries=[]},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},fixPosition:function(){var b=this.el.offset();d("#"+this.mainContainerId).css({top:b.top+this.el.innerHeight()+"px",left:b.left+"px"})},enableKillerFn:function(){d(document).bind("click",this.killerFn)},disableKillerFn:function(){d(document).unbind("click",this.killerFn)},killSuggestions:function(){var b=this;this.stopKillSuggestions();this.intervalId=window.setInterval(function(){b.hide();b.stopKillSuggestions()},300)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},onValueChanged:function(){this.change(this.selectedIndex)},onKeyPress:function(b){if(!this.disabled&&this.enabled){switch(b.keyCode){case 27:this.el.val(this.currentValue);this.hide();break;case 9:case 13:if(-1===this.selectedIndex){this.hide();return}this.select(this.selectedIndex);if(9===b.keyCode){return}break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return}b.stopImmediatePropagation();b.preventDefault()}},onKeyUp:function(b){if(!this.disabled){switch(b.keyCode){case 38:case 40:return}clearInterval(this.onChangeInterval);if(this.currentValue!==this.el.val()){if(0<this.options.deferRequestBy){var a=this;this.onChangeInterval=setInterval(function(){a.onValueChange()},this.options.deferRequestBy)}else{this.onValueChange()}}}},onValueChange:function(){clearInterval(this.onChangeInterval);this.currentValue=this.el.val();var b=this.getQuery(this.currentValue);this.selectedIndex=-1;this.ignoreValueChange?this.ignoreValueChange=!1:""===b||b.length<this.options.minChars?this.hide():this.getSuggestions(b)},getQuery:function(b){var a;a=this.options.delimiter;if(!a){return d.trim(b)}b=b.split(a);return d.trim(b[b.length-1])},getSuggestionsLocal:function(b){var a,c,d,f,e;c=this.options.lookup;d=c.suggestions.length;a={suggestions:[],data:[]};b=b.toLowerCase();for(e=0;e<d;e++){f=c.suggestions[e],0===f.toLowerCase().indexOf(b)&&(a.suggestions.push(f),a.data.push(c.data[e]))}return a},getSuggestions:function(b){var a,c;(a=this.isLocal?this.getSuggestionsLocal(b):this.cachedResponse[b])&&d.isArray(a.suggestions)?(this.suggestions=a.suggestions,this.data=a.data,this.suggest()):this.isBadQuery(b)||(c=this,c.options.params.query=b,d.get(this.serviceUrl,c.options.params,function(a){c.processResponse(a)},"text"))},isBadQuery:function(b){for(var a=this.badQueries.length;a--;){if(0===b.indexOf(this.badQueries[a])){return !0}}return !1},hide:function(){this.enabled=!1;this.selectedIndex=-1;this.container.hide()},suggest:function(){if(0===this.suggestions.length){this.hide()}else{var b,a,c,h,f,e,g,i;b=this;a=this.suggestions.length;h=this.options.fnFormatResult;f=this.getQuery(this.currentValue);g=function(a){return function(){b.activate(a)}};i=function(a){return function(){b.select(a)}};this.container.hide().empty();for(e=0;e<a;e++){c=this.suggestions[e],c=d((b.selectedIndex===e?'<div class="selected"':"<div")+' title="'+c+'">'+h(c,this.data[e],f)+"</div>"),c.mouseover(g(e)),c.click(i(e)),this.container.append(c)}this.enabled=!0;this.container.show()}},processResponse:function(b){var a;try{a=eval("("+b+")")}catch(c){return}d.isArray(a.data)||(a.data=[]);this.options.noCache||(this.cachedResponse[a.query]=a,0===a.suggestions.length&&this.badQueries.push(a.query));a.query===this.getQuery(this.currentValue)&&(this.suggestions=a.suggestions,this.data=a.data,this.suggest())},activate:function(b){var a,c;a=this.container.children();-1!==this.selectedIndex&&a.length>this.selectedIndex&&d(a.get(this.selectedIndex)).removeClass();this.selectedIndex=b;-1!==this.selectedIndex&&a.length>this.selectedIndex&&(c=a.get(this.selectedIndex),d(c).addClass("selected"));return c},deactivate:function(b,a){b.className="";this.selectedIndex===a&&(this.selectedIndex=-1)},select:function(b){var a;if(a=this.suggestions[b]){this.el.val(a),this.options.autoSubmit&&(a=this.el.parents("form"),0<a.length&&a.get(0).submit()),this.ignoreValueChange=!0,this.hide(),this.onSelect(b)}},change:function(b){if(this.suggestions[b]){var a,c;a=this.suggestions[b];c=this.data[b];this.el.val(this.getValue(a))}else{a="",c=-1}b=this.options.onChange;d.isFunction(b)&&b(a,c,this.el)},moveUp:function(){-1!==this.selectedIndex&&(0===this.selectedIndex?(this.container.children().get(0).className="",this.selectedIndex=-1,this.el.val(this.currentValue)):this.adjustScroll(this.selectedIndex-1))},moveDown:function(){this.selectedIndex!==this.suggestions.length-1&&this.adjustScroll(this.selectedIndex+1)},adjustScroll:function(b){var a,c,d;a=this.activate(b).offsetTop;c=this.container.scrollTop();d=c+this.options.maxHeight-25;a<c?this.container.scrollTop(a):a>d&&this.container.scrollTop(a-this.options.maxHeight+25);this.el.val(this.getValue(this.suggestions[b]))},onSelect:function(b){var a,c;a=this.options.onSelect;c=this.suggestions[b];b=this.data[b];this.el.val(this.getValue(c));d.isFunction(a)&&a(c,b,this.el)},getValue:function(b){var a,c;a=this.options.delimiter;if(!a){return b}c=this.currentValue;a=c.split(a);return 1===a.length?b:c.substr(0,c.length-a[a.length-1].length)+b}}})(jQuery);(function(a){Fonts.initializeSite=function(){a(function(){AttachAutoCompleteSearch();Fonts.Account.AttachEventsToSigninFormsTriggers();Fonts.Account.AttachEventsToNeedSupportSectionsTriggers();Fonts.Account.AttachEventsToCartTotalSectionsTriggers();Fonts.Account.AttachEventsToMiniCartSectionsTriggers();if(typeof Homepage!=="undefined"){a(Homepage.delayedFunctions).each(function(){a(this)})}})}}(jQuery));(function(){var i="_affq",w="//affiliateTrackerWeb.monotypeimaging.com/action/",r={getIdBySite:"GetIdBySite",getSiteById:"GetSiteById",recordTransaction:"RecordTransaction",pageViews:"PageViews"},s={siteId:"siteId",referrer:"referrer"},b={name:"_aff",expires:45,path:"/"},f={siteId:"siteId",siteUrl:"siteUrl",accountId:"accountId"},o=function(y){return Object.prototype.toString.apply(y)==="[object Object]"},l=function(y){return Object.prototype.toString.apply(y)==="[object Array]"},m=function(y){return typeof y==="function"},p=function(y){return typeof y==="string"},n=function(y){return typeof y==="number"},h=function(D,z){var C=p(D)?D.substring(1):"",E=C.split("&"),A=E.length,B,y;for(y=0;y<A;y+=1){B=E[y].split("=");if(B[0].toLowerCase()===z.toLowerCase()){return decodeURIComponent(B[1])}}},c=function(z){var A=[],y;if(!o(z)){return""}for(y in z){if(z.hasOwnProperty(y)&&z[y]){A.push(y+"="+encodeURIComponent(z[y]))}}return A.join("&")},u=function(){var y=new Date().getTime(),z=window.Math.random().toString().substring(2);return y+z},v=function(z){var y=[],A;if(!o(z)){return""}for(A in z){if(z.hasOwnProperty(A)){y.push(A+"="+z[A])}}return y.join("&")},g=function(z){var B={},C=p(z)?z.split("&"):[],D=C.length,E=false,y,A;for(y=0;y<D;y+=1){A=C[y].split("=");if(A.length===2){B[A[0]]=A[1];E=true}}return E?B:null},d=function(z,A,y){var C=[],B=c(A);if(!p(z)||!z){return""}C.push(w);C.push(z);if(B){C.push("?");C.push(B)}if(p(y)&&y){if(B){C.push("&")}else{C.push("?")}C.push("callback=");C.push(encodeURIComponent(y))}return C.join("")},a=function(z){var B="script",A=document.createElement(B),y=document.getElementsByTagName(B)[0];A.type="text/javascript";A.id=z.id;A.async=true;A.src=z.src;y.parentNode.insertBefore(A,y)},j=function(z,A){var y=new window.Image();y.src=d(z,A)},k=function(A,B,z){var C=u(),y=u();window[y]=function(D){var E=document.getElementById(C);z(D);E.parentNode.removeChild(E);delete window[y]};a({id:C,src:d(A,B,y)})},e=function(B,H,C){var z,E,F,D,A,y,G;if(B!==undefined&&H!==undefined&&(p(H)||H===null)){C=C||{};if(H===null||H===undefined){C.expires=-1}if(n(C.expires)){y=C.expires;G=C.expires=new Date();G.setDate(G.getDate()+y)}H=String(H);return(document.cookie=[encodeURIComponent(B),"=",C.raw?H:encodeURIComponent(H),C.expires?"; expires="+C.expires.toUTCString():"",C.path?"; path="+C.path:"",C.domain?"; domain="+C.domain:"",C.secure?"; secure":""].join(""))}C=H||{};z=C.raw?function(I){return I}:decodeURIComponent;E=document.cookie.split("; ");F=E.length;for(A=0;A<F;A+=1){D=E[A].split("=");if(z(D[0])===B){return z(D[1]||"")}}return null},q=function(y){return y&&y[f.siteId]&&y[f.siteUrl]},x=function(){this.referrer=document.referrer;this.currentHost=document.location.host;this.siteId=h(document.location.search,s.siteId);this.accountId=0},t=function(){this.tracker=new x()};x.prototype.setAccount=function(y){this.accountId=y};x.prototype.trackPageview=function(){var y=e(b.name),B=g(y),A=this,z=function(C){var D;if(C&&C.success){D={};D[f.siteId]=C.id;D[f.siteUrl]=C.site;D[f.accountId]=A.accountId;e(b.name,v(D),b);A.recordVisit(true)}};if(!A.siteId&&(!A.referrer||document.referrer.indexOf(document.location.host)!==-1)){A.recordVisit(false);return}if(q(B)&&(A.referrer.indexOf(B[f.siteUrl])!==-1||A.siteId===B[f.siteId])){e(b.name,v(B),b);A.recordVisit(true);return}if(A.siteId){k(r.getSiteById,{siteId:A.siteId},z)}else{k(r.getIdBySite,{referrer:A.referrer},z)}};x.prototype.recordTransaction=function(F,C,E,B,z,D){var y=e(b.name),A=g(y);if(q(A)){j(r.recordTransaction,{ai:A[f.accountId],si:A[f.siteId],or:F,de:C,oa:E,c:B,ty:z,h:D})}};x.prototype.recordVisit=function(A){var y=e(b.name),z=g(y);if(q(z)){j(r.pageViews,{ai:z[f.accountId],si:z[f.siteId],iv:(A?1:0)})}};t.prototype.push=function(){var D=this.tracker,A,y=arguments.length,C,B,z;if(y){for(A=0;A<y;A+=1){if(l(arguments[A])&&arguments[A].length>0){C=arguments[A][0];B=arguments[A].slice(1);z=D[C];if(m(z)){z.apply(D,B)}}}}};(function(){var z,y;if(!window[i]){window[i]=new t()}else{if(l(window[i])){z=window[i];y=new t();y.push.apply(y,z);window[i]=y}else{if(!(window[i] instanceof t)){window[i]=new t()}}}}())}());